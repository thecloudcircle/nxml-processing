
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Med Res Methodol</journal-id><journal-id journal-id-type="iso-abbrev">BMC Med Res Methodol</journal-id><journal-title-group><journal-title>BMC Medical Research Methodology</journal-title></journal-title-group><issn pub-type="epub">1471-2288</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">28068905</article-id><article-id pub-id-type="pmc">5223318</article-id><article-id pub-id-type="publisher-id">282</article-id><article-id pub-id-type="doi">10.1186/s12874-016-0282-4</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>G-computation of average treatment effects on the treated and the untreated</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3490-648X</contrib-id><name><surname>Wang</surname><given-names>Aolin</given-names></name><address><email>aolinw@ucla.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Nianogo</surname><given-names>Roch A.</given-names></name><address><email>niaroch@ucla.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Arah</surname><given-names>Onyebuchi A.</given-names></name><address><email>arah@ucla.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label>Department of Epidemiology, Fielding School of Public Health, University of California, Los Angeles (UCLA), Los Angeles, CA USA </aff><aff id="Aff2"><label>2</label>California Center for Population Research (CCPR), Los Angeles, CA USA </aff><aff id="Aff3"><label>3</label>UCLA Center for Health Policy Research, Los Angeles, CA USA </aff></contrib-group><pub-date pub-type="epub"><day>9</day><month>1</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>9</day><month>1</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>17</volume><elocation-id>3</elocation-id><history><date date-type="received"><day>21</day><month>6</month><year>2016</year></date><date date-type="accepted"><day>21</day><month>12</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Average treatment effects on the treated (ATT) and the untreated (ATU) are useful when there is interest in: the evaluation of the effects of treatments or interventions on those who received them, the presence of treatment heterogeneity, or the projection of potential outcomes in a target (sub-) population. In this paper we illustrate the steps for estimating ATT and ATU using g-computation implemented via Monte Carlo simulation.</p></sec><sec><title>Methods</title><p>To obtain marginal effect estimates for ATT and ATU we used a three-step approach: fitting a model for the outcome, generating potential outcome variables for ATT and ATU separately, and regressing each potential outcome variable on treatment intervention.</p></sec><sec><title>Results</title><p>The estimates for ATT, ATU and average treatment effect (ATE) were of similar magnitude, with ATE being in between ATT and ATU as expected. In our illustrative example, the effect (risk difference [RD]) of a higher education on angina among the participants who indeed have at least a high school education (ATT) was &#x02212;0.019 (95% CI: &#x02212;0.040, &#x02212;0.007) and that among those who have less than a high school education in India (ATU) was &#x02212;0.012 (95% CI: &#x02212;0.036, 0.010).</p></sec><sec><title>Conclusions</title><p>The g-computation algorithm is a powerful way of estimating standardized estimates like the ATT and ATU. Its use should be encouraged in modern epidemiologic teaching and practice.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12874-016-0282-4) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Average treatment effects on the treated (ATT)</kwd><kwd>Average treatment effects on the untreated (ATU)</kwd><kwd>G-computation</kwd><kwd>Parametric g-formula</kwd><kwd>Resampling</kwd><kwd>Simulation</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009633</institution-id><institution>Eunice Kennedy Shriver National Institute of Child Health and Human Development</institution></institution-wrap></funding-source><award-id>R01-HD072296-01A1</award-id><award-id>R24-HD041022</award-id><principal-award-recipient><name><surname>Arah</surname><given-names>Onyebuchi A.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007185</institution-id><institution>University of California, Los Angeles</institution></institution-wrap></funding-source><award-id>Dissertation Year Fellowship</award-id><award-id>Dissertation Year Fellowship</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Aolin</given-names></name><name><surname>Nianogo</surname><given-names>Roch A.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000861</institution-id><institution>Burroughs Wellcome Fund</institution></institution-wrap></funding-source><award-id>Fellowship</award-id><principal-award-recipient><name><surname>Nianogo</surname><given-names>Roch A.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2017</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>In epidemiology, (bio)statistics and related fields, researchers are often interested in the average treatment effect in the total population (average treatment effect, ATE). This quantity provides the average difference in outcome between units assigned to the treatment and units assigned to the placebo (control) [<xref ref-type="bibr" rid="CR1">1</xref>]. However, in economics and evaluation studies, it has been noted that the average treatment effect among units who actually receive the treatment or intervention (average treatment effects on the treated, ATT) may be the implicit quantity sought and the most relevant to policy makers [<xref ref-type="bibr" rid="CR2">2</xref>]. For instance, consider a scenario where a government has implemented a smoking cessation campaign intervention to decrease the smoking prevalence in a city and now wishes to evaluate the impact of such intervention. Although the overarching goal of such evaluation may be to assess the impact of such intervention in reducing the prevalence of smoking in the general population (i.e. ATE), researchers and policymakers might be interested in explicitly evaluating the effect of the intervention on those who actually received the intervention (i.e. ATT) but not that on those among whom the intervention was never intended.</p><p>Alternatively, researchers may be interested in estimating the potential impact of an existing program in a new target (sub-) population. For instance, one might wish to project the effect of the smoking cessation intervention in a city that did not receive the intervention in order to gauge its potential impact when such intervention is actually implemented. This latter quantity is referred to as the average treatment effect on the untreated (ATU). Interestingly, the ATE can be seen as a weighted average of the ATT and the ATU. All three quantities will be equal when the covariate distribution is the same among the treated and the untreated (e.g. under perfect randomization with perfect compliance or when there is no unmeasured confounders) and there is no effect measure modification by the covariates.</p><p>Robins introduced the &#x0201c;g-methods&#x0201d; to estimate such quantities using observational data [<xref ref-type="bibr" rid="CR3">3</xref>]. Among these, the marginal structural models (MSMs) were designed to estimate marginal quantities (i.e., not conditional on other covariates). The parameters of a MSM can be consistently estimated using two classes of estimators: the g-computation algorithm [<xref ref-type="bibr" rid="CR4">4</xref>] and the inverse-probability of treatment weighting (IPTW) [<xref ref-type="bibr" rid="CR5">5</xref>]. G-computation is often seen as a viable alternative to IPTW because g-computation produces more efficient (i.e. small standard errors) and more stable estimates in parametric settings and can better handle heterogeneity involving time-varying exposure and confounding [<xref ref-type="bibr" rid="CR6">6</xref>]. To date, there are several didactic demonstrations for g-computation [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] and applied examples for projecting the impact of hypothetical interventions aimed at reducing risk factors for coronary heart diseases [<xref ref-type="bibr" rid="CR9">9</xref>] or diabetes in adult populations [<xref ref-type="bibr" rid="CR10">10</xref>], or at reducing early childhood adiposity [<xref ref-type="bibr" rid="CR11">11</xref>]. However, these studies focused on ATE and there are still no accessible demonstrations of g-computation [<xref ref-type="bibr" rid="CR4">4</xref>] applied to ATT and ATU. This manuscript aims to present an easy-to-use g-computation technique using Monte Carlo simulation for consistently estimating ATT and ATU. We also present alternative ways to obtain ATT and ATU via ATE with sample restriction or g-computation technique without simulation.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Notation and g-computation steps</title><p>In the remaining, we will use capital letters to refer to random variables and lowercase letters to represent the specific realizations of the corresponding random variables. Let <italic>A</italic> denote the treatment, with <italic>a</italic> and <italic>a</italic>
<sup><italic>*</italic></sup> as its index and reference values, <italic>Y</italic> the outcome, <bold><italic>C</italic></bold> a set of covariates sufficient for confounding control, and <italic>Y</italic>
<sub><italic>a</italic></sub> the potential outcome that would have occurred had treatment <italic>A</italic>, perhaps contrary to fact, been set to <italic>a</italic>. Each subject in the population has a pair of potential outcomes, one being observed and the other being counterfactual. <italic>Y</italic>
<sub><italic>a</italic></sub> is the observed outcome had the subject received the treatment <italic>A</italic>&#x02009;=&#x02009;<italic>a</italic> whereas <italic>Y</italic>
<sub><italic>a*</italic></sub> is the counterfactual outcome. Conversely, for subjects who receive placebo (control), <italic>Y</italic>
<sub><italic>a*</italic></sub> is the observed outcome while <italic>Y</italic>
<sub><italic>a</italic></sub> is the counterfactual outcome. The ATE, defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left({Y}_a-{Y}_{a^{*}}\right) $$\end{document}</tex-math><mml:math id="M2"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2016_282_Article_IEq1.gif"/></alternatives></inline-formula>, is the average marginal treatment effect in the total population. The ATT, defined as <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left({Y}_a-{Y}_{a^{*}}\Big|A=a\right) $$\end{document}</tex-math><mml:math id="M4"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2016_282_Article_IEq2.gif"/></alternatives></inline-formula> and the ATU, defined as <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left({Y}_a-{Y}_{a^{*}}\Big|A={a}^{*}\right) $$\end{document}</tex-math><mml:math id="M6"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2016_282_Article_IEq3.gif"/></alternatives></inline-formula>, measure the marginal treatment effect in the subpopulation that received the treatment and the subpopulation that did not, respectively. When the assumptions of consistency [<xref ref-type="bibr" rid="CR12">12</xref>], conditional exchangeability given <bold><italic>C</italic></bold> [<xref ref-type="bibr" rid="CR13">13</xref>], and positivity [<xref ref-type="bibr" rid="CR14">14</xref>] are met, the target causal parameters ATE, ATT and ATU on the risk difference scale can be estimated using observational data and the following estimators:<disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\hfill ATE={\varSigma}_c\left[E\left(Y\Big|A=1,\boldsymbol{C}=\boldsymbol{c}\right)-E\left(Y\Big|A=0,\boldsymbol{C}=\boldsymbol{c}\right)\right]P\left(\boldsymbol{C}=\boldsymbol{c}\right),\hfill \\ {}\hfill ATT=E\left(Y\Big|A=a\right)-{\varSigma}_cE\left(Y\Big|A={a}^{*},\boldsymbol{C}=\boldsymbol{c}\right)P\left(\boldsymbol{C}=\boldsymbol{c}\Big|A=a\right),\kern0.24em \mathrm{and}\hfill \\ {}\hfill ATU={\varSigma}_cE\left(Y\Big|A=a,\boldsymbol{C}=\boldsymbol{c}\right)P\left(\boldsymbol{C}=\boldsymbol{c}\Big|A={a}^{*}\right)-E\left(Y\Big|A={a}^{*}\right).\hfill \end{array} $$\end{document}</tex-math><mml:math id="M8"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi mathvariant="italic">ATE</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003a3;</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003a3;</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.24em"/><mml:mi mathvariant="normal">and</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003a3;</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2016_282_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Steps to implement g-computation using Monte Carlo simulation are as follows:</p><p>Step 1: Fit a flexible model for <italic>Y</italic> on <italic>A</italic> and covariates <bold><italic>C</italic></bold> (i.e. with all possible and relevant interaction terms) and save the regression coefficients.</p><p>Step 2: Re-sample the original data with replacement <italic>K</italic> times (e.g. 200 or as many as computationally feasible). Create two copies of this pooled dataset and stack them. Assign a new treatment intervention variable <italic>A&#x02009;=&#x02009;a</italic> for every observation in the first copy and <italic>A&#x02009;=&#x02009;a</italic>
<sup><italic>*</italic></sup> in the second copy. Then, generate potential outcomes for ATT and ATU separately using the regression coefficients obtained from step 1. For ATT, assign the potential outcome <italic>Y</italic>
<sub><italic>a</italic></sub> for <italic>treated</italic> (i.e. <italic>A&#x02009;=&#x02009;a</italic>) individuals as their observed outcome <italic>Y</italic> in the &#x0201c;intervention <italic>A&#x02009;=&#x02009;a</italic>&#x0201d; dataset copy (by consistency), but impute their counterfactual outcome <italic>Y</italic>
<sub><italic>a*</italic></sub> in the &#x0201c;intervention <italic>A&#x02009;=&#x02009;a</italic>
<sup><italic>*</italic></sup>&#x0201d; copy (by conditional exchangeability). This latter counterfactual outcome is simulated under non-treatment, based on the outcome model and regression coefficients from step 1. For ATU, by consistency assumption, assign the potential outcome <italic>Y</italic>
<sub><italic>a*</italic></sub>&#x02009;=&#x02009;<italic>Y</italic> among the <italic>untreated</italic> (i.e. <italic>A&#x02009;=&#x02009;a</italic>
<sup><italic>*</italic></sup>) individuals in the &#x0201c;intervention <italic>A&#x02009;=&#x02009;a</italic>
<sup><italic>*</italic></sup>&#x0201d; dataset copy, and impute their counterfactual outcome <italic>Y</italic>
<sub><italic>a</italic></sub> in the &#x0201c;intervention <italic>A&#x02009;=&#x02009;a</italic>&#x0201d; copy. This counterfactual outcome <italic>Y</italic>
<sub><italic>a</italic></sub> is simulated under treatment, based on the outcome model and regression coefficients from step 1. Note that the&#x000a0;g-computation of the ATT or ATU involves imputing or simulating only half of the potential outcomes under the counterfactual treatment since by consistency under factual treatment the potential outcome is observed.</p><p>Step 3: For ATT and ATU respectively, regress the corresponding potential outcome variable on the intervention variable <italic>A</italic> for the entire pooled simulated sample to obtain the point estimate. Repeat steps 1 to 3 on <italic>J</italic> (e.g. 500) bootstrapped samples taken at random with replacement from the original data. We obtain the standard errors (SEs) and 95% confidence intervals (CIs) based on the <italic>J</italic> resultant point estimates from the final regression in step 3. The standard deviation of these <italic>J</italic> point estimates is taken as the standard error and the corresponding 2.5th and 97.5th percentiles are taken as the confidence limits of the 95% CI. Nonparametric bootstrapping [<xref ref-type="bibr" rid="CR15">15</xref>] can also be used to obtain bias-corrected and accelerated CIs.</p><p>One could also obtain ATT and ATU from average treatment effect (ATE) by simply restricting the analysis for ATE estimation to the treated (for ATT) or to the untreated (for ATU) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 1). An alternative g-computation technique without simulation is included in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section2.</p></sec><sec id="Sec4"><title>Illustrations</title><p>We applied the above simulation method to the India sample data from the cross-sectional World Health Survey (WHS) conducted by the WHO from 2002 to 2004 [<xref ref-type="bibr" rid="CR16">16</xref>]. Samples were probabilistically selected with every individual being assigned to a known non-zero selection probability. All participants were interviewed face-to-face with the standardized WHS survey, which included questions regarding demographic, socioeconomic and behavioral factors. Details of dataset description and variable creation can be found elsewhere [<xref ref-type="bibr" rid="CR17">17</xref>].</p><p>Table <xref rid="Tab1" ref-type="table">1</xref> displays the estimates for ATT, ATU and ATE on the risk difference and odds ratio scale respectively for binary education (treatment) and binary angina indicator (outcome), accounting for age and gender (covariates). We were interested in estimating the impact of a hypothetical intervention (aimed at ensuring that the target study participants have at least a high school education) on angina diagnosis. The intervention could be implemented (i) universally in the whole population of India (ATE), (ii) among individuals of a sub-population of India who actually completed high school or had higher educational attainment (ATT), or (iii) among individuals of a sub-population of India who had less than a high school education (ATU) when the survey was conducted. Detailed steps and the accompanying SAS codes for this illustrative example are included in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 5.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Effect estimates obtained from g-computation using the&#x000a0;illustrative example dataset<sup>a</sup> (<italic>N</italic>&#x02009;=&#x02009;7706)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="3">G-computation (via Monte Carlo Simulation)<sup><bold>b</bold></sup>
</th></tr><tr><th/><th>Point Estimate</th><th>Standard Error</th><th>95% Confidence Interval</th></tr></thead><tbody><tr><td colspan="4">Average Treatment Effect among the Treated (ATT)</td></tr><tr><td>&#x02003;Risk difference</td><td>&#x02212;0.019</td><td>0.009</td><td>&#x02212;0.040, &#x02212;0.007</td></tr><tr><td>&#x02003;Odds ratio</td><td>0.773</td><td>0.112</td><td>0.607, 0.944</td></tr><tr><td colspan="4">Average Treatment Effect among the Untreated (ATU)</td></tr><tr><td>&#x02003;Risk difference</td><td>&#x02212;0.012</td><td>0.012</td><td>&#x02212;0.036, 0.010</td></tr><tr><td>&#x02003;Odds ratio</td><td>0.910</td><td>0.133</td><td>0.678, 1.177</td></tr><tr><td colspan="4">Average Treatment Effect (ATE)</td></tr><tr><td>&#x02003;Risk difference</td><td>&#x02212;0.015</td><td>0.011</td><td>&#x02212;0.036, 0.007</td></tr><tr><td>&#x02003;Odds ratio</td><td>0.884</td><td>0.127</td><td>0.676, 1.130</td></tr></tbody></table><table-wrap-foot><p>
<sup>a</sup>Treatment: education (1&#x02009;=&#x02009;high school and beyond, 0&#x02009;=&#x02009;less than high school); outcome: ever diagnosed with angina (1&#x02009;=&#x02009;yes, 0&#x02009;=&#x02009;no); covariates: age and gender</p><p>
<sup>b</sup>The outcome model included all possible 2- and 3-way product terms between education and covariates. Standard errors and the 95% confidence limits were based on 500 bootstrap samples where the standard deviation of the 500 point estimates was taken as the standard error and the corresponding 2.5th and 97.5th percentiles were taken as the lower and upper limit of the 95% confidence interval</p></table-wrap-foot></table-wrap>
</p></sec></sec><sec id="Sec5"><title>Results</title><p>In the illustration, participants with at least a high school education were less likely to report having an angina diagnosis compared to those with less than a high school education, based on both risk difference (RD) and odds ratio (OR) measures (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). The estimates for ATT, ATU and ATE were of similar magnitude, with ATE being in between ATT and ATU as expected. The ATT estimates were of slightly greater magnitude (RD: &#x02212;0.019, 95% CI: &#x02212;0.040, &#x02212;0.007; OR: 0.773, 95% CI: 0.607, 0.944) than the ATU estimates (RD: &#x02212;0.012, 95% CI: &#x02212;0.036, 0.010; OR: 0.910, 95% CI: 0.678, 1.177), suggesting that the protective effect of a higher education on angina may be stronger among the participants who indeed have at least a high school education than among those who have less than a high school education in India.</p><p>Similar results obtained via g-computation without simulation are presented in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p></sec><sec id="Sec6"><title>Discussions</title><p>In this article, we presented a 3-step approach to estimating ATT and ATU via Monte Carlo simulation. Since ATE risk difference is the weighted average of ATT and ATU, weighted by the relative sample size of those who are treated and untreated, ATT and ATU can also be estimated from ATE via sample restriction.</p><p>When generating the potential outcomes in step 2, the potential outcome will be the same as the observed outcome if the intervention assignment (e.g. treatment) is indeed what the subject originally received and the consistency assumption is satisfied. Accordingly, the counterfactual outcome for the same subjects will be imputed (simulated) based on the outcome from those who received the alternative to treatment (e.g. placebo) and are comparable (i.e., exchangeable) conditional on measured covariates or confounders, if the assumption of conditional exchangeability assumption is met. In step 2 of the alternative g-computation approach that does not require simulation, the predicted outcomes [i.e., <italic>E</italic>(<italic>Y</italic>|<italic>A</italic>&#x02009;=&#x02009;<italic>a</italic>,&#x02009;<bold><italic>C</italic></bold>&#x02009;=&#x02009;<bold><italic>c</italic></bold>)] are generated for both treated and untreated individuals. While the approach via simulation clearly demonstrates the importance of the two core assumptions&#x02014;consistency and conditional exchangeability&#x02014;to estimate causal parameters from observational data, the approach without simulation is less computationally intensive.</p><p>We also need the positivity assumption which requires that there exist participants who experienced all levels of the treatment (such as being treated or untreated) for every combination of the values of the observed confounders in the population under study [<xref ref-type="bibr" rid="CR14">14</xref>]. This latter assumption needs to be supported by the data at hand. Steps for implementing g-computation for ATT and ATU allow us to better understand the importance of assumptions that are often listed but seldom discussed.</p><p>Besides the consistency, conditional exchangeability and positivity assumptions, other implicit assumptions such as the absence of other biases (selection bias and measurement error) and correct model specification need to be satisfied in order to estimate ATE, ATT and ATU consistently. G-computation relies heavily on outcome model specification as shown in the above steps, in which we used the regression coefficients we obtained from the outcome regression model in step 1 to predict potential outcomes. On the contrary, the IPTW method relies on correct exposure model specification assumptions. Therefore, these two g-methods can sometimes yield different results. Their strengths and limitations, and performance under violation of the positivity assumption have also been discussed in the literature [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. When possible, researchers could use both methods, or use doubly robust methods [<xref ref-type="bibr" rid="CR19">19</xref>&#x02013;<xref ref-type="bibr" rid="CR21">21</xref>] where consistent estimates for the target effects can be obtained as long as either the outcome or exposure model is correctly specified.</p></sec><sec id="Sec7"><title>Conclusion</title><p>The g-computation algorithm is a powerful way of estimating standardized estimates like the ATT and ATU, beyond routine age- and sex-standardization and as an alternative to IPTW fitting of MSM [<xref ref-type="bibr" rid="CR22">22</xref>]. It should be used in modern epidemiologic teaching and practice.</p></sec></body><back><app-group><app id="App1"><sec id="Sec8"><title>Additional file</title><p>
<media position="anchor" xlink:href="12874_2016_282_MOESM1_ESM.docx" id="MOESM1"><label>Additional file 1:</label><caption><p>In the supplementary file, we presented two alternative ways for estimating ATT and ATU, and the detailed g-computation steps, and the corresponding SAS code for the illustration. (DOCX 81&#x000a0;kb)</p></caption></media>
</p></sec></app></app-group><glossary><title>Abbreviations</title><def-list><def-item><term>ATE</term><def><p>Average treatment effect</p></def></def-item><def-item><term>ATT</term><def><p>Average treatment effects on the treated</p></def></def-item><def-item><term>ATU</term><def><p>Average treatment effects on the untreated</p></def></def-item><def-item><term>MSMs</term><def><p>Marginal structural models</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>The authors benefited from facilities and resources provided by the California Center for Population Research at UCLA (CCPR), which receives core support (R24-HD041022) from the Eunice Kennedy Shriver National Institute of Child Health and Human Development (NICHD).</p><sec id="FPar1"><title>Funding</title><p>AW was supported by the Dissertation Year Fellowship from the University of California, Los Angeles. RAN was supported by a Burroughs Wellcome Fellowship and the Dissertation Year Fellowship from UCLA. OAA was partly supported by grant R01-HD072296-01A1 from the Eunice Kennedy Shriver National Institute of Child Health and Human Development.</p></sec><sec id="FPar2"><title>Availability of data and materials</title><p>The World Health Survey (WHS) is a large cross-sectional study implemented by the WHO and conducted in 2002&#x02013;2004 in 70 countries. The survey collected data on the health of adult populations and health systems using probabilistic sampling techniques. The study samples were nationally representative and included in total over 300,000 individuals aged 18 and older. WHS is publicly available at <ext-link ext-link-type="uri" xlink:href="http://apps.who.int/healthinfo/systems/surveydata/index.php/catalog">http://apps.who.int/healthinfo/systems/surveydata/index.php/catalog</ext-link> (registration required). The SAS code is included in the supplementary file and the dataset for illustrative example is available upon request.</p></sec><sec id="FPar3"><title>Authors&#x02019; contributions</title><p>AW and RAN participated in the study conception, design, analysis and interpretation of results and drafting of the article. OAA supervised the study and participated in study conception, design and interpretation of results, and made critical revisions to the paper for important intellectual content. All authors read and approved the final manuscript.</p></sec><sec id="FPar4"><title>Competing interest</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar5"><title>Consent for publication</title><p>Not applicable as this is a secondary data analysis project.</p></sec><sec id="FPar6"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imbens</surname><given-names>GW</given-names></name></person-group><article-title>Nonparametric estimation of average treatment effects under exogeneity: a review</article-title><source>Rev Econ Stat</source><year>2004</year><volume>86</volume><fpage>4</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1162/003465304323023651</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heckman</surname><given-names>JJ</given-names></name><name><surname>Vytlacil</surname><given-names>E</given-names></name></person-group><article-title>Policy-Relevant Treatment Effects</article-title><source>Am Econ Rev</source><year>2001</year><volume>91</volume><fpage>107</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1257/aer.91.2.107</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Halloran</surname><given-names>ME</given-names></name><name><surname>Berry</surname><given-names>D</given-names></name></person-group><article-title>Marginal Structural Models versus Structural nested Models as Tools for Causal inference</article-title><source>Stat. Model. Epidemiol. Environ. Clin. Trials</source><year>2000</year><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><fpage>95</fpage><lpage>133</lpage></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>J</given-names></name></person-group><article-title>A new approach to causal inference in mortality studies with a sustained exposure period&#x02014;application to control of the healthy worker survivor effect</article-title><source>Math Model</source><year>1986</year><volume>7</volume><fpage>1393</fpage><lpage>512</lpage><pub-id pub-id-type="doi">10.1016/0270-0255(86)90088-6</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Hern&#x000e1;n</surname><given-names>MA</given-names></name><name><surname>Hern&#x000e1;n</surname><given-names>MA</given-names></name><name><surname>Brumback</surname><given-names>B</given-names></name></person-group><article-title>Marginal structural models and causal inference in epidemiology</article-title><source>Epidemiology</source><year>2000</year><volume>11</volume><fpage>550</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1097/00001648-200009000-00011</pub-id><pub-id pub-id-type="pmid">10955408</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daniel</surname><given-names>RM</given-names></name><name><surname>Cousens</surname><given-names>SN</given-names></name><name><surname>De Stavola</surname><given-names>BL</given-names></name><name><surname>Kenward</surname><given-names>MG</given-names></name><name><surname>Sterne</surname><given-names>JAC</given-names></name></person-group><article-title>Methods for dealing with time-dependent confounding</article-title><source>Stat Med</source><year>2013</year><volume>32</volume><fpage>1584</fpage><lpage>618</lpage><pub-id pub-id-type="doi">10.1002/sim.5686</pub-id><pub-id pub-id-type="pmid">23208861</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snowden</surname><given-names>JM</given-names></name><name><surname>Rose</surname><given-names>S</given-names></name><name><surname>Mortimer</surname><given-names>KM</given-names></name></person-group><article-title>Implementation of G-computation on a simulated data set: demonstration of a causal inference technique</article-title><source>Am J Epidemiol</source><year>2011</year><volume>173</volume><fpage>731</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1093/aje/kwq472</pub-id><pub-id pub-id-type="pmid">21415029</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keil</surname><given-names>AP</given-names></name><name><surname>Edwards</surname><given-names>JK</given-names></name><name><surname>Richardson</surname><given-names>DB</given-names></name><name><surname>Naimi</surname><given-names>AI</given-names></name><name><surname>Cole</surname><given-names>SR</given-names></name></person-group><article-title>The parametric g-formula for time-to-event data: intuition and a worked example</article-title><source>Epidemiology</source><year>2014</year><volume>25</volume><fpage>889</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1097/EDE.0000000000000160</pub-id><pub-id pub-id-type="pmid">25140837</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taubman</surname><given-names>SL</given-names></name><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Mittleman</surname><given-names>MA</given-names></name><name><surname>Hern&#x000e1;n</surname><given-names>MA</given-names></name></person-group><article-title>Intervening on risk factors for coronary heart disease: an application of the parametric g-formula</article-title><source>Int J Epidemiol</source><year>2009</year><volume>38</volume><fpage>1599</fpage><lpage>611</lpage><pub-id pub-id-type="doi">10.1093/ije/dyp192</pub-id><pub-id pub-id-type="pmid">19389875</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danaei</surname><given-names>G</given-names></name><name><surname>Pan</surname><given-names>A</given-names></name><name><surname>Hu</surname><given-names>FB</given-names></name><name><surname>Hern&#x000e1;n</surname><given-names>MA</given-names></name></person-group><article-title>Hypothetical midlife interventions in women and risk of type 2 diabetes</article-title><source>Epidemiology</source><year>2013</year><volume>24</volume><fpage>122</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1097/EDE.0b013e318276c98a</pub-id><pub-id pub-id-type="pmid">23222556</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nianogo</surname><given-names>RA</given-names></name><name><surname>Wang</surname><given-names>MC</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Nobari</surname><given-names>TZ</given-names></name><name><surname>Crespi</surname><given-names>CM</given-names></name><name><surname>Whaley</surname><given-names>SE</given-names></name><etal/></person-group><article-title>Projecting the impact of hypothetical early life interventions on adiposity in children living in low-income households</article-title><source>Pediatr Obes</source><year>2016</year><pub-id pub-id-type="pmid">27283011</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>SR</given-names></name><name><surname>Frangakis</surname><given-names>CE</given-names></name></person-group><article-title>The consistency statement in causal inference: a definition or an assumption?</article-title><source>Epidemiology</source><year>2009</year><volume>20</volume><fpage>3</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1097/EDE.0b013e31818ef366</pub-id><pub-id pub-id-type="pmid">19234395</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hern&#x000e1;n</surname><given-names>MA</given-names></name><name><surname>Robins</surname><given-names>JM</given-names></name></person-group><article-title>Estimating causal effects from epidemiological data</article-title><source>J Epidemiol Community Health</source><year>2006</year><volume>60</volume><fpage>578</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1136/jech.2004.029496</pub-id><pub-id pub-id-type="pmid">16790829</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westreich</surname><given-names>D</given-names></name><name><surname>Cole</surname><given-names>SR</given-names></name></person-group><article-title>Invited commentary: positivity in practice</article-title><source>Am J Epidemiol</source><year>2010</year><volume>171</volume><fpage>674</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/aje/kwp436</pub-id><pub-id pub-id-type="pmid">20139125</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>Bootstrap Methods for Standard Errors, Confidence Intervals, and Other Measures of Statistical Accuracy</article-title><source>Stat Sci</source><year>1986</year><volume>1</volume><fpage>54</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1214/ss/1177013815</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">World Health Organization. WHO World Health Survey. World Health Organization;2016. Available: <ext-link ext-link-type="uri" xlink:href="http://www.who.int/healthinfo/survey/en/">http://www.who.int/healthinfo/survey/en/</ext-link>. Accessed 1 June 2016.</mixed-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Stronks</surname><given-names>K</given-names></name><name><surname>Arah</surname><given-names>OA</given-names></name></person-group><article-title>Global educational disparities in the associations between body mass index and diabetes mellitus in 49 low-income and middle-income countries</article-title><source>J Epidemiol Community Health</source><year>2014</year><volume>68</volume><fpage>705</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1136/jech-2013-203200</pub-id><pub-id pub-id-type="pmid">24683177</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>KL</given-names></name><name><surname>Neugebauer</surname><given-names>R</given-names></name><name><surname>van der Laan</surname><given-names>MJ</given-names></name><name><surname>Tager</surname><given-names>IB</given-names></name></person-group><article-title>Causal inference in epidemiological studies with strong confounding</article-title><source>Stat Med</source><year>2012</year><volume>31</volume><fpage>1380</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1002/sim.4469</pub-id><pub-id pub-id-type="pmid">22362629</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Hernan MA, Robins JM. Standardization and the Parametric G-formula. Causal Inference. Chapman &#x00026; Hall/CRC. 2015. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">http://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</ext-link>. Accessed 1 June 2016.</mixed-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bang</surname><given-names>H</given-names></name><name><surname>Robins</surname><given-names>JM</given-names></name></person-group><article-title>Doubly robust estimation in missing data and causal inference models</article-title><source>Biometrics</source><year>2005</year><volume>61</volume><fpage>962</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1111/j.1541-0420.2005.00377.x</pub-id><pub-id pub-id-type="pmid">16401269</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vansteelandt</surname><given-names>S</given-names></name><name><surname>Keiding</surname><given-names>N</given-names></name></person-group><article-title>Invited commentary: G-computation--lost in translation?</article-title><source>Am J Epidemiol</source><year>2011</year><volume>173</volume><fpage>739</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1093/aje/kwq474</pub-id><pub-id pub-id-type="pmid">21415028</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>T</given-names></name><name><surname>Matsuyama</surname><given-names>Y</given-names></name></person-group><article-title>Marginal structural models as a tool for standardization</article-title><source>Epidemiology</source><year>2003</year><volume>14</volume><fpage>680</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1097/01.EDE.0000081989.82616.7d</pub-id><pub-id pub-id-type="pmid">14569183</pub-id></element-citation></ref></ref-list></back></article>

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30470746</article-id><article-id pub-id-type="pmc">6251912</article-id><article-id pub-id-type="publisher-id">7240</article-id><article-id pub-id-type="doi">10.1038/s41467-018-07240-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>High throughput in situ metagenomic measurement of bacterial replication at ultra-low sequencing coverage</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Emiola</surname><given-names>Akintunde</given-names></name><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Oh</surname><given-names>Julia</given-names></name><address><email>Julia.Oh@jax.org</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0374 0039</institution-id><institution-id institution-id-type="GRID">grid.249880.f</institution-id><institution>The Jackson Laboratory for Genomic Medicine, </institution></institution-wrap>Farmington, 06032 CT USA </aff></contrib-group><pub-date pub-type="epub"><day>23</day><month>11</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>23</day><month>11</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>9</volume><elocation-id>4956</elocation-id><history><date date-type="received"><day>29</day><month>5</month><year>2018</year></date><date date-type="accepted"><day>22</day><month>10</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">We developed Growth Rate InDex (GRiD) for estimating in situ growth rates of ultra-low coverage (&#x0003e;0.2&#x000d7;) and de novo-assembled metagenomes. Applying GRiD to human and environmental metagenomic datasets to demonstrate its versatility, we uncovered new associations with previously uncharacterized bacteria whose growth rates were associated with several disease characteristics or environmental interactions. In addition, with GRiD-MG (metagenomic), a high-throughput implementation of GRiD, we estimated growth dynamics of 1756 bacteria species from a healthy skin metagenomic dataset and identified a new <italic>Staphylococcus-Corynebacterium</italic> antagonism likely mediated by antimicrobial production in the skin. GRiD-MG significantly increases the ability to extract growth rate inferences from complex metagenomic data with minimal input from the user.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Bacterial growth rate can change under different environmental conditions and reveals important biological and ecological information. Here, the authors develop GRiD, a bioinformatics tool for high-throughput estimation of growth rate using low coverage metagenomic data.</p></abstract><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Metagenomic shotgun sequencing has emerged as a powerful tool to interrogate the composition and function of complex microbial communities<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. Yet such characterizations do not reflect the dynamic nature of a complex microbial community in which microbial growth rate can change under different environmental conditions or during disease. Bacterial growth rate measurements can reveal the contributions of viable populations to overall microbial abundance, providing insight into microbes that may be the active contributors to the community phenotype. Moreover, new insights into antagonistic interspecies interactions can be identified by estimating ratios of rapidly growing vs. dead/stationary cells.</p><p id="Par4">Korem and colleagues<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> first developed an estimation of bacterial growth rate from metagenomic shotgun data using peak-to-trough ratio (PTR). This is based on the principle that most bacteria harbor a single circular chromosome that is replicated bi-directionally commencing from the origin of replication (<italic>ori</italic>) to the terminus (<italic>ter</italic>) region<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Therefore, rapidly dividing cells will have higher read coverage and thus, higher PTR at <italic>ori</italic> vs. <italic>ter</italic> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1A</xref>). However, this method relies on a closed circular reference genome and is therefore inadequate for the vast majority of microbial genomes.</p><p id="Par5">A similar approach, iRep<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, was recently developed to estimate growth rate using draft genomes. iRep maps metagenomic reads to a draft genome to calculate coverage, then orders the contigs from highest to lowest coverage to approximate a PTR-like distribution in the absence of a complete genome. Very high and very low coverage regions are excluded to reduce noise from strain variation or highly conserved regions. A linear regression model is then used to deduce if a population is replicating. iRep&#x02019;s key limitation is a requirement for&#x000a0;&#x0003e;5&#x000d7; coverage, which on average, represents fewer than 5% of genomes in human microbial communities, such as the skin (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1B</xref>).</p><p id="Par6">Finally, both methods rely on identification and mapping of reads to a genome of interest on per-species basis. Given that many microbial communities contain hundreds of species, both PTR and iRep can be burdensome to scale. Moreover, if species of interest are selected based on relative abundance within a community, growth analyses of some biologically relevant microbes may be excluded, no/poor correlation has been observed between relative abundance and growth rate<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>.</p><p id="Par7">Because of these restrictions, both methods have limited potential for real world metagenomes. Microbial communities vary in biomass, microbial complexity (the diversity of genomes present in an ecosystem), and population composition, with varying numbers of low-abundance bacteria. These factors significantly affect metagenomic assembly and analysis. This is important because improvements in metagenomic binning has made it possible to identify previously uncharacterized microbes from complex microbial communities. However, most of these reconstructed genomes are fragmented and only partially cover the genome. Moreover, complex metagenomes often contain closely related species and strains. Neither approach provide robust error estimates to account for noise or ambiguous read mapping. Being able to accurately and systematically estimate growth dynamics of microbes in a complex community would provide new insights into microbial interactions and disease associations.</p><p id="Par8">Here, we developed Growth Rate Index (GRiD) for the measurement of microbial growth rate from complete/draft genomes and metagenomic bins at ultra-low sequencing coverage (0.2&#x000d7;, which is roughly equivalent to 0.05% relative abundance of a 2.5 Mbp genome from a metagenomic sample of 100&#x02009;bp x 10 million reads). GRiD can be applied to a specific genome of interest, or can be utilized in a high-throughput mode for which prior knowledge of microbial composition and coverage is not required.</p></sec><sec id="Sec2" sec-type="results"><title>Results and Discussion</title><sec id="Sec3"><title>Overview of GRiD</title><p id="Par9">GRiD calculates the coverage of all contigs of a reference genome or metagenomic bin in a given sample and sorts them from high to low coverage. The sorted contigs are then reordered to two groups, with the goal of placing an <italic>ori-</italic>containing contig at or near an arbitrary genome &#x0201c;start&#x0201d; and a <italic>ter-</italic>containing contig near the mid-region of a genome (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). This approach approximates a synthetic circular genome. Next, like both iRep and PTR, GRiD calculates coverage drops across a sliding 10 Kb window.<fig id="Fig1"><label>Fig. 1</label><caption><p>In situ growth estimate from ultra-low coverage bacteria. <bold>a</bold> The GRiD approach. Contigs are re-ordered to produce a pattern whereby low coverage contigs potentially containing <italic>ter</italic> are located near the mid-region of the genome, while high-coverage contigs potentially harboring <italic>ori</italic> are located at either extremes of the genome. GRiD values correspond to the ratio of coverage at the peak (<italic>ori</italic>) and trough (<italic>ter</italic>) regions. <bold>b</bold> Growth rate reproducibility between GRiD and iRep using reads obtained from pure cultures of <italic>Staphylococcus epidermidis</italic> and <italic>Corynebacterium simulans</italic>. The boxplot shows the difference (delta) in growth estimates before and after reads were subsampled to lower coverage. To avoid bias, only unrefined GRiD values (see methods) were used for comparison with iRep. <bold>c</bold> Error rate comparison between GRiD and iRep from a skin metagenomic dataset using <italic>S. epidermidis</italic> reference genome. PTR was calculated using a closed circular reference genome while GRiD and iRep were calculated using the same reference genome, but fragmented into 100kb fragments and reshuffled. For samples with genome coverage&#x02009;&#x0003e;&#x02009;0.2 (<italic>n</italic>&#x02009;=&#x02009;588), mapped reads were subsampled to ultra-low coverage prior to GRiD and iRep estimations. Here, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Percent}}\,{\mathrm{error}} = {\textstyle{{({\mathrm{max}}({\mathrm{predicted}},{\mathrm{real}})) - ({\mathrm{min}}({\mathrm{predicted}},{\mathrm{real}}))} \over {({\mathrm{max}}({\mathrm{predicted}},{\mathrm{real}}))}}} \times 100$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">Percent</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">error</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">predicted</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">predicted</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">predicted</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>&#x000d7;</mml:mo><mml:mn>100</mml:mn></mml:math><inline-graphic xlink:href="41467_2018_7240_Article_IEq1.gif"/></alternatives></inline-formula>, where &#x0201c;predicted&#x0201d; represent GRiD or iRep scores, and &#x0201c;real&#x0201d; is the PTR score. Unrefined GRiD values were used for comparison with iRep. The figure on the right shows Pearson correlation plots of GRiD and iRep with PTR. ***&#x02009;=&#x02009;<italic>p</italic>&#x02009;&#x0003c;&#x02009;0.001. <bold>d</bold> Reads from a skin metagenomic dataset mapping to <italic>S. epidermidis</italic> were remapped to the respective genomes. Re-mapped reads are considered as ambiguous reads. The scatter plot shows the correlation (Spearman) between ambiguous reads and species heterogeneity (1&#x02009;&#x02212;<italic>r</italic>/<italic>u</italic>), where <italic>r</italic>&#x02009;=&#x02009;refined GRiD and <italic>u</italic>&#x02009;=&#x02009;unrefined GRiD (see Methods). ***&#x02009;=&#x02009;<italic>p</italic>&#x02009;&#x0003c;&#x02009;0.001. <bold>e</bold> iRep and GRiD measurement for CPR genomes. The scatter plots below show Pearson correlation plots of GRiD and iRep estimates before and after subsampling to ultra-low coverage. ***&#x02009;=&#x02009;<italic>p</italic>&#x02009;&#x0003c;&#x02009;0.001. Center lines in boxplots represent the median and the edges represent the first and third quartiles. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2018_7240_Fig1_HTML" id="d29e418"/></fig></p><p id="Par10">GRiD then calculates a &#x0201c;refined&#x0201d; growth value with additional statistical filters to reduce noise. After removing an initial set of outliers, a smoothing curve is fitted by a re-descending M estimator with Tukey&#x02019;s biweight function<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. This enables a local fit that is resistant to noise arising from species heterogeneity. Then, like PTR, GRiD values represent the coverage ratio of the peak and trough of the curve, with higher ratios representing faster growth rates. But because genomes with very low coverage can be prone to noise (which we define as peak and trough means with large residual errors), GRiD refines growth values. Here, GRiD chooses for the peak coverage value the lowest point of expected variation of the mean, while the upper point of variance of the mean is selected for the trough coverage value (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1C</xref>). This refinement step markedly increases the reproducibility (i.e., reduced delta values) of growth estimates at ultra-low coverage levels (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1D</xref>).</p><p id="Par11">In contrast to both iRep and PTR, GRiD provides as standard output multiple confidence estimates, including confidence intervals by bootstrapping, estimates of error contributed by closely related species and strains in the community, and guidelines for growth rate correction. First, the GRiD algorithm accounts for uncertainty in contig ordering by subsampling mapped reads and re-calculating growth rate to derive a 95% confidence interval of growth estimates. Additionally, because metagenomic bins can be contaminated with contigs from other genomes, which may impact growth predictions in samples with high coverage of the contaminant, we introduced a quality control step using the position of the universal chromosome initiator replication gene (<italic>dnaA</italic>), and deletion-induced filamentation (<italic>dif</italic>) sequences (a conserved 28&#x02009;bp sequence) across the genome, when available. In most bacterial genomes, <italic>dnaA</italic> is located in close proximity to the <italic>ori</italic><sup><xref ref-type="bibr" rid="CR7">7</xref></sup> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1E</xref>), while replication typically terminates at/near <italic>dif</italic> sequences<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. Therefore, accurate GRiD predictions in rapidly dividing cells should have <italic>dnaA</italic> and <italic>dif</italic> coverage similar to those of <italic>ori</italic> and <italic>ter</italic>, respectively (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). Finally, GRiD outputs a metric, called &#x0201c;species heterogeneity&#x0201d; which is an estimate of the degree to which closely related species contributes to variance in growth predictions, which would result from reads that are incorrectly assigned to the genome of interest.</p></sec><sec id="Sec4"><title>GRiD is accurate for draft genomes at ultra-low coverage</title><p id="Par12">We tested our method using pure cultures of <italic>Staphylococcus epidermidis</italic> (NIHLM023) and <italic>Corynebacterium simulans</italic> (Wattiau) harvested at different time points during exponential growth (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1F</xref>). To calculate GRiD and iRep, we utilized draft sequences of strains of the aforementioned species (<italic>S. epidermidis</italic> NIHLM023; <italic>C. simulans</italic> strain 1B08) and asked if initial estimates by both methods can be accurately reproduced when subsampled to ultra-low coverage levels. GRiD was highly reproducible compared to iRep&#x02019;s low reproducibility (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>).</p><p id="Par13">To demonstrate real-world applications enabled by GRiD, we examined <italic>S. epidermidis</italic> growth rate in a longitudinal skin metagenomic dataset of 698 samples of varying depth and microbial diversity<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. We chose <italic>S. epidermidis</italic> because of its ubiquity yet large relative abundance range in the skin. Moreover, it would provide a difficult scenario for growth rate prediction due to prevalent genetic strain variation<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, which would increase noise. First, we benchmarked PTR using a closed reference genome, and then the same genome fragmented into 100kb fragments and reshuffled to mimic a draft genome for GRiD and iRep measurements. Reads mapping to <italic>S. epidermidis</italic> were subsampled to 0.4&#x000d7; and 0.2&#x000d7; coverage and subsequently used for GRiD and iRep estimates. iRep performed similarly to the PTR benchmark, but GRiD had a much lower percentage of error in comparison to iRep at both 0.4&#x000d7; and 0.2&#x000d7; coverage (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref>). To highlight the importance of accounting for ambiguous reads during growth estimation, reads mapping to <italic>S. epidermidis</italic> were re-mapped to <italic>S. capitis, S. aureus</italic>, and <italic>Propionibacterium acnes</italic> genomes to determine the proportion of multiple-mapping reads. Samples with increasing numbers of multi-mapped, ambiguous reads were significantly correlated with our metric of increasing species heterogeneity (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1d</xref>), which can increase uncertainty in growth rate estimation. For quality control, we found that a combination of <italic>dnaA</italic> coverage, <italic>dif</italic> coverage, and species heterogeneity can be used to ascertain the accuracy of growth predictions. Our findings suggest that growth rates are most accurate when <italic>dnaA/ori</italic> and <italic>ter/dif</italic> coverage ratios approach one, and species heterogeneity is low (&#x0003c;0.3, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2A</xref>). Finally, we demonstrated that GRiD is effective even with highly fragmented genome/metagenomic bins &#x02013; at 0.2&#x000d7; coverage, we found that GRiD requires &#x02264;90 fragments/Mbp. At 1&#x000d7; coverage, GRiD is accurate even with &#x0003e;200 fragments/Mbp and 50% genome completeness (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2B and C</xref>).</p><p id="Par14">To demonstrate its versatility, we also benchmarked GRiD using uncultivated Candidate Phyla Radiation (CPR) genomes recovered from an environmental groundwater dataset<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. CPR is a major subdivision within the domain Bacteria, and is characterized by small cells and genomes suggested to be symbionts<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Growth estimates using GRiD and iRep indicated these genomes are generally slow-growing (i.e., <italic>ori/ter</italic>&#x02009;<italic>&#x0003c;</italic>&#x02009;1.5, Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1e</xref>). GRiD and iRep values were uncorrelated. However, when we subsampled mapped reads to mimic ultra-low coverage, GRiD values were reproducible whereas iRep was not (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1e</xref>), underscoring iRep&#x02019;s decreased performance as a function of coverage.</p></sec><sec id="Sec5"><title>GRiD uncovers new biology from metagenomic datasets</title><p id="Par15">We next investigated GRiD&#x02019;s ability to provide new biological insights from metagenomic data by calculating growth dynamics of rare uncharacterized skin microbes reconstructed de novo from a large metagenomic dataset. We assembled reads, grouping contigs into &#x0201c;bins&#x0201d; approximating genomes based on co-abundance clustering and nucleotide composition<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). Using high quality bins (see Methods for criteria), we defined a genome bin as rare if it was present in fewer than 3% of samples. Three bins that could not be annotated to the species level met this threshold (bin.443, bin.481, and bin.257; Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>). These putative microbes were only present in a few individuals and had relatively stable growth rates over time despite fluctuations in relative abundance. Surprisingly, bin.257 appeared to stably colonize the toenail of one individual as indicated by increasing relative abundance over time while maintaining a constant growth rate (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>). We noted that despite the low coverage (1.68&#x000d7;) and high fragmentation (415 contigs, median size&#x02009;=&#x02009;5.5 Kb) of bin.443, GRiD contig reordering accurately positioned <italic>dnaA</italic> and <italic>dif</italic> sequences near the peak and trough regions respectively (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>GRiD uncovers new biology from human and environmental communities. <bold>a</bold> Growth rate of rare uncharacterized bacteria over time from a skin metagenomic dataset. Uncharacterized bacteria were identified using de novo assembly of reads and metagenomic binning, with each bin representing a genome. The sampling interval between timepoints T1 and T2 is 10&#x02013;30 months while sampling intervals between T2 and T3 are 5&#x02013;10 weeks. Tn&#x02009;=&#x02009;toenail. <bold>b</bold> Growth rate of bacteria that were significantly different (<italic>p</italic>&#x02009;&#x0003c;&#x02009;0.05, Wilcoxon rank-sum test) between unaffected and disease sites in a psoriasis skin metagenomic dataset. Center lines in boxplots represent the median and the edges represent the first and third quartiles. <bold>c</bold> Inter-individual bacterial growth differences and association with patient characteristics. Each data point in the scatterplots represents the average GRiD score of each patient. Statistical differences between population groups were determined using the Wilcoxon rank-sum test while Spearman correlation was utilized for correlation coefficient analyses. <bold>d</bold> Growth dynamics of <italic>Bdellovibrio</italic> species. Flagellated <italic>Bdellovibrio</italic> penetrates the outer membrane of Gram-negative bacteria into the periplasmic space (losing its flagella in the process), grows and elongates without cell division, resulting in a helical filament with multiple copies of the genome. As food supply from the host becomes exhausted, the filament divides by fission into multiple smaller cells and exits the host. GRiD plots represent examples of different growth phases in the life cycle of <italic>Bdellovibrio</italic> obtained from marine and sludge environmental samples. The scatter plots below show Spearman correlation between <italic>Bdellovibrio</italic> growth and relative abundance of different group of microbes. Each data point represents the average GRiD score per sample. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2018_7240_Fig2_HTML" id="d29e643"/></fig></p><p id="Par16">We further applied GRiD to a skin metagenomic dataset of individuals with psoriasis<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, a long-lasting autoimmune disease characterized by patches of abnormal skin<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, to see if GRiD could identify rapidly growing microbes or antagonistic interactions that could be associated with the disease state. Using draft genomes, the growth rate of three microbes differed between disease and unaffected sites (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>). Strikingly, we found previously unidentified associations between microbial growth rate and patient characteristics (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3A</xref>). For instance, <italic>Corynebacterium pseudogenitalium</italic> had higher average growth rates in male patients compared to females (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref>), in agreement with previous reports suggesting gender-specificity of some <italic>Corynebacterium</italic> species<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Inter-individual comparisons indicated that some microbes grew more rapidly in individuals with increased disease severity&#x02014;Psoriasis Area Severity Index (PASI) and Body Surface Area (BSA)&#x02014;were correlated with <italic>Staphylococcus auricularis</italic> growth, and longer disease duration with <italic>Acinetobacter ursingii</italic> (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3A</xref>). These represent significant new biological insights that underscore the importance of the GRiD approach, as no associations were previously observed between microbial relative abundance and patient characteristics<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par17">Finally, we measured growth dynamics of uncharacterized <italic>Bdellovibrio</italic> species reconstructed from different environmental samples<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. <italic>Bdellovibrio</italic> species are predators of Gram-negative bacteria and grow within the periplasmic space of their host<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>). Although, we identified <italic>Bdellovibrio</italic> as generally slow-growing (consistent for endosymbionts, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3B</xref>), certain microbes with very high GRiD values were identified in some samples (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>). Such high GRiD values would be expected for fast growing microbes employing multi-fork replication. Notably, this is the first observation of a potential multi-fork replication in an endosymbiont. GRiD also corroborated known biology, identifying a negative correlation between <italic>Bdellovibrio</italic> growth and relative abundance of Gram-negative bacteria (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>). Interestingly, <italic>Bdellovibrio</italic> growth was not correlated with abundance of Gram-positive bacteria, suggesting that microbial competition in non-human environmental communities is mainly restricted to Gram-negatives and Fungi (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>).</p></sec><sec id="Sec6"><title>High-throughput estimation of bacterial growth</title><p id="Par18">Having benchmarked our algorithm with diverse human and environmental datasets, we noted the significant value that could be derived from a systematic investigation of growth rate within a microbial community. Thus, we expanded GRiD&#x02019;s utility as a high-throughput and systematic metagenomic (MG) analysis tool (GRiD-MG). In this case, growth rate can be estimated for most identified bacteria in a given sample passing coverage thresholds, without a requirement for prior knowledge of microbial composition or abundance. GRiD-MG maps samples from a dataset to a GRiD-MG database comprising of 32,819 representative bacterial species (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>). The GRiD-MG database can be readily updated using metagenomic bins or custom genome sequences. Depending on user preferences, reads mapping to multiple genomes are re-assigned using Pathoscope 2.0<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and genomes with coverage values below the user-defined threshold are discarded (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>). To ensure that growth estimates using GRiD-MG were concordant with results obtained using individual reference genomes, we synthesized mock reads for five genomes with varying coverage to mimic growing bacteria and calculated growth rate. Growth estimates were highly concordant in both cases (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>GRiD-MG for high throughput, multiplex estimations of growth rate. <bold>a</bold> Pipeline for GRiD-MG. Sample reads from a dataset are mapped to a GRiD-MG database. The database can be updated using metagenomic bins or newly sequenced genomes. Two output files are generated for every sample; a text file of genomes and their respective GRiD values, and a pdf file displaying heatmap of growth values with hierarchical clustering. <bold>b</bold> Correlation between GRiD-MG and GRiD values obtained using single isolate genomes. Mock reads were generated for 5 genomes for growth analyses. <bold>c</bold> Growth rate correlation between bacterial species in foot sites. Blue and red circles indicate positive and negative Spearman correlation respectively. Larger circles and darker colors indicate a higher correlation. The plot on the right represents competitive exclusion between <italic>Staphylococcus</italic> and <italic>Corynebacterium</italic> species. Microbes with GRiD score below 1.02 (vertical and horizontal red lines) were considered as non-replicating. <bold>d</bold> Biosynthetic gene clusters (BGC) identified in genome sequences of <italic>S. pasteuri</italic> strains retrieved from NCBI. The figure below shows a lantipeptide BGC identified in strain BAB3. All BGCs were predicted using antiSMASH<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. <bold>e</bold> Spearman correlation between <italic>S. pasteuri</italic> growth rate and the relative abundance of its lantipeptide BGC. The figure on the right shows the effect of <italic>S. pasteuri</italic> lantipeptide BGC abundance on growth rate of <italic>Corynebacterium sp</italic>. GRiD scores below 1.02 (red vertical line) are considered as non-replicating. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2018_7240_Fig3_HTML" id="d29e801"/></fig></p><p id="Par19">We next applied GRiD-MG to our 698-sample metagenomic skin dataset and sought to identify potential antagonistic associations within the community. These samples were obtained from several body sites broadly classified based on skin site morphology as either dry, moist, oily, or foot sites<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Interestingly, growth antagonism was observed among several microbes that were site specific (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3c</xref>, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3C &#x02013; E</xref>). Notably, in foot sites, growth rates of <italic>Staphylococcus capitis</italic> and <italic>Staphylococcus pasteuri</italic> were antagonistic to several <italic>Corynebacterium</italic> species, and the observed antagonism was a likely scenario of competitive exclusion (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3c</xref>).</p><p id="Par20">While <italic>S. capitis</italic> has previously been identified as a producer of antimicrobials capable of inhibiting numerous Gram-positive bacteria<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, there is little information on <italic>S. pasteuri</italic>. We therefore hypothesized that <italic>S. pasteuri</italic> may produce antimicrobials to provide a competitive growth advantage within the skin community. We first screened all publicly available sequences of <italic>S. pasteuri</italic> strains for the presence of antimicrobial biosynthetic gene clusters (BGC) and identified two strains harboring a lantipeptide BGC (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref>). We then analyzed the presence of this BGC across all foot sites and found that its abundance was positively correlated with <italic>S. pasteuri</italic> growth, suggesting that its viability in foot sites is strongly dependent on antimicrobial production (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3e</xref>). Similarly, the occurrence of the lantipeptide BGC was also consistent with a putative inhibition of <italic>Corynebacterium</italic> (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3e</xref>). These data underscore the ability of GRiD-MG to uncover new associations and hypotheses based on large-scale analyses of growth rate dynamics within a microbial community.</p><p id="Par21">In summary, GRiD and GRiD-MG provide a significant advance in their ability to systematically estimate bacterial growth rate using metagenomic data. GRiD is highly effective even at ultra-low sequencing coverage, making it particularly applicable to complex metagenomic datasets with draft quality and de novo assembled, uncultivated bacteria. However, it is important to note that the performance of many algorithms for metagenomic analyses can vary based on different input parameters. For example, using different assemblers or reference genomes with varying degrees of fragmentation with GRiD, iRep, or PTR can affect growth rate inferences. Therefore, best practice remains to broadly survey different predictions to avoid misrepresentations of the underlying biology. Here, we particularly recommend, where possible, to utilize a reference strain with the least fragmentation. Correspondingly, we constructed our default GRiD-MG database using the most complete set of representative strains as possible. This also supports GRiD&#x02019;s particular attention to robustness and accuracy, as it provides multiple statistical estimates to minimize erroneous estimations due to noise that may arise from misassemblies in reconstructed genome bins or significant genetic strain variation that may be present in a sample. Finally, by examining growth rates in high-throughput, new associations between bacterial growth dynamics can be inferred, either in interspecies interactions or in new associations with, for example, host characteristics.</p></sec></sec><sec id="Sec7"><title>Methods</title><sec id="Sec8"><title>GRiD approach</title><p id="Par22">GRiD measures the growth rate of uncharacterized bacteria or bacteria with draft quality genomes from metegenomic samples. GRiD is designed for use with a specific reference genome, or in a high-throughput manner for multiplex analysis of identified bacterial population present within a sample.</p><p id="Par23">The GRiD algorithm is based on the principle that most bacteria harbor a circular chromosome that is replicated bi-directionally from the origin of replication (<italic>ori</italic>) to the terminus (<italic>ter</italic>) region<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Therefore, a rapidly dividing bacterium at any given time will have more copies of DNA close to the <italic>ori</italic> in comparison to the <italic>ter</italic>.</p><p id="Par24">Reads from a metagenomic sample are first mapped to a given genome (including metagenomic bins or draft genome) and the mean coverage of each contig is calculated and contigs are sorted from high-to-low coverage. The sorted coverage information is then sequentially distributed alternatively between two temporary files, with one of the files re-sorted from low-to-high coverage (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). Both temporary files are then merged to produce a coverage pattern with high coverage contigs at both extremes, while low coverage contigs located mid-region. Using this sorted reordering, contigs are concatenated and coverage across each nucleotide is derived. GRiD then calculates coverage drops across a 10 Kb window and outlier points (i.e. values below Q1 &#x02013; (1.5&#x02009;&#x000d7;&#x02009;IQR) and above Q3&#x02009;+&#x02009;(1.5&#x02009;&#x000d7;IQR); where Q1 and Q3 are the first and third quartiles, respectively, while IQR is the interquartile range) are excluded. A smoothing curve is then fitted by a re-descending M estimator with Tukey&#x02019;s biweight function<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. This enables the fit to be resistant to noise arising from species heterogeneity and low coverage. GRiD values represent the coverage ratio of the peak and trough of the curve, in which case, GRiD values are directly proportional to growth rate.</p><p id="Par25">Generally, coverage information derived from a sample containing multiple diverse strains can be prone to noise, which will invariably have an impact on accurate growth estimates. In other words, core regions of genomes will have unusually high coverage compared to accessory regions. Similarly, microbes present at ultra-low coverage can be prone to noise due to a wider coverage distribution resulting from contigs with an average coverage of zero. To circumvent these limitations, GRiD incorporates a refinement step. Here, for the peak coverage value, the lowest point of expected variation of the mean value is chosen. Likewise, the upper point of variance of the trough mean is selected for the trough value (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1C</xref>). The resulting growth value is called &#x0201c;GRiD_refined&#x0201d;. This refinement step markedly improves the reproducibility of GRiD predictions (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1D</xref>). Additionally, to account for uncertainty arising from contig reordering, GRiD performs a subsampling step twice by randomly extracting 85% of reads that mapped to a genome. GRiD then calculates and outputs a 95% confidence interval from all three growth values (i.e., including GRiD_refined). Finally, ambiguous reads (i.e., reads mapping to multiple genomes) can result in erroneous estimates. GRiD outputs a metric called &#x0201c;species heterogeneity&#x0201d; which measures the contribution of ambiguous reads to growth estimate. Here, species heterogeneity&#x02009;=&#x02009;(1 &#x02013; <italic>r</italic>/<italic>u</italic>), where <italic>r</italic>&#x02009;=&#x02009;GRiD_refined, and <italic>u</italic>&#x02009;=&#x02009;GRiD_unrefined (i.e., growth rate calculated directly from the means of the peak and trough).</p><p id="Par26">Additionally, since metagenomic bins can be contaminated with contigs from other genomes, which may impact growth predictions especially in samples where contaminating contigs contain high coverage, GRiD estimates can be quality-checked, whenever possible, using the coverage information of chromosome initiator replication gene (<italic>dnaA</italic>) and deletion-induced filamentation (<italic>dif</italic>) sequences across the genome. <italic>dnaA</italic> is usually located close to the <italic>ori</italic> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1E</xref>), whereas replication terminates at or near <italic>dif</italic> sequences<sup><xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref></sup>. Therefore, in rapidly dividing cells, the coverage values for the peak and <italic>dnaA</italic> should be similar. Likewise, the coverage values for <italic>dif</italic> and <italic>ter</italic> should be identical. GRiD output includes both <italic>dnaA/ori</italic> and <italic>ter/dif</italic> ratios. Growth rate estimates are most likely accurate when <italic>dnaA/ori</italic> and <italic>ter/dif</italic> coverage ratios approach one, and species heterogeneity is low (&#x0003c;0.3) (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2A</xref>). Altogether, GRiD outputs seven values for every sample; (i) GRiD refined, (ii) 95% confidence interval, (iii) GRiD unrefined, (iv) species heterogeneity, (v) coverage,&#x000a0;(vi) <italic>dnaA/or</italic>i ratio, and (vii) <italic>ter/dif</italic> ratio.</p></sec><sec id="Sec9"><title>GRiD-MG</title><p id="Par27">For multiplex screening of the identified bacterial population in a given sample, GRiD-MG maps metagenomics reads to a custom GRiD-MG database consisting of 32,819 bacterial genomes (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>). This database contains one representative genome per specie. In additional, the GRiD-MG database can be easily updated using metagenomic bins or newly sequenced genomes. Depending on user preferences, reads mapping to multiple genomes are reassigned using Pathoscope 2.0<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and the extent to which reads are reassigned is defined using the &#x0201c;theta-prior&#x0201d; option. In addition, a user can specify a coverage cutoff greater than 0.2&#x000d7; in which case, genomes with coverage below the cutoff are discarded. For coverage cutoff&#x000a0;&#x0003c;1&#x000d7;, only genomes with 90 fragments/Mbp or less are included in the analysis since increased fragmentation results in inaccurate results at ultra-low coverage (Supplementary Figure&#x000a0;<xref rid="MOESM1" ref-type="media">2B</xref>). We included additional stringency to the algorithm to reduce the likelihood of outputting false growth estimates. First, upon coverage calculation using a 10kb window as described above, genomes with coverage medians &#x0003c;0.15 are considered as non-replicating. Second, GRiD values greater than 10 are discarded as this may be due to a high coverage of a contaminant contig present in a metagenomic bin or genome in a given sample. Third, GRiD values greater than 3 for genomes with sizes less than 4&#x02009;Mb are discarded. This is because GRiD values greater than 2 indicate the presence of multi-fork replication machinery which has mostly been identified in genomes with sizes &#x0003e;4Mb<sup><xref ref-type="bibr" rid="CR20">20</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref></sup>. Two output files are generated per sample; a text file of genomes and their respective GRiD scores, and a pdf file displaying heatmap of growth values with hierarchical clustering (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>). Text output for all samples can be merged into a single matrix file.</p></sec><sec id="Sec10"><title><italic>dnaA</italic> and <italic>dif</italic> database</title><p id="Par28">To determine the coverage of <italic>dnaA</italic> and <italic>dif</italic> sequences, we built a database comprising of 217 bacterial <italic>dnaA</italic> sequences that were obtained from NCBI, and 714 <italic>dif</italic> sequences retrieved from the Database of Bacterial Replication Terminus (<ext-link ext-link-type="uri" xlink:href="http://www.g-language.org/data/repter/db.html">http://www.g-language.org/data/repter/db.html</ext-link>). We then searched for homologs within a bin or genome using BLAST<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> (-evalue 0.05) and the topmost hit was selected.</p></sec><sec id="Sec11"><title>GRiD and iRep growth calculation from in vitro <italic>S. epidermidis</italic> and <italic>C. simulans</italic></title><p id="Par29"><italic>S. epidermidis</italic> (NIHLM023) and <italic>C. simulans</italic> (Wattiau) were grown in Tryptic Soy Broth at 37&#x02009;&#x000b0;C. During cultivation, samples were harvested at five different time points between early and mid-exponential growth phase for DNA extraction and whole genome sequencing. We calculated GRiD and iRep using draft genomes of <italic>S. epidermidis</italic> (NIHLM023; 87 contigs) and <italic>C. simulans</italic> (strain 1B08; 66 contigs).</p></sec><sec id="Sec12"><title>GRiD and iRep growth calculation for CPR genomes</title><p id="Par30">We retrieved previously reported iRep data calculated from 12 samples using 99 CPR genomes<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. However, we restricted GRiD analysis to bacteria with draft genomes.</p></sec><sec id="Sec13"><title>Metagenomic binning of skin dataset</title><p id="Par31">We retrieved 698 metagenomic shotgun skin samples from our previous work<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Some samples (<italic>n</italic>&#x02009;=&#x02009;594) in this dataset were derived from longitudinal sampling of 12 individuals at three different time points with sampling intervals of 10&#x02013;30 months between time points 1 and 2 (T1 vs T2), and 5&#x02013;10 weeks between time points 2 and 3 (T2 vs T3). We began by concatenating all samples and assembling sequence reads into contigs and scaffolds using MEGAHIT<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. We initially chose MEGAHIT due to its capability for handling large data, low memory requirements, and short run time. We discarded contigs shorter than 1&#x02009;kb, mapped each individual sample back to the contigs catalogue using bowtie2<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, and extracted unmapped reads (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). Next, we concatenated unmapped reads and re-assembled using SPAdes (--meta)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. We chose SPAdes due to its ability to produce scaffolds from contigs. The newly extracted contigs/scaffolds were merged with the previous catalogue. We grouped our contigs/scaffolds into genome bins using MetaBAT (--sensitive, -m 1500)<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, which resulted in 556 bins, and subsequently utilized MEGAN<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> for taxonomic identification of contigs/scaffolds present within each bin. We excluded 22 bins that were of non-microbial origin and further evaluated the quality of each bin and marker lineage using CheckM<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. For stringent annotation, we required that &#x02265;65% of contigs/scaffolds present in a bin are assigned to the lowest level taxonomy; the sole exception being the kingdom-level taxonomy where our requirement was 40%.</p></sec><sec id="Sec14"><title>Determining the effect of genome fragmentation and completeness on GRiD</title><p id="Par32">We selected 12 bacteria bins (&#x02265;95% completeness and &#x02264;5% contamination) with varying degree of fragmentation ranging from 55 to 202 fragments/Mbp to determine the role of fragmentation on GRiD scores. For each bin, we used the sample producing the highest bin coverage. Reads mapping to each bin was subsampled to 0.2&#x000d7;, 0.4&#x000d7;, and 1&#x000d7; coverage for GRiD analysis. We concluded that bins with 90 or more fragments/Mbp are unsuitable for GRiD analysis at coverage levels below 1&#x000d7; (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2B</xref>).</p><p id="Par33">We used a bin having 89 fragments/Mbp, which was at the boundary for our accuracy cutoff at ultra-low coverage, to evaluate the impact of genome completeness on GRiD output. We subsampled contigs within each bin to attain the desired level of completeness prior to GRiD analysis. This subsampling step was repeated 10 times.</p></sec><sec id="Sec15"><title>GRiD estimate of rare bacteria</title><p id="Par34">We chose only high-quality bins (i.e.,&#x000a0;&#x02265;75% completeness and &#x02264;5% contamination based on single copy marker genes) for analysis. We defined a bin as rare if it was present in fewer than 3% of samples. Three bins (bins 257, 443, 481) met this threshold and were considered uncharacterized since they were unable to be annotated to the species level using either our 65% cutoff as mentioned above, or single copy marker gene lineage using CheckM<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Since these bins had &#x0003e;90 fragments/Mbp, we calculated GRiD in samples having bin coverage &#x02265;1&#x000d7;.</p></sec><sec id="Sec16"><title>GRiD calculations from psoriasis skin dataset</title><p id="Par35">We retrieved 73 metagenomic samples from Tett et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, which was a collection of skin samples from individuals with psoriasis. We obtained the species composition using Pathoscope 2.0<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and selected only species that were present in at least five samples (<italic>n</italic>&#x02009;=&#x02009;35).</p></sec><sec id="Sec17"><title>GRiD estimate of <italic>Bdellovibrio</italic> species</title><p id="Par36">From a previous genome construction effort using &#x0003e;1500 samples<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, we retrieved samples where species of <italic>Bdellovibrio</italic> were reconstructed (<italic>n</italic>&#x02009;=&#x02009;22). Of these, 15 samples were from marine environments, 3 from sludge, 2 from freshwater, and 1 each from groundwater and hydrocarbon environment. We calculated a total of 134 replication rates from these environments. We used Pathoscope 2.0<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> to determine the relative abundance of microbes.</p></sec><sec id="Sec18"><title>Generation of mock reads for GRiD-MG</title><p id="Par37">We generated mock read for <italic>Lactobacillus gasseri</italic>, <italic>Parabacteroides distasonis</italic>, <italic>Staphylococcus aureus, Staphylococcus epidermidis</italic>, and <italic>Campylobacter upsaliensis</italic> using wgsim package implemented in samtools<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Each genome was split into 100kb fragments and varying amount of reads was generated for each fragment in order to achieve differential coverage across the genome, and thus, mimic a replicating genome.</p></sec><sec id="Sec19"><title>Growth antagonism of skin bacteria</title><p id="Par38">We applied GRiD-MG to 698 metagenomic skin dataset collected from different skin sites. These samples were earlier classified into four groups based on their site characteristics as either dry, moist, oily, or foot sites<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. We subsampled 1 million reads for samples containing over a million reads. We used a coverage cutoff of 0.2&#x000d7; thereby discarding growth rate for genomes having &#x0003c;90 fragments/Mbp. We also did not utilize the Pathoscope reads reassignment option. This resulted in growth estimates for 1,756 bacterial species. For each site, correlation analyses were conducted for genomes present in &#x0003e;40% of samples. We identified biosynthetic gene clusters in <italic>Staphylococcus pasteuri</italic> strains using antiSMASH<sup><xref ref-type="bibr" rid="CR30">30</xref></sup></p></sec><sec id="Sec20"><title>Code availability</title><p id="Par39">The GRiD algorithm is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ohlab/GRiD">https://github.com/ohlab/GRiD</ext-link>.</p></sec></sec><sec sec-type="supplementary-material"><title>Electronic supplementary material</title><sec id="Sec21"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2018_7240_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2018_7240_MOESM2_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41467_2018_7240_MOESM3_ESM.xlsx"><caption><p>Source Data</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Electronic supplementary material</title><p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-018-07240-8.</p></sec><ack><title>Acknowledgements</title><p>We thank the Maximilian E. and Marion O. Hoffman Foundation for postdoctoral fellowship to A.E., and funding from the National Institutes of Health (1 DP2 GM126893-01 and&#x000a0;K22 AI119231-01) for J.O. We also thank Asaf Peer for making GRiD installation possible through Bioconda, Wei Zhou for providing the genomes used in creating the GRiD database, and Elizabeth Fleming for sequence library preparation. We thank the Oh lab for critical commentary and algorithm testing.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>A.E. and J.O.: Conception, experimental design, software development, data analysis, and manuscript writing.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>Sequence reads generated for <italic>S. epidermidis</italic> and <italic>C. simulans</italic> in vitro growth analyses have been deposited in SRA with accession/identification number SRP151711.&#x000a0;The accession numbers are available from NCBI for longitudinal skin dataset (BioProject PRJNA46333), groundwater filtrates (BioProject PRJNA268031), and psoriasis patients (BioProject PRJNA281366). For <italic>Bdellovibrio</italic> (BioProject PRJNA348753) analysis, the following Sequence Reads Archive accessions were used; SRR948155, SRR948284, SRR2043728, SRR636581, ERR599000, ERR594331, ERR594318, ERR599136, ERR599142, ERR594299, ERR594326, ERR594335, ERR599038, ERR599044, ERR594348, ERR594349, ERR594311, ERR594294, ERR594308, SRR1506988, SRR1506983, SRR1506986. CPR genomes (BioProject PRJNA273161) are available from NCBI GenBank. A reporting summary for this Article is available as a Supplementary Information file. The source data underlying Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>&#x02013;<xref rid="Fig3" ref-type="fig">3</xref>, and Supplementary Figs&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>&#x02013;<xref rid="Fig3" ref-type="fig">3</xref> are provided as a Source Data file. All relevant data are available upon request.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>HB</given-names></name><etal/></person-group><article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title><source>Nat. Biotechnol.</source><year>2014</year><volume>32</volume><fpage>822</fpage><lpage>828</lpage><pub-id pub-id-type="doi">10.1038/nbt.2939</pub-id><pub-id pub-id-type="pmid">24997787</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>YC</given-names></name><etal/></person-group><article-title>Resolving the complexity of human skin metagenomes using single-molecule sequencing</article-title><source>mBio</source><year>2016</year><volume>7</volume><fpage>e01948</fpage><lpage>01915</lpage><pub-id pub-id-type="doi">10.1128/mBio.01948-15</pub-id><pub-id pub-id-type="pmid">26861018</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korem</surname><given-names>T</given-names></name><etal/></person-group><article-title>Growth dynamics of gut microbiota in health and disease inferred from single metagenomic samples</article-title><source>Science</source><year>2015</year><volume>349</volume><fpage>1101</fpage><lpage>1106</lpage><pub-id pub-id-type="doi">10.1126/science.aac4812</pub-id><pub-id pub-id-type="pmid">26229116</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>JD</given-names></name><name><surname>Levin</surname><given-names>PA</given-names></name></person-group><article-title>Metabolism, cell growth and the bacterial cell cycle</article-title><source>Nat. Rev. Microbiol.</source><year>2009</year><volume>7</volume><fpage>822</fpage><lpage>827</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2202</pub-id><pub-id pub-id-type="pmid">19806155</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>CT</given-names></name><name><surname>M. Olm</surname><given-names>MR</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><article-title>Measurement of bacterial replication rates in microbial communities</article-title><source>Nat. Biotechnol.</source><year>2016</year><volume>34</volume><fpage>1256</fpage><lpage>1263</lpage><pub-id pub-id-type="doi">10.1038/nbt.3704</pub-id><pub-id pub-id-type="pmid">27819664</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kafadar</surname><given-names>K</given-names></name></person-group><article-title>The efficiency of the biweight as a robust estimator of location</article-title><source>J. Res Natl. Bur. Stand.</source><year>1983</year><volume>88</volume><fpage>105</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.6028/jres.088.006</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mackiewicz</surname><given-names>P</given-names></name><name><surname>Zakrzewska-Czerwi&#x00144;ska</surname><given-names>J</given-names></name><name><surname>Zawilak</surname><given-names>A</given-names></name><name><surname>Dudek</surname><given-names>MR</given-names></name><name><surname>Cebrat</surname><given-names>S</given-names></name></person-group><article-title>Where does bacterial replication start? Rules for predicting the oriC region</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>3781</fpage><lpage>3791</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh699</pub-id><pub-id pub-id-type="pmid">15258248</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hendrickson</surname><given-names>H</given-names></name><name><surname>Lawrence</surname><given-names>JG</given-names></name></person-group><article-title>Mutational bias suggests that replication termination occurs near the dif site, not at Ter sites</article-title><source>Mol. Microbiol.</source><year>2007</year><volume>64</volume><fpage>42</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2958.2007.05596.x</pub-id><pub-id pub-id-type="pmid">17376071</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kono</surname><given-names>N</given-names></name><name><surname>Arakawa</surname><given-names>K</given-names></name><name><surname>Tomita</surname><given-names>M</given-names></name></person-group><article-title>Comprehensive prediction of chromosome dimer resolution sites in bacterial genomes</article-title><source>BMC Genom.</source><year>2011</year><volume>12</volume><fpage>19</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-12-19</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oh</surname><given-names>J</given-names></name><etal/></person-group><article-title>Temporal stability of the human skin microbiome</article-title><source>Cell</source><year>2016</year><volume>165</volume><fpage>854</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.04.008</pub-id><pub-id pub-id-type="pmid">27153496</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conlan</surname><given-names>S</given-names></name><etal/></person-group><article-title>Staphylococcus epidermidis pan-genome sequence analysis reveals diversity of skin commensal and hospital infection-associated isolates</article-title><source>Genome Biol.</source><year>2012</year><volume>13</volume><fpage>R64</fpage><pub-id pub-id-type="doi">10.1186/gb-2012-13-7-r64</pub-id><pub-id pub-id-type="pmid">22830599</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>DD</given-names></name><name><surname>Froula</surname><given-names>J</given-names></name><name><surname>Egan</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name></person-group><article-title>MetaBAT, an efficient tool for accurately reconstructing single genomes from complex microbial communities</article-title><source>PeerJ</source><year>2015</year><volume>3</volume><fpage>e1165</fpage><pub-id pub-id-type="doi">10.7717/peerj.1165</pub-id><pub-id pub-id-type="pmid">26336640</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tett</surname><given-names>A</given-names></name><etal/></person-group><article-title>Unexplored diversity and strain-level structure of the skin microbiome associated with psoriasis</article-title><source>NPJ Biofilms Micro.</source><year>2017</year><volume>3</volume><fpage>14</fpage><pub-id pub-id-type="doi">10.1038/s41522-017-0022-5</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parisi</surname><given-names>R</given-names></name><name><surname>Symmons</surname><given-names>DP</given-names></name><name><surname>Griffiths</surname><given-names>CE</given-names></name><name><surname>Ashcroft</surname><given-names>DM</given-names></name></person-group><article-title>Global epidemiology of psoriasis: a systematic review of incidence and prevalence</article-title><source>J. Invest. Dermatol.</source><year>2013</year><volume>133</volume><fpage>377</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1038/jid.2012.339</pub-id><pub-id pub-id-type="pmid">23014338</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belmares</surname><given-names>J</given-names></name><name><surname>Detterline</surname><given-names>S</given-names></name><name><surname>Pak</surname><given-names>JB</given-names></name><name><surname>Parada</surname><given-names>JP</given-names></name></person-group><article-title>Corynebacterium endocarditis species-specific risk factors and outcomes</article-title><source>BMC Infect. Dis.</source><year>2007</year><volume>7</volume><fpage>4</fpage><pub-id pub-id-type="doi">10.1186/1471-2334-7-4</pub-id><pub-id pub-id-type="pmid">17284316</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>DH</given-names></name><etal/></person-group><article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title><source>Nat. Microbiol.</source><year>2017</year><volume>2</volume><fpage>1533</fpage><pub-id pub-id-type="doi">10.1038/s41564-017-0012-7</pub-id><pub-id pub-id-type="pmid">28894102</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harini</surname><given-names>K</given-names></name><name><surname>Ajila</surname><given-names>V</given-names></name><name><surname>Hegde</surname><given-names>S</given-names></name></person-group><article-title>Bdellovibrio bacteriovorus: a future antimicrobial agent?</article-title><source>J. Indian Soc. Periodontol.</source><year>2013</year><volume>17</volume><fpage>823</fpage><pub-id pub-id-type="doi">10.4103/0972-124X.124534</pub-id><pub-id pub-id-type="pmid">24554900</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hong</surname><given-names>C</given-names></name><etal/></person-group><article-title>PathoScope 2.0: a complete computational framework for strain identification in environmental or clinical sequencing samples</article-title><source>Microbiome</source><year>2014</year><volume>2</volume><fpage>33</fpage><pub-id pub-id-type="doi">10.1186/2049-2618-2-33</pub-id><pub-id pub-id-type="pmid">25225611</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>R</given-names></name><name><surname>Jangir</surname><given-names>PK</given-names></name><name><surname>Das</surname><given-names>J</given-names></name><name><surname>Taneja</surname><given-names>B</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name></person-group><article-title>Genome analysis of <italic>Staphylococcus capitis</italic> TE8 reveals repertoire of antimicrobial peptides and adaptation strategies for growth on human skin</article-title><source>Sci. Rep.</source><year>2017</year><volume>7</volume><fpage>10447</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-11020-7</pub-id><pub-id pub-id-type="pmid">28874737</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Youngren</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>HJ</given-names></name><name><surname>Jun</surname><given-names>S</given-names></name><name><surname>Austin</surname><given-names>S</given-names></name></person-group><article-title>The multifork <italic>Escherichia coli</italic> chromosome is a self-duplicating and self-segregating thermodynamic ring polymer</article-title><source>Genes &#x00026; Dev.</source><year>2014</year><volume>28</volume><fpage>71</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1101/gad.231050.113</pub-id><pub-id pub-id-type="pmid">24395248</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soler-Bistu&#x000e9;</surname><given-names>A</given-names></name><name><surname>Timmermans</surname><given-names>M</given-names></name><name><surname>Mazel</surname><given-names>D</given-names></name></person-group><article-title>The proximity of ribosomal protein genes to <italic>oriC</italic> enhances <italic>Vibrio cholerae</italic> fitness in the absence of multifork replication</article-title><source>mBio</source><year>2017</year><volume>8</volume><fpage>e00097</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1128/mBio.00097-17</pub-id><pub-id pub-id-type="pmid">28246358</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trojanowski</surname><given-names>D</given-names></name><name><surname>Ho&#x00142;&#x000f3;wka</surname><given-names>J</given-names></name><name><surname>Ginda</surname><given-names>K</given-names></name><name><surname>Jakimowicz</surname><given-names>D</given-names></name><name><surname>Zakrzewska-Czerwi&#x00144;ska</surname><given-names>J</given-names></name></person-group><article-title>Multifork chromosome replication in slow-growing bacteria</article-title><source>Sci. Rep.</source><year>2017</year><volume>7</volume><fpage>43836</fpage><pub-id pub-id-type="doi">10.1038/srep43836</pub-id><pub-id pub-id-type="pmid">28262767</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C</given-names></name><etal/></person-group><article-title>BLAST+: architecture and applications</article-title><source>BMC Bioinforma.</source><year>2009</year><volume>10</volume><fpage>421</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>CM</given-names></name><name><surname>Luo</surname><given-names>R</given-names></name><name><surname>Sadakane</surname><given-names>K</given-names></name><name><surname>Lam</surname><given-names>TW</given-names></name></person-group><article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>1674</fpage><lpage>1676</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id><pub-id pub-id-type="pmid">25609793</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat. Methods</source><year>2012</year><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bankevich</surname><given-names>A</given-names></name><etal/></person-group><article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title><source>J. Comput. Biol.</source><year>2012</year><volume>19</volume><fpage>455</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id><pub-id pub-id-type="pmid">22506599</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><name><surname>Auch</surname><given-names>AF</given-names></name><name><surname>Qi</surname><given-names>J</given-names></name><name><surname>Schuster</surname><given-names>SC</given-names></name></person-group><article-title>MEGAN analysis of metagenomic data</article-title><source>Genome Res.</source><year>2007</year><volume>17</volume><fpage>377</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id><pub-id pub-id-type="pmid">17255551</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Imelfort</surname><given-names>M</given-names></name><name><surname>Skennerton</surname><given-names>CT</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name></person-group><article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title><source>Genome Res.</source><year>2015</year><volume>25</volume><fpage>1043</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id><pub-id pub-id-type="pmid">25977477</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>T</given-names></name><etal/></person-group><article-title>antiSMASH 3.0-a comprehensive resource for the genome mining of biosynthetic gene clusters</article-title><source>Nucleic Acids Res.</source><year>2015</year><volume>43</volume><fpage>W237</fpage><lpage>W243</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv437</pub-id><pub-id pub-id-type="pmid">25948579</pub-id></element-citation></ref></ref-list></back></article>
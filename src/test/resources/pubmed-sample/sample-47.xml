
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">20885779</article-id><article-id pub-id-type="pmc">2944781</article-id><article-id pub-id-type="publisher-id">10-PLCB-RA-2098R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000937</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biochemistry/Bioinformatics</subject><subject>Computational Biology/Bio-ontology</subject></subj-group></article-categories><title-group><article-title>Semantic Similarity for Automatic Classification of Chemical Compounds</article-title><alt-title alt-title-type="running-head">Semantic Similarity of Compounds</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ferreira</surname><given-names>Jo&#x000e3;o D.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1">
<sup>&#x0002a;</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Couto</surname><given-names>Francisco M.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib></contrib-group><aff id="aff1"><addr-line>LaSIGE, University of Lisbon, Lisbon, Portugal</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Mitchell</surname><given-names>John B. O.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of St Andrews, United Kingdom</aff><author-notes><corresp id="cor1">&#x0002a; E-mail: <email>joao.ferreira@lasige.di.fc.ul.pt</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: JDF FMC. Performed the experiments: JDF. Analyzed the data: JDF. Wrote the paper: JDF FMC.</p></fn></author-notes><pub-date pub-type="collection"><month>9</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>23</day><month>9</month><year>2010</year></pub-date><volume>6</volume><issue>9</issue><elocation-id>e1000937</elocation-id><history><date date-type="received"><day>18</day><month>4</month><year>2010</year></date><date date-type="accepted"><day>23</day><month>8</month><year>2010</year></date></history><permissions><copyright-statement>Ferreira, Couto.</copyright-statement><copyright-year>2010</copyright-year><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p></license></permissions><abstract><p>With the increasing amount of data made available in the chemical field, there is a strong need for systems capable of comparing and classifying chemical compounds in an efficient and effective way. The best approaches existing today are based on the structure-activity relationship premise, which states that biological activity of a molecule is strongly related to its structural or physicochemical properties. This work presents a novel approach to the automatic classification of chemical compounds by integrating semantic similarity with existing structural comparison methods. Our approach was assessed based on the Matthews Correlation Coefficient for the prediction, and achieved values of 0.810 when used as a prediction of blood-brain barrier permeability, 0.694 for P-glycoprotein substrate, and 0.673 for estrogen receptor binding activity. These results expose a significant improvement over the currently existing methods, whose best performances were 0.628, 0.591, and 0.647 respectively. It was demonstrated that the integration of semantic similarity is a feasible and effective way to improve existing chemical compound classification systems. Among other possible uses, this tool helps the study of the evolution of metabolic pathways, the study of the correlation of metabolic networks with properties of those networks, or the improvement of ontologies that represent chemical information.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>Among the existing systems capable of computationally comparing chemical compounds, the majority use only structural and physicochemical properties. However, with the emergence of ChEBI and other chemical compound databases, it has become feasible to create a system that can use the relevance of compounds in a biological context as well. This setting enables the distinction of molecules with different roles in nature but similar structures, or similar roles and different structures. ChEBI is organized as an ontology that classifies chemical compounds, which we use to derive a semantic similarity measure that reflects the biological relevance of molecules. In an effort to use as much information as possible, we introduce Chym, a system that integrates structural and semantic information in a single hybrid metric, and we show the accuracy of the system in three distinct classification problems, which consist in deciding whether a compound crosses the blood brain barrier, is a P-glycoprotein substrate or an estrogen receptor ligand. Chym outperforms the previous attempts to solve these three problems, with a maximum accuracy of 90.0&#x00025;.</p></abstract><counts><page-count count="11"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The recent publication of large-scale chemical information, made available by PubChem, ChEMBL and ChEBI, for instance, increased the focus of the scientific community on the problem of chemical comparison. With the amount of chemical data being published and produced today, it has become increasingly necessary to devise automatic systems capable of handling this information. The creation of an effective and accurate system that can compare and classify chemical compounds is useful in a number of different applications. For instance, it can help the understanding of the evolution of metabolic pathways, <xref rid="pcbi.1000937-Tohsato1" ref-type="bibr">[1]</xref>; it can improve the information retrieval of disease, phenotype, and other models that contain references to chemical compounds; it enhances the study and development of pharmacophores <xref rid="pcbi.1000937-Penzotti1" ref-type="bibr">[2]</xref>, <xref rid="pcbi.1000937-Fukunishi1" ref-type="bibr">[3]</xref>; and it can also aid in toxicology, e.g. to estimate whether a given compound is or has the potential to be harmful to animals or humans without attempting a potentially harmful <italic>in vivo</italic> experiment <xref rid="pcbi.1000937-Richard1" ref-type="bibr">[4]</xref>.</p><p>The best approaches existing today are based on the structure-activity relationship premise (SAR), which states that biological activity of a molecule is strongly related to its structural or physicochemical properties. While the existing methods prove that this assumption generally holds, it is not always true. For instance, while L-amino acids are used to synthesize proteins, their stereo-isomers, D-amino acids, are much less frequent in nature and their role is totally different <xref rid="pcbi.1000937-Wolosker1" ref-type="bibr">[5]</xref>. From a biological point of view, they are distinct; however, to capture their structural differences, one needs to use three-dimensional methods (like optical methods <xref rid="pcbi.1000937-Mehta1" ref-type="bibr">[6]</xref>), and even with that consideration the structural similarity will be high, because both molecules have the same atoms and bonds. A possible solution involves simulating the docking between molecules and a protein pocket to determine whether they should interact <italic>in vivo</italic>
<xref rid="pcbi.1000937-Dias1" ref-type="bibr">[7]</xref>, but this method needs the three-dimensional structure of the protein, and is only valid when the property of interest is caused by a protein binding mechanism (an example of a binary classification where no protein is involved is, although a simple one, the determination of liposolubility of chemical compounds). On the other hand, both clavulanic acid and 3-carboxyphenyl phenylacetamidomethylphosphonate are <inline-formula><inline-graphic xlink:href="pcbi.1000937.e001.jpg" mimetype="image"/></inline-formula>-lactamase inhibitors, despite their different structures (see <xref ref-type="fig" rid="pcbi-1000937-g001">Figure 1</xref>). To address this problem, we propose the use of the <italic>semantics</italic> of a chemical compound in the context of biological relevance, which we used to improve the existing methods, through the development of a novel hybrid metric that takes into account both structural and semantic information. We dubbed the novel approach Chym, for Chemical Hybrid Metric. We extract semantic information from ChEBI, the Chemical Entities of Biological Interest ontology, an ontology containing more than 23,000 terms, which can be used at the base of semantic similarity <xref rid="pcbi.1000937-DeMatos1" ref-type="bibr">[8]</xref>. Our proposal states that considering semantic similarity improves the performance of classification algorithms.</p><fig id="pcbi-1000937-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.g001</object-id><label>Figure 1</label><caption><title>Chemical structure of two semantically related compounds.</title><p>The two represented molecular structures, clavulanic acid (A) and 3-carboxyphenyl phenylacetamidomethylphosphonate (B), are different, and yet they both inhibit <inline-formula><inline-graphic xlink:href="pcbi.1000937.e002.jpg" mimetype="image"/></inline-formula>-lactamase.</p></caption><graphic xlink:href="pcbi.1000937.g001"/></fig><p>Most automatic classification methods implemented currently use either (i) the chemical structure as the foundation of the comparison <xref rid="pcbi.1000937-Nikolova1" ref-type="bibr">[9]</xref>, <xref rid="pcbi.1000937-Raymond1" ref-type="bibr">[10]</xref>, or (ii) physicochemical properties like the molecular weight, the octanol-water partitioning coefficient etc. <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>&#x02013;<xref rid="pcbi.1000937-Kearsley1" ref-type="bibr">[14]</xref>.</p><sec id="s1a"><title>Direct structure comparison methods</title><p>One of the main advantages of approach (i) is its ability to compare two or more molecules <italic>on demand</italic>, i.e., one can theoretically draw an arbitrary molecule and compare it to a whole database of structures without any prior knowledge about its function or properties.</p><p>There have been attempts to use graph comparison algorithms applied to the chemical structure of two molecules. One way of doing this is to restrict the similarity problem to the search for the maximum common sub-graph <xref rid="pcbi.1000937-Le1" ref-type="bibr">[15]</xref>. The general topology of the molecule can be used as the base of chemical similarity measures as well, where, for instance, a molecule can be represented as the matrix of the number of bonds between any two atoms and compared based on those matrices <xref rid="pcbi.1000937-Fukunishi2" ref-type="bibr">[16]</xref>.</p><p>More often, though, structural similarity is calculated with the aid of fingerprints. A fingerprint, in this context, is a bitstring, a sequence of 0's and 1's, where each bit represents the presence or absence of a given feature or substructure. There are several ways to construct the fingerprint. For instance, for Daylight fingerprints, all the distinct linear fragments, up to a certain size, are identified from the graph and then converted into numbers <inline-formula><inline-graphic xlink:href="pcbi.1000937.e003.jpg" mimetype="image"/></inline-formula> (usually, a hash function is applied to the fragment followed by a modulo function, effectively obtaining a number in the required range). The <inline-formula><inline-graphic xlink:href="pcbi.1000937.e004.jpg" mimetype="image"/></inline-formula> bits in the fingerprint are then set to 1 <xref rid="pcbi.1000937-Flower1" ref-type="bibr">[17]</xref>, <xref rid="pcbi.1000937-Raymond2" ref-type="bibr">[18]</xref>. Other methods assign a particular substructure to each one of the bits of the fingerprint. Two molecules can then be quickly compared based on the number of common bits in the fingerprints, for example, through the Jaccard-Tanimoto coefficient <xref rid="pcbi.1000937-Jaccard1" ref-type="bibr">[19]</xref>.</p></sec><sec id="s1b"><title>Comparison from physicochemical properties</title><p>For approach (ii), one has to compute the describing properties (if possible), to gather them from literature or to conduct experiments to obtain them.</p><p>For example, in <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>, the authors used Artificial Neural Network (ANN) and Support Vector Machine (SVM) to distinguish compounds capable of crossing the blood-brain barrier (<bold>BBB</bold>) from those that do not cross it. Each compound is described as a 9-dimensional vector, where each element is a physicochemical property of the molecule (molecular weight, volume, total surface area etc.). An ANN is composed of a number of artificial neurons (a conceptual object that receives several input values and combines them non-linearly to produce a single output) arranged in layers, where the first layer gets as input the descriptors of the molecule and the last layer outputs the classification; the SVM method consists of finding the hyper-surface that best separates the active compounds' vectors from the inactive compounds' <xref rid="pcbi.1000937-Cortes1" ref-type="bibr">[20]</xref>.</p><p>In <xref rid="pcbi.1000937-Penzotti1" ref-type="bibr">[2]</xref>, the authors used a three-dimensional representation of molecules and applied an approach named &#x0201c;four-point pharmacophore&#x0201d;. This approach builds millions of descriptors, each being a different spatial arrangement of 4 features with the respective distances between them, and then determines whether the compound contains each of the descriptors, effectively constructing a bitstring which can be used like fingerprints, as previously described. In their work, the four-point pharmacophore model was used to predict whether compounds are substrates of the P-glycoprotein (<bold>P-gp</bold>). A SVM approach was also attempted on this set <xref rid="pcbi.1000937-Xue1" ref-type="bibr">[21]</xref>.</p><p>The work of <xref rid="pcbi.1000937-Tong1" ref-type="bibr">[13]</xref> applies the concept of decision forests to predict whether a chemical compound binds to an <bold>estrogen</bold> receptor. A decision tree consists of several if-then statements, operating over the descriptors, which ultimately come together to create a tree with several branches. The last limbs of the tree classify the compound as active or inactive. A decision forest is then an ensemble of several decision trees, where each tree is constructed from the set of descriptors still not used in previous trees, so as to minimize the fraction of misclassifications, and the final output is a combination of the outputs of the trees <xref rid="pcbi.1000937-Tong1" ref-type="bibr">[13]</xref>.</p><p>Random forests also use decision trees as its basis, as shown by <xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>. In their work, they used random forests to classify compounds as active or inactive in several sets, including the BBB, P-gp and estrogen sets above. Unlike the decision tree approach, however, the descriptors used in each tree are randomly drawn from the set of all descriptors, rather than drawn from the set of unused descriptors.</p><p>These previous works (as well as the present study) validate their approaches by using the comparison algorithms as classification systems and consistently report performance as the fraction of correctly classified compounds: <inline-formula><inline-graphic xlink:href="pcbi.1000937.e005.jpg" mimetype="image"/></inline-formula>. <xref ref-type="table" rid="pcbi-1000937-t001">Table 1</xref> presents the accuracy values obtained from those systems. To evaluate the effectiveness of our approach, we took the data of these previous studies and compared the outcome of our measure to those results.</p><table-wrap id="pcbi-1000937-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t001</object-id><label>Table 1</label><caption><title>Performance of previous works.</title></caption><alternatives><graphic id="pcbi-1000937-t001-1" xlink:href="pcbi.1000937.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Dataset</td><td align="left" rowspan="1" colspan="1">Classification system</td><td align="left" rowspan="1" colspan="1">Accuracy</td><td align="left" rowspan="1" colspan="1">Reference</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BBB</td><td align="left" rowspan="1" colspan="1">Artificial Neural Networks</td><td align="left" rowspan="1" colspan="1">75.7&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Random Forest</td><td align="left" rowspan="1" colspan="1">80.9&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Support Vector Machines</td><td align="left" rowspan="1" colspan="1">81.5&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp</td><td align="left" rowspan="1" colspan="1">Four-point Pharmacophore</td><td align="left" rowspan="1" colspan="1">62.7&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Penzotti1" ref-type="bibr">[2]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Support Vector Machines</td><td align="left" rowspan="1" colspan="1">79.4&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Xue1" ref-type="bibr">[21]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Random Forest</td><td align="left" rowspan="1" colspan="1">80.6&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen</td><td align="left" rowspan="1" colspan="1">Decision Forest</td><td align="left" rowspan="1" colspan="1">
<inline-formula><inline-graphic xlink:href="pcbi.1000937.e006.jpg" mimetype="image"/></inline-formula>80&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Tong1" ref-type="bibr">[13]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Random Forest</td><td align="left" rowspan="1" colspan="1">82.8&#x00025;</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>
</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>This table summarizes the performance of several classification methods used on the BBB, P-gp and estrogen problems.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s1c"><title>Semantic properties</title><p>The semantic information of an object, i.e., its meaning in a predetermined context, is not easily handled by computers, mainly because meaning is mostly described in terms of natural language. For this reason, comparing the semantics of two objects (in this case, two chemical compounds), is not a straightforward task, and is only possible if the semantics of both objects are described under a common schema <xref rid="pcbi.1000937-Lord1" ref-type="bibr">[22]</xref>. In this work, we used the ChEBI ontology (see below) to semantically describe chemical compounds, and under that common schema, we were able to derive a semantic similarity metric.</p><p>An ontology is a representation of terms and the relationship between them, and is usually visualized as a directed graph where nodes are the terms and the directed edges are the relationships <xref rid="pcbi.1000937-Chandrasekaran1" ref-type="bibr">[23]</xref>. A common type of relationship in ontologies is the &#x0201c;is a&#x0201d; relationship. It expresses the fact that one term's meaning subsumes the other's meaning, or, in other words, one term (the child) is a subclass of another term (the parent). Thus, some ontologies can be interpreted as directed acyclic graphs (DAG), where a term can have several parents and children; in such a graph, the deeper a term is, the more specific is its meaning. In the context of ontologies, a semantic measurement between two terms measures their proximity in the ontology. One of the simplest ways to compare two terms is to count the minimum number of relations that must be crossed to get from one compound to the other <xref rid="pcbi.1000937-Resnik1" ref-type="bibr">[24]</xref>. Another approach, used in DAGs, is to find the closest common ancestor of both terms; the distance between them is then the maximum number of relations from one of the two terms being compared to the common ancestor. It is worth noting that a measure can be a <italic>distance</italic> (as the terms get closer, the distance decreases) or a <italic>similarity</italic> (as the terms get closer, the similarity increases). Here we will consider only similarity measures.</p><p>In this work, we used both the ontology as a graph and a concept known as information content. The information content is an abstract concept that reflects the <italic>specificity</italic> of a particular object <xref rid="pcbi.1000937-Pesquita1" ref-type="bibr">[25]</xref>. From information theory, the information content of an object can be evaluated as the negative logarithm of the probability of finding that object <xref rid="pcbi.1000937-Resnik1" ref-type="bibr">[24]</xref>. When calculating information content, it should be noted that a function is only meaningful if each term's occurrence contains all its children's occurrences too. In an ontology like ChEBI, this means that for more abstract terms the probability embraces many terms, decreasing its information content, which, in turn, reflects its low specificity. The probability function we will use is based on the number of pathways each compound participates in. The reason behind this choice is that counting the number of pathways gives a measure of specificity (compounds or chemical classes that are more specific will be found in less pathways), but it is not biased against the problems that Chym tries to solve.</p></sec></sec><sec id="s2"><title>Results</title><p>To validate the effectiveness of Chym as a classification tool, we tested it on the sets presented in <xref ref-type="table" rid="pcbi-1000937-t001">Table 1</xref> and compared our results with the ones in that table. Since the results of chemical classification algorithms are usually reported in terms of accuracy (the fraction of correctly classified compounds), we report accuracy of Chym. However, for binary classification problems, Matthews Correlation Coefficient (MCC) is a better performance indicator <xref rid="pcbi.1000937-Baldi1" ref-type="bibr">[26]</xref>. Therefore, we use this coefficient as the main measure of Chym's performance.</p><sec id="s2a"><title>Sources of data sets</title><p>In the three sets retrieved from the previous works presented in the introduction, the compounds were listed by name only, with no information on structure. The first step in the assessment of Chym was, therefore, to translate that list of names into ChEBI identifiers. The task of getting the identifiers was accomplished by string matching techniques, since there was no structural information to make the search. We split the names into bags of words, where a word is a sequence consisting of only letters or only numbers, to determine whether two names refer to the same chemical entity. We used not only the preferred names of the compounds but also the synonyms stored in the ChEBI database. Only compounds present in the ontology and with a described molecular structure in the ChEBI database were considered. Because ChEBI is continually growing, we estimate that older compounds in the ontology are usually more correctly annotated and tend to have lower identifiers. So, in case of more than one possibility, we chose the lowest ChEBI id.</p><p>Since the ontology does not contain all the possible molecules, we were not able to get a full mapping between names and ChEBI compounds, which means that our sets were shorter versions of the original ones. We refer to our smaller sets as purged versions and denote them as BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e007.jpg" mimetype="image"/></inline-formula>, P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e008.jpg" mimetype="image"/></inline-formula> and estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e009.jpg" mimetype="image"/></inline-formula>. <xref ref-type="table" rid="pcbi-1000937-t002">Table 2</xref> shows the fraction of compounds in each of the three sets that are present in the ontology.</p><table-wrap id="pcbi-1000937-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t002</object-id><label>Table 2</label><caption><title>Fraction of compounds in the ChEBI ontology.</title></caption><alternatives><graphic id="pcbi-1000937-t002-2" xlink:href="pcbi.1000937.t002"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Testing set</td><td colspan="3" align="left" rowspan="1">ChEBI coverage</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">active</td><td align="left" rowspan="1" colspan="1">inactive</td><td align="left" rowspan="1" colspan="1">overall</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BBB</td><td align="left" rowspan="1" colspan="1">74/180</td><td align="left" rowspan="1" colspan="1">79/144</td><td align="left" rowspan="1" colspan="1">47.2&#x00025;</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp</td><td align="left" rowspan="1" colspan="1">57/109</td><td align="left" rowspan="1" colspan="1">24/87</td><td align="left" rowspan="1" colspan="1">41.3&#x00025;</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen</td><td align="left" rowspan="1" colspan="1">42/132</td><td align="left" rowspan="1" colspan="1">59/101</td><td align="left" rowspan="1" colspan="1">43.3&#x00025;</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>Fraction of names found in the ChEBI ontology for each set of molecules. Coverage for active and inactive compounds is detailed.</p></fn></table-wrap-foot></table-wrap><p>The results of this table show a significant reduction in the size of all three sets after converting the names into ChEBI identifiers. Facing these values, we chose to directly compare our results only to the ones obtained with the blood-brain barrier, because (i) it is the set with higher percentage of ChEBI coverage, (ii) after purging, it remains the biggest set, and as such is more fit to be broken into testing and training sets without losing too much information, and (iii) it is the set with a more balanced distribution of active vs. inactive compounds. We will also apply Chym to the two other sets, but the analysis will not be as deep.</p></sec><sec id="s2b"><title>Validation process</title><p>The BBB set is first described in <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>, where the authors use an artificial neural network (ANN) and a support vector machine (SVM) to classify several chemical compounds as either able to cross the blood-brain barrier (active) or unable to do so (inactive). The paper showed that SVMs are more effective in this particular classification problem than ANNs (see <xref ref-type="table" rid="pcbi-1000937-t001">Table 1</xref>). The set was further used by <xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>, where a random forest was grown to classify the compounds. The authors of this work showed the effectiveness of this system in several chemical compound sets, but the results obtained for the BBB set in particular were not better than the ones obtained with SVM. For this reason, we compared our results to the 81.5&#x00025; accuracy reported by <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref> (cf. <xref ref-type="table" rid="pcbi-1000937-t001">Table 1</xref>). It is worth mentioning again that we report accuracy only for comparison purposes, but the real performance indicator should be MCC, which is also reported in the tables with the results.</p><p>In order to make an unbiased comparison between Chym and SVMs, we addressed the validation process in three steps, which were devised so that only one specification of the process changed in each step:</p><list list-type="order"><list-item><p>The SVM model described in <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref> was used to replicate the results reported in that paper with the original set;</p></list-item><list-item><p>The same SVM model was used in our purged set, BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e010.jpg" mimetype="image"/></inline-formula>;</p></list-item><list-item><p>Finally, we replaced the SVM model with our Chym approach.</p></list-item></list><p>It must be mentioned here that Chym is actually a collection of 24 metrics, each having a real parameter, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e011.jpg" mimetype="image"/></inline-formula>, that balances the metric between structural and semantic information. We used <inline-formula><inline-graphic xlink:href="pcbi.1000937.e012.jpg" mimetype="image"/></inline-formula> values from 0 to 1 in steps of 0.01, making a total of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e013.jpg" mimetype="image"/></inline-formula> metrics (to understand the reason for these numbers, refer to the section <xref ref-type="sec" rid="s4">Methods</xref>). The metric that yields the highest Matthews Correlation Coefficient is reported on the tables, alongside the MCC and accuracy values achieved with that same metric.</p><p>For the SVM approach, we retrieved the compounds' properties from the article as 9-dimensional vectors and used the SVMlight <xref rid="pcbi.1000937-Joachims1" ref-type="bibr">[27]</xref> software with a radial basis function kernel, as described in <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>.</p><p>Moreover, to decrease the potential bias in our analysis, we implemented two different validation methods. The first one is a leave-multiple-out process, described in <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref> and here dubbed &#x0201c;LMO25&#x0201d;. LMO25 follows this algorithm:</p><list list-type="order"><list-item><p>25 active compounds and 25 inactive compounds are randomly removed from the set. They now form the testing set;</p></list-item><list-item><p>The remaining set is used to train the model;</p></list-item><list-item><p>The compounds in the testing set are classified according to the model learned in the previous step. Performance (as MCC and accuracy) is recorded;</p></list-item><list-item><p>Steps 1&#x02013;3 are repeated 30 times, and an average of the performance indicators is recorded.</p></list-item></list><p>The second validation approach is <inline-formula><inline-graphic xlink:href="pcbi.1000937.e014.jpg" mimetype="image"/></inline-formula>-fold cross-validation, which is more widely used and well documented <xref rid="pcbi.1000937-Witten1" ref-type="bibr">[28]</xref>. It starts by partitioning the compounds in the original set into <inline-formula><inline-graphic xlink:href="pcbi.1000937.e015.jpg" mimetype="image"/></inline-formula> approximately equal-sized, stratified sets, meaning that the proportion of active inactive compounds is maintained in the partitions. Then each partition is used as testing group once, with the other <inline-formula><inline-graphic xlink:href="pcbi.1000937.e016.jpg" mimetype="image"/></inline-formula> partitions being used to train the model. Accuracy and MCC values are recorded for each partition and averaged in the end of the <inline-formula><inline-graphic xlink:href="pcbi.1000937.e017.jpg" mimetype="image"/></inline-formula> iterations. To remove the noise coming from the initial partition, we performed this method <inline-formula><inline-graphic xlink:href="pcbi.1000937.e018.jpg" mimetype="image"/></inline-formula> times and averaged the accuracy and MCC obtained. This validation approach was also applied to the P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e019.jpg" mimetype="image"/></inline-formula> and estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e020.jpg" mimetype="image"/></inline-formula> sets. We used <inline-formula><inline-graphic xlink:href="pcbi.1000937.e021.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e022.jpg" mimetype="image"/></inline-formula> throughout the whole analysis <xref rid="pcbi.1000937-Witten1" ref-type="bibr">[28]</xref>.</p><p>The last step in the assessment of Chym was to predict some new active compounds in each of the three sets. We calculated an activity coefficient for all compounds in the ChEBI ontology annotated with a structure, based on the active compounds in the respective purged sets, and the best metric for each problem, and retrieved the ones whose coefficient was higher. For a discussion about the methods used to calculate this value, refer to section <xref ref-type="sec" rid="s4">
<bold>Methods</bold>
</xref>.</p></sec><sec id="s2c"><title>Performance</title><p>
<xref ref-type="table" rid="pcbi-1000937-t003">Table 3</xref> shows the main results of the validation process, including the attempt to replicate the results of <xref rid="pcbi.1000937-Doniger1" ref-type="bibr">[11]</xref>. Given that we have 24 different metrics, each one tuned with a real parameter <inline-formula><inline-graphic xlink:href="pcbi.1000937.e023.jpg" mimetype="image"/></inline-formula>, Chym had to select one of the possibilities. The best combination for this problem with the 10-fold cross-validation approach was FP3 fingerprint format with semantic similarity calculated for all the ontology with a simGIC method, with 29&#x00025; of weight to structure and 71&#x00025; to semantics (<inline-formula><inline-graphic xlink:href="pcbi.1000937.e024.jpg" mimetype="image"/></inline-formula>). The same metric was pre-chosen for the LMO25 approach, even though Chym could have found that the best metric with this approach was not this one. The parameters of Chym's best metric (in this case FP3, simGIC, the whole ontology and the value of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e025.jpg" mimetype="image"/></inline-formula>) are explained in more detail in the Methodology section below. The results presented in the table show the superiority of Chym when compared with the SVM approach. Moreover, when we compare the two sections of the table with each other, it is possible to see that the validation method does not significantly affect the results. Since the 10-fold approach is more widely used, at least when compared to the LMO25, we performed the main analysis of our results with this method.</p><table-wrap id="pcbi-1000937-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t003</object-id><label>Table 3</label><caption><title>Replication of the results of BBB.</title></caption><alternatives><graphic id="pcbi-1000937-t003-3" xlink:href="pcbi.1000937.t003"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Set</td><td align="left" rowspan="1" colspan="1">Approach</td><td align="left" rowspan="1" colspan="1">Validation method</td><td align="left" rowspan="1" colspan="1">Accuracy</td><td align="left" rowspan="1" colspan="1">MCC</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BBB</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">LMO25</td><td align="left" rowspan="1" colspan="1">81.3&#x00025;</td><td align="left" rowspan="1" colspan="1">0.630</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e026.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">LMO25</td><td align="left" rowspan="1" colspan="1">73.8&#x00025;</td><td align="left" rowspan="1" colspan="1">0.484</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e027.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">Chym</td><td align="left" rowspan="1" colspan="1">LMO25</td><td align="left" rowspan="1" colspan="1">89.6&#x00025;</td><td align="left" rowspan="1" colspan="1">0.800</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">10-fold</td><td align="left" rowspan="1" colspan="1">81.2&#x00025;</td><td align="left" rowspan="1" colspan="1">0.625</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e028.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">10-fold</td><td align="left" rowspan="1" colspan="1">74.1&#x00025;</td><td align="left" rowspan="1" colspan="1">0.492</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e029.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">Chym</td><td align="left" rowspan="1" colspan="1">10-fold</td><td align="left" rowspan="1" colspan="1">90.0&#x00025;</td><td align="left" rowspan="1" colspan="1">0.810</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>For the LMO25 method, the accuracy values are the mean of 30 experiments, as explained in the previous section. The Chym results were obtained for FP3 fingerprint format, simGIC semantic method using the entire ontology, and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e030.jpg" mimetype="image"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap><p>In its second part, <xref ref-type="table" rid="pcbi-1000937-t003">Table 3</xref> shows the results of using 10-fold cross-validation instead of LMO25. Here we show that the accuracy of the SVM method used previously decreases significantly when some of the compounds in the set are removed. However, the same purged set can be used by Chym, and still achieve an accuracy <inline-formula><inline-graphic xlink:href="pcbi.1000937.e031.jpg" mimetype="image"/></inline-formula>10&#x00025; superior to the one originally reported, with an associated Matthews Correlation Coefficient increase of almost 0.2 units. One possible explanation for this is the effect of the retention of chemotypes. Information on the chemotypes is implicitly contained in the ontology, which may buffer the effect of removal of individual molecules. It would be interesting to make an analysis of chemotypes, for example through Murcko scaffolds <xref rid="pcbi.1000937-Bemis1" ref-type="bibr">[29]</xref>, <xref rid="pcbi.1000937-Bemis2" ref-type="bibr">[30]</xref>. However, the fact that the data sets were retrieved by name and not by structure invalidates this approach. But the SVM approach's accuracy decreases 6&#x02013;8&#x00025; when used on the purged set, which seems to suggest that the chemotype retention is not prominent.</p><p>
<xref ref-type="table" rid="pcbi-1000937-t004">Table 4</xref> shows the performance of Chym when applied to the data sets used. The &#x0201c;Chym parameters&#x0201d; column specifies the parameters of the best metrics in terms of which fingerprint format, semantic method, ontology and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e032.jpg" mimetype="image"/></inline-formula> value are best suited for that set (cf. <xref ref-type="supplementary-material" rid="pcbi.1000937.s001">Table S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000937.s002">Table S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000937.s003">Table S3</xref> in the Supporting Material, available online for the results obtained for all metrics). This table reinforces the prediction power of Chym, since its performance with the P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e033.jpg" mimetype="image"/></inline-formula> and estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e034.jpg" mimetype="image"/></inline-formula> sets, which are also about 60&#x00025; smaller than the original ones, is still higher than (for the P-gp set) or comparable to (for the estrogen set) the value obtained with the random forest approach, the best method applied so far to those sets (cf. <xref ref-type="table" rid="pcbi-1000937-t001">Table 1</xref>). Although there does not seem to be any improvement in the estrogen problem, we must underline that we have used a smaller set, and we believe the performance would increase with a more complete ChEBI ontology. On the other hand, using the values reported in the work about random forests <xref rid="pcbi.1000937-Svetnik1" ref-type="bibr">[12]</xref>, it is possible to recalculate the MCC value obtained with that method, 0.647. The value of 0.673 achieved with Chym represents a slight increase.</p><table-wrap id="pcbi-1000937-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t004</object-id><label>Table 4</label><caption><title>Results of the classification system derived from the Chym comparison method.</title></caption><alternatives><graphic id="pcbi-1000937-t004-4" xlink:href="pcbi.1000937.t004"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Set</td><td colspan="3" align="left" rowspan="1">Chym</td><td colspan="3" align="left" rowspan="1">Best previous attempt</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Parameters</td><td align="left" rowspan="1" colspan="1">MCC</td><td align="left" rowspan="1" colspan="1">Accuracy</td><td align="left" rowspan="1" colspan="1">Approach</td><td align="left" rowspan="1" colspan="1">MCC</td><td align="left" rowspan="1" colspan="1">Accuracy</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e035.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">FP3, simGIC, all, 0.29</td><td align="left" rowspan="1" colspan="1">0.810</td><td align="left" rowspan="1" colspan="1">90.0&#x00025;</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">0.628</td><td align="left" rowspan="1" colspan="1">81.5&#x00025;</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e036.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">FP4, simUI, role, 0.72</td><td align="left" rowspan="1" colspan="1">0.694</td><td align="left" rowspan="1" colspan="1">87.3&#x00025;</td><td align="left" rowspan="1" colspan="1">Random Forests</td><td align="left" rowspan="1" colspan="1">0.591</td><td align="left" rowspan="1" colspan="1">80.6&#x00025;</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e037.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">FP4, simGIC, role, 0.45</td><td align="left" rowspan="1" colspan="1">0.673</td><td align="left" rowspan="1" colspan="1">82.6&#x00025;</td><td align="left" rowspan="1" colspan="1">Random Forests</td><td align="left" rowspan="1" colspan="1">0.647</td><td align="left" rowspan="1" colspan="1">82.8&#x00025;</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>Chym parameters are &#x0201c;fingerprint format, semantic method, branch of the ontology used, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e038.jpg" mimetype="image"/></inline-formula>&#x0201d;. The validation process used was 10-fold. Matthews Correlation Coefficient values reported here was not directly retrieved from the papers where the attempts are described, but were estimated based on the values of true positives, false positives, true negatives and false negatives given in those papers.</p></fn></table-wrap-foot></table-wrap><p>
<xref ref-type="table" rid="pcbi-1000937-t005">Table 5</xref> and <xref ref-type="fig" rid="pcbi-1000937-g002">Figure 2</xref> show the MCC of three Chym systems against <inline-formula><inline-graphic xlink:href="pcbi.1000937.e039.jpg" mimetype="image"/></inline-formula> values. For each set, the parameters used with the Chym system are the ones which reached maximum accuracy for some value of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e040.jpg" mimetype="image"/></inline-formula>. It is visible that, in the three Chym systems, the accuracy starts by increasing at first, reaching a maximum, and decreasing again. This shows that using the hybrid measure is better than using only purely structural or semantic metric. When this same analysis is applied to other Chym parameters, we can observe the same behavior, which confirms the idea that, even if one system is not very accurate, the crossing of structural and semantic information increases the prediction power of Chym.</p><fig id="pcbi-1000937-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.g002</object-id><label>Figure 2</label><caption><title>The effect of the parameter <inline-formula><inline-graphic xlink:href="pcbi.1000937.e041.jpg" mimetype="image"/></inline-formula> in the performance of Chym.</title><p>For each dataset, the best metric was stripped of the <inline-formula><inline-graphic xlink:href="pcbi.1000937.e042.jpg" mimetype="image"/></inline-formula> parameter. This incomplete metric was completed with all values of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e043.jpg" mimetype="image"/></inline-formula> and then each one was used to determine performance. The figure shows the variation of performance (as measured by the Matthews Correlation Coefficient) against the value of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e044.jpg" mimetype="image"/></inline-formula>. There is a maximum in the plot for every dataset, consisting of the best metric: <inline-formula><inline-graphic xlink:href="pcbi.1000937.e045.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e046.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e047.jpg" mimetype="image"/></inline-formula> for the BBB (red open circles), P-gp (green closed circles) and estrogen (blue closed squares) datasets respectively).</p></caption><graphic xlink:href="pcbi.1000937.g002"/></fig><table-wrap id="pcbi-1000937-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t005</object-id><label>Table 5</label><caption><title>The effect of the alpha parameter in Chym's performance as measured by the Matthews Correlation Coefficient.</title></caption><alternatives><graphic id="pcbi-1000937-t005-5" xlink:href="pcbi.1000937.t005"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Alpha</td><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e048.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e049.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e050.jpg" mimetype="image"/></inline-formula>
</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0.0</td><td align="left" rowspan="1" colspan="1">0.66837</td><td align="left" rowspan="1" colspan="1">0.47723</td><td align="left" rowspan="1" colspan="1">0.26418</td></tr><tr><td align="left" rowspan="1" colspan="1">0.1</td><td align="left" rowspan="1" colspan="1">0.74508</td><td align="left" rowspan="1" colspan="1">0.54799</td><td align="left" rowspan="1" colspan="1">0.33957</td></tr><tr><td align="left" rowspan="1" colspan="1">0.2</td><td align="left" rowspan="1" colspan="1">0.78206</td><td align="left" rowspan="1" colspan="1">0.54634</td><td align="left" rowspan="1" colspan="1">0.42900</td></tr><tr><td align="left" rowspan="1" colspan="1">0.3</td><td align="left" rowspan="1" colspan="1">
<bold>0.79941</bold>
</td><td align="left" rowspan="1" colspan="1">0.63492</td><td align="left" rowspan="1" colspan="1">0.50817</td></tr><tr><td align="left" rowspan="1" colspan="1">0.4</td><td align="left" rowspan="1" colspan="1">0.75904</td><td align="left" rowspan="1" colspan="1">
<bold>0.63774</bold>
</td><td align="left" rowspan="1" colspan="1">0.60167</td></tr><tr><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.73267</td><td align="left" rowspan="1" colspan="1">0.61939</td><td align="left" rowspan="1" colspan="1">0.63670</td></tr><tr><td align="left" rowspan="1" colspan="1">0.6</td><td align="left" rowspan="1" colspan="1">0.68652</td><td align="left" rowspan="1" colspan="1">0.60764</td><td align="left" rowspan="1" colspan="1">0.66318</td></tr><tr><td align="left" rowspan="1" colspan="1">0.7</td><td align="left" rowspan="1" colspan="1">0.64528</td><td align="left" rowspan="1" colspan="1">0.57530</td><td align="left" rowspan="1" colspan="1">
<bold>0.67470</bold>
</td></tr><tr><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.57281</td><td align="left" rowspan="1" colspan="1">0.54896</td><td align="left" rowspan="1" colspan="1">0.60161</td></tr><tr><td align="left" rowspan="1" colspan="1">0.9</td><td align="left" rowspan="1" colspan="1">0.52186</td><td align="left" rowspan="1" colspan="1">0.49979</td><td align="left" rowspan="1" colspan="1">0.64252</td></tr><tr><td align="left" rowspan="1" colspan="1">1.0</td><td align="left" rowspan="1" colspan="1">0.51764</td><td align="left" rowspan="1" colspan="1">0.48429</td><td align="left" rowspan="1" colspan="1">0.61333</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt105"><label/><p>The Chym parameters used are the ones in <xref ref-type="table" rid="pcbi-1000937-t004">Table 4</xref>, except that instead of a single <inline-formula><inline-graphic xlink:href="pcbi.1000937.e051.jpg" mimetype="image"/></inline-formula> value, we present results for several values. Validation was performed with a 10-fold approach. Bold values are the maximum for each column.</p></fn></table-wrap-foot></table-wrap><p>Finally, <xref ref-type="table" rid="pcbi-1000937-t006">Table 6</xref> shows the most active ChEBI compounds, as defined by the activity coefficient, retrieved for each problem. In each problem, we retrieved all the ChEBI compounds in the ontology and with a molecular structure (more than 15000) and ranked them by activity coefficient. The table reports the first three whose classification has been previously determined in a publication and shows that those compounds are, in fact, active compounds (they cross the blood-brain barrier, are substrates to P-glycoprotein or ligands to the estrogen receptor), which also contributes to the idea that the Chym method is effective. The entire ranked lists of compounds are available as <xref ref-type="supplementary-material" rid="pcbi.1000937.s004">Table S4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000937.s005">Table S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000937.s006">Table S6</xref>.</p><table-wrap id="pcbi-1000937-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000937.t006</object-id><label>Table 6</label><caption><title>The activity coefficients of the most active compounds in ChEBI when compared to the active compounds in each set.</title></caption><alternatives><graphic id="pcbi-1000937-t006-6" xlink:href="pcbi.1000937.t006"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Set</td><td align="left" rowspan="1" colspan="1">Rank</td><td colspan="2" align="left" rowspan="1">Compound</td><td align="left" rowspan="1" colspan="1">Coefficient</td><td align="left" rowspan="1" colspan="1">Ref.</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">ID</td><td align="left" rowspan="1" colspan="1">Name</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e052.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">50931</td><td align="left" rowspan="1" colspan="1">(Z)-chlorprothixene</td><td align="left" rowspan="1" colspan="1">0.289</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Healy1" ref-type="bibr">[44]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e053.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">51137</td><td align="left" rowspan="1" colspan="1">mianserin</td><td align="left" rowspan="1" colspan="1">0.280</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Mishra1" ref-type="bibr">[45]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e054.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">251412</td><td align="left" rowspan="1" colspan="1">adinazolam</td><td align="left" rowspan="1" colspan="1">0.279</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Amsterdam1" ref-type="bibr">[46]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e055.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">53290</td><td align="left" rowspan="1" colspan="1">(S)-donepezil</td><td align="left" rowspan="1" colspan="1">0.373</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Keogh1" ref-type="bibr">[47]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e056.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">31181</td><td align="left" rowspan="1" colspan="1">aklavinone</td><td align="left" rowspan="1" colspan="1">0.368</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Lehne1" ref-type="bibr">[48]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">P-gp<inline-formula><inline-graphic xlink:href="pcbi.1000937.e057.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">48723</td><td align="left" rowspan="1" colspan="1">(-)-lobeline</td><td align="left" rowspan="1" colspan="1">0.366</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Ullah1" ref-type="bibr">[49]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e058.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">27917</td><td align="left" rowspan="1" colspan="1">luteone</td><td align="left" rowspan="1" colspan="1">0.277</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Ranilla1" ref-type="bibr">[50]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e059.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">5262</td><td align="left" rowspan="1" colspan="1">galangin</td><td align="left" rowspan="1" colspan="1">0.274</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-So1" ref-type="bibr">[51]</xref>
</td></tr><tr><td align="left" rowspan="1" colspan="1">estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e060.jpg" mimetype="image"/></inline-formula>
</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">50399</td><td align="left" rowspan="1" colspan="1">3&#x02032;,4&#x02032;,7-trihydroxyisoflavone</td><td align="left" rowspan="1" colspan="1">0.274</td><td align="left" rowspan="1" colspan="1">
<xref rid="pcbi.1000937-Harris1" ref-type="bibr">[52]</xref>
</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt106"><label/><p>For each compound, a reference showing that the compound is indeed active is given. The thresholds for each problem, as determined by the algorithm detailed in the Methodology section, are 0.243 (BBB), 0.272 (P-gp) and 0.231 (estrogen).</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3"><title>Discussion</title><p>The work presented in this paper shows compelling evidence that using semantic information in chemical classification algorithms improves their performance. To show that, we used three sets of compounds previously described and used as input in other classification methods. On those sets, Chym achieves higher performance for class prediction when compared to previously existing methods, with Matthews Correlation Coefficient as high as 0.810, corresponding to an accuracy of 90.0&#x00025;. Parallel to this result, we also showed that the use of a hybrid metric that uses both structural and semantic information is better suited for this kind of problems than a system which uses only one of these types of information. Some issues should, however, be discussed in order to complete the analysis of this tool.</p><p>The properties that are relevant to decide whether a molecule should be classified as active or inactive depend obviously on the problem being solved. As such, the best metric for a problem is not necessarily the same for other problems. Thus, selecting the best metric is not much different than selecting the appropriate descriptors for SVM, random forest or the other approaches presented before. While it may be argued that the value of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e061.jpg" mimetype="image"/></inline-formula> is inherent to Chym's method, it does reflect the relative amount of structural and semantic information that must be used to correctly classify compounds. Choosing the appropriate value for this and the other parameters can be seen, from the point of view of usage, as a task similar to choosing the appropriate descriptors that better reflect the important characteristics of the molecules (those that yield the best results). For instance, as specified in <xref ref-type="table" rid="pcbi-1000937-t004">Table 4</xref>, while the FP3 fingerprint format is good at detecting some substructures that are important in the BBB problem, it misses the relevant structures in the other problems. Furthermore, the BBB problem is better solved with a stronger focus on the semantic information, and the <inline-formula><inline-graphic xlink:href="pcbi.1000937.e062.jpg" mimetype="image"/></inline-formula> value of the best metric reflects this, as evident in <xref ref-type="fig" rid="pcbi-1000937-g002">Figure 2</xref>.</p><p>On another note, our high performance could be due to a possible term in the ontology that classified compounds as able to cross the blood-brain barrier, as substrates to the P-glycoprotein or as estrogen receptor ligands. Admittedly, if there were such terms in the ontology, Chym would be biased and would report high accuracy values because it would be using the information it was trying to validate as a means to prove its effectiveness. As it turns out, no term in the ontology refers to the words &#x0201c;brain&#x0201d;, &#x0201c;barrier&#x0201d;, &#x0201c;P-glycoprotein&#x0201d; or &#x0201c;permeability&#x0201d; (the meaning of the P in P-glycoprotein). &#x0201c;Estrogen receptor&#x0201d; appears twice, in &#x0201c;estrogen receptor modulator&#x0201d; and &#x0201c;estrogen receptor antagonist&#x0201d;, but these two terms have only a total of 5 descendants in the ontology, and none of them is present in the set estrogen<inline-formula><inline-graphic xlink:href="pcbi.1000937.e063.jpg" mimetype="image"/></inline-formula>. This fact suggests that Chym can be used in many classification and similarity problems, even if they are not well represented in the ontology.</p><p>The reason for this fact is that, although the information to solve the classification problem is not explicitly stated in the ontology, the proximity of terms in the ontology (their semantic similarity) is a good indicator that they should behave similarly. For instance, both the compounds ChEBI:8069, phenobarbital, and ChEBI:49575, diazepam, cross the blood brain barrier. Moreover, they share many of their ancestors. Their semantic similarity, as measured with a simGIC method in the whole ontology, is 0.324, and their structural similarity, as measured with the FP3 format, is 0.667. With an <inline-formula><inline-graphic xlink:href="pcbi.1000937.e064.jpg" mimetype="image"/></inline-formula> (these are the parameters chosen for the BBB problem, cf. <xref ref-type="table" rid="pcbi-1000937-t004">Table 4</xref>), this results in a similarity of 0.423, well above the mean similarity between the active compounds in the BBB<inline-formula><inline-graphic xlink:href="pcbi.1000937.e065.jpg" mimetype="image"/></inline-formula> set, 0.238. The compounds are both annotated as sedative drugs, and Chym was then able to determine that ChEBI:51137, mianserin, another sedative drug, also crosses the BBB (see <xref ref-type="table" rid="pcbi-1000937-t006">Table 6</xref>).</p><p>Still in respect to the results presented in <xref ref-type="table" rid="pcbi-1000937-t006">Table 6</xref>, a further analysis showed that ChEBI:5078, flavonol, was ranked <inline-formula><inline-graphic xlink:href="pcbi.1000937.e066.jpg" mimetype="image"/></inline-formula> in the list of estrogen receptor ligands (activity coefficient<inline-formula><inline-graphic xlink:href="pcbi.1000937.e067.jpg" mimetype="image"/></inline-formula>, higher than the threshold calculated for that problem), but <xref rid="pcbi.1000937-Zand1" ref-type="bibr">[31]</xref> showed that this compound is not an estrogen receptor ligand. However, the class of compounds named flavonoids, into which flavonol is classified, is known to contain several compounds that bind to the estrogen receptor <xref rid="pcbi.1000937-Markiewicz1" ref-type="bibr">[32]</xref>, <xref rid="pcbi.1000937-Miksicek1" ref-type="bibr">[33]</xref>. Moreover, this compound shares most of galangin's ancestry, 58 common ancestors out of 61 total ancestors (galangin is also on that table). This means that the ChEBI ontology is not yet able to differentiate between these two compounds, and so it produces a false positive. As a matter of fact, the similarity between these two compounds in the metric chosen for the estrogen problem is 0.716, while the mean similarity between all the active compounds is 0.216, demonstrating that ChEBI assigns high similarity to these molecules.</p><p>As discussed in the Methodology, the ChEBI ontology contains three partially overlapping branches. One concern raised by this fact is that the molecular structure more or less reproduces the structural information used in the first part of the metric. Although the information being used is indeed the same, the ontology explores the structural properties from a totally new perspective (namely, a semantic perspective), that would be otherwise unusable in a similarity measure: purely structural comparison methods are probably unable to use the fact that both glucose and fructose are monosaccharides to compare them. So, even if there seems to be a duplication of information, the different approaches used yield similarity values that can be combined to produce a more robust score (as Chym does).</p><p>Another concern raised about the use of ChEBI ontology is the subatomic branch. This branch was never chosen by itself as the best branch of the ontology, which is not surprising, for two reasons. First, it is not much richer than the molecular structure or role branches, since only 35 ChEBI terms are unique to this branch of the ontology. Secondly, each of these 35 terms is either an ancestor to all chemical compounds used in the input set (as happens with electron, for instance, which is part of the atom, which is part of every molecular structure) or ancestor to none of the chemical compounds (photon, for instance). This means that this branch does not offer any kind of resolution.</p><p>However, like any other classification algorithm, Chym has its limitations. The most important drawback of this method is that it can only compare structures that are annotated in the ChEBI ontology. Of course that any chemist or other scientist wishing to use Chym may annotate the compound they are trying to study in ChEBI by creating a &#x0201c;non-official&#x0201d; node. There is, however, a large number of classes, which could potentially introduce a difficulty in selecting the most appropriate position for the compound; this annotation is also unfeasible for a large number of compounds. This severely impairs applications like drug discovery, or toxicology analysis.</p><p>In spite of this limitation, Chym introduces the comparison of chemical compounds through their semantics, which is an important technique that can be used in projects where comparison and or classification of known chemical compounds is needed. One instance of such project is the search for a possible correlation between strains of bacteria and their virulence. One could be interested in determining differences in metabolic networks of said strains and compare the differences with the different amount of virulence of those strains; the comparison of metabolic networks would benefit from the metrics explored here. Other applications include the comparison of models, for instance models of diseases containing references to molecules responsible for the disease or to drugs known to improve the condition of patients. On the other hand, the semantic similarity applied to ChEBI (developed and explored in this work) can also be useful in ontology managing, as happens in GO <xref rid="pcbi.1000937-Pesquita2" ref-type="bibr">[34]</xref>, where semantic similarity is used to automatically annotate other molecules in the ontology and automatically improve the ontology. This would in turn be useful in information retrieval and automatic reasoning methodologies.</p><p>In the future, it would be interesting to try other hybrid metrics, especially other structural comparison algorithms. For instance, since SVM and random forests seem to perform well, perhaps a system where the structural part of the comparison is done through one of these methods would outperform the actual version of Chym.</p></sec><sec sec-type="methods" id="s4"><title>Methods</title><p>In order to develop and validate our hybrid similarity for chemical compounds, the <bold>C</bold>hemical <bold>hy</bold>brid <bold>m</bold>etric (Chym), we built a model based both on fingerprints and on the semantic similarity measures developed for the Gene Ontology (GO) <xref rid="pcbi.1000937-Pesquita3" ref-type="bibr">[35]</xref>.</p><sec id="s4a"><title>Structural similarity</title><p>To calculate the structural similarity between two molecules, we need a representation of their structures. Because ChEBI contains a list of structures in SMILES, MDL and InChI chemical file formats, these are the formats used. For each distinct molecule, we prefer a SMILES representation of the structure. If one does not exist, we use MDL. The rationale for this choice is the wide use of SMILES over MDL. InChI was not used since every molecule with a structure in this format had at least one of the other formats as well.</p><p>For each structure, three fingerprints were calculated. These formats were computed with the OpenBabel software <xref rid="pcbi.1000937-Guha1" ref-type="bibr">[36]</xref>, <xref rid="pcbi.1000937-The1" ref-type="bibr">[37]</xref>, and as such we used the names and files provided by it:</p><list list-type="simple"><list-item><p>
<bold>FP2</bold> All non-branched (linear or possibly circular) fragments of up to 7 atoms are calculated from the initial structure. Each fragment is assigned a number from 0 to 1020 by means of a hash function and the corresponding bit in the fingerprint is set to 1.</p></list-item><list-item><p>
<bold>FP3</bold> The molecule is analyzed and, if a specific pattern is identified, its corresponding bit in the fingerprint is set. The patterns are defined in a file that is part of the OpenBabel software.</p></list-item><list-item><p>
<bold>FP4</bold> This format is conceptually the same as the FP3 format but with different patterns, which are defined in a different file.</p></list-item></list><p>Given two molecules and the corresponding fingerprints <inline-formula><inline-graphic xlink:href="pcbi.1000937.e068.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e069.jpg" mimetype="image"/></inline-formula>, the similarity score between them is calculated according to the Jaccard-Tanimoto coefficient <xref rid="pcbi.1000937-Flower1" ref-type="bibr">[17]</xref>, <xref rid="pcbi.1000937-Willett1" ref-type="bibr">[38]</xref>, <xref rid="pcbi.1000937-Martin1" ref-type="bibr">[39]</xref>:<disp-formula><graphic xlink:href="pcbi.1000937.e070.jpg" mimetype="image" position="float"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pcbi.1000937.e071.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e072.jpg" mimetype="image"/></inline-formula> are the <inline-formula><inline-graphic xlink:href="pcbi.1000937.e073.jpg" mimetype="image"/></inline-formula> bit in each of the fingerprints. Obviously, comparison of fingerprints is only valid if the fingerprints were obtained by the same method. This equation is valid only if the denominator is different from 0. It was verified that all fingerprints calculated had at least one bit set to 1, thus making the denominator always positive.</p><p>From equation 1, it can be seen that the structural similarity will run from 0, when no bit is 1 for both molecules (total disparity), to 1, when the 1-bits in the two molecules are the same (equal fingerprints).</p></sec><sec id="s4b"><title>Semantic similarity</title><p>Following the application of semantic measures for the GO <xref rid="pcbi.1000937-Pesquita3" ref-type="bibr">[35]</xref>, we developed a similar approach but instead of proteins, we work with chemical compounds. As has been stated above, there are a number of ways to measure semantic similarity based on an ontology. We chose to use the same ones as <xref rid="pcbi.1000937-Pesquita3" ref-type="bibr">[35]</xref>. In the next paragraphs, consider <inline-formula><inline-graphic xlink:href="pcbi.1000937.e074.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e075.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e076.jpg" mimetype="image"/></inline-formula> as chemical compounds and <inline-formula><inline-graphic xlink:href="pcbi.1000937.e077.jpg" mimetype="image"/></inline-formula> as the set of ancestors of the chemical compound <inline-formula><inline-graphic xlink:href="pcbi.1000937.e078.jpg" mimetype="image"/></inline-formula>, including <inline-formula><inline-graphic xlink:href="pcbi.1000937.e079.jpg" mimetype="image"/></inline-formula> itself.</p><p>
<bold>simUI</bold> is a graph-based measure, which means that it considers the compounds and all their ancestors in the graph of the ontology. It is defined as follows <xref rid="pcbi.1000937-Gentleman1" ref-type="bibr">[40]</xref>:<disp-formula><graphic xlink:href="pcbi.1000937.e080.jpg" mimetype="image" position="float"/><label>(2)</label></disp-formula>
</p><p>It is known, however, that for ontologies where term specificity is not well correlated with term depth, methods based on information content (IC) are preferable <xref rid="pcbi.1000937-Pesquita3" ref-type="bibr">[35]</xref>. Let <inline-formula><inline-graphic xlink:href="pcbi.1000937.e081.jpg" mimetype="image"/></inline-formula> be the frequency of usage of the term <inline-formula><inline-graphic xlink:href="pcbi.1000937.e082.jpg" mimetype="image"/></inline-formula> in some corpus. The information content of a term can be given by <xref rid="pcbi.1000937-Ross1" ref-type="bibr">[41]</xref>:<disp-formula><graphic xlink:href="pcbi.1000937.e083.jpg" mimetype="image" position="float"/><label>(3)</label></disp-formula>Intuitively, equation 3 means that a very frequent term conveys less information and vice-versa. Notice that the frequency of a term <inline-formula><inline-graphic xlink:href="pcbi.1000937.e084.jpg" mimetype="image"/></inline-formula> subsumes the frequency of the terms that derive from <inline-formula><inline-graphic xlink:href="pcbi.1000937.e085.jpg" mimetype="image"/></inline-formula>. This means that the frequency of the term amino acid includes the frequency of terms L-serine or carnitine, a <inline-formula><inline-graphic xlink:href="pcbi.1000937.e086.jpg" mimetype="image"/></inline-formula>-amino acid. Therefore, less specific terms are less informative. Chym makes use of this equation, where the terms are the nodes of the ChEBI ontology, <italic>viz</italic> chemical compounds or chemical classes.</p><p>
<bold>simGIC</bold> is a combination of the graph-based simUI metric with the information content properties of compounds. The concept behind the equation is the same as the one behind simUI, but now each ancestor is weighted according to its information content, which reflects its specificity. simGIC is calculated through equation 4 <xref rid="pcbi.1000937-Pesquita3" ref-type="bibr">[35]</xref>.<disp-formula><graphic xlink:href="pcbi.1000937.e087.jpg" mimetype="image" position="float"/><label>(4)</label></disp-formula>
</p><p>It is worth underlining here that the concept of information content is just a method to give weight to the compounds in the ontology. If two compounds share many ancestors, simUI will attribute a high similarity between them, but, for example, if most of those ancestors are unspecific, the similarity should be lowered accordingly; by weighting the ancestors, simGIC achieves this effect. For example, compounds ChEBI:17802, pseudouridine, and ChEBI:31747, kanosamine, share 30 or their 37 ancestors, but the most specific of those is ChEBI:23008, carbohydrate, already a very abstract term in the ontology. simGIC takes into account this fact. Considering the similarity values between all pairs of compounds that appear in the corpus at least once, the mean similarity measured with simUI is 0.431 and the mean similarity with simGIC is 0.048. Those two compounds share a simUI similarity value of 0.811, about twice the mean value, but by weighting the ancestors, simGIC assigns a similarity of 0.023, about half of the mean value.</p><p>For both metrics, the similarity value is between 0 and 1 because an intersection of two sets is always a subset of their union.</p></sec><sec id="s4c"><title>Hybrid metric</title><p>Until this point, we presented two orthogonal metrics to measure the similarity between two chemical compounds. Our intent, however, is to join them together to produce a hybrid metric that takes into account both structural and semantic information.</p><p>Since both measures explained above always fall in the closed interval <inline-formula><inline-graphic xlink:href="pcbi.1000937.e088.jpg" mimetype="image"/></inline-formula>, we propose the following definition for our hybrid similarity:<disp-formula><graphic xlink:href="pcbi.1000937.e089.jpg" mimetype="image" position="float"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pcbi.1000937.e090.jpg" mimetype="image"/></inline-formula> is a real number from 0 to 1. When <inline-formula><inline-graphic xlink:href="pcbi.1000937.e091.jpg" mimetype="image"/></inline-formula>, the identity degenerates into pure structural similarity and with <inline-formula><inline-graphic xlink:href="pcbi.1000937.e092.jpg" mimetype="image"/></inline-formula>, into pure semantic similarity.</p></sec><sec id="s4d"><title>Chym approach to classification</title><p>One of the possible uses of Chym is the application of this similarity metric to classify compounds. Ideally, we want to be able to get a set of chemical compounds that possess a common property as input, and then determine whether other chemical compounds also possess that property. This is also the approach used in SVM and random forests, for example, where the input serves as a training set that is used to create a classification model. In Chym, the model consists of a threshold that is used to decide whether a compound is active or inactive.</p><p>Given a training set of compounds, some sharing a common property (which we call <italic>active</italic> compounds), and some lacking that property (<italic>inactive</italic> compounds), the following algorithm is used to predict whether a compound in the validation set is active or inactive:</p><list list-type="order"><list-item><p>Within the training set, compare each compound with all active compounds. The comparison of an active compound with itself is excluded, since this value (which is always 1) could introduce a bias into the rest of the algorithm.</p></list-item><list-item><p>For each of the compounds in the training set, determine its <italic>activity coefficient</italic>, which is the unweighted average of the results in step 1. A compound will be classified as active if its activity coefficient is above a threshold, which still needs to be calculated.</p></list-item><list-item><p>Determine the <italic>threshold of activity</italic>, <inline-formula><inline-graphic xlink:href="pcbi.1000937.e093.jpg" mimetype="image"/></inline-formula>. To do this, Chym uses all the coefficients calculated in step 2 as potential thresholds, and classifies the compounds in the training set as active or inactive accordingly. The coefficient that minimizes the number of misclassifications in the test set is chosen. This ends the training step.</p></list-item><list-item><p>For all compounds in the validation set, Chym calculates their activity coefficient as the average of similarities between the compound and all active compounds in the training set, and classifies it as active if the activity coefficient is greater than or equal to the threshold of activity <inline-formula><inline-graphic xlink:href="pcbi.1000937.e094.jpg" mimetype="image"/></inline-formula>, and as inactive otherwise.</p></list-item></list><p>From the algorithm above, it can be seen that the inactive compounds are only used to adjust the value of the threshold, while the active compounds are used both in the adjustment of that value and in the determination of the activity coefficient of the validation compounds.</p></sec><sec id="s4e"><title>Data sources</title><p>
<bold>Chemical Entities of Biological Interest</bold> (ChEBI) is a freely available database of small molecular entities (distinct isotopes, atoms, ions, molecules etc.). These entities may be products of nature or synthetic products used to intervene in biological processes <xref rid="pcbi.1000937-DeMatos1" ref-type="bibr">[8]</xref>.</p><p>The ontology also includes classes of molecular entities and partial molecular entities, enabling ChEBI to be organized as an ontology, structuring molecular entities into classes and defining the relations between them. Several relationship types exist in ChEBI, with a number of them reciprocal in nature. The ontology is subdivided into three separate sub-ontologies:</p><list list-type="bullet"><list-item><p>
<bold>Molecular structure</bold>, in which the entities are classified according to composition and structure.</p></list-item><list-item><p>
<bold>Role</bold>, in which entities are classified according to their role within a biological context.</p></list-item><list-item><p>
<bold>Subatomic particle</bold>, which classifies particles smaller than atoms.</p></list-item></list><p>As of the time of the computations (January 2010, release 64), the graph of this ontology contained 23,545 nodes representing chemical compounds, which represents approximately 4&#x00025; of the whole ChEBI database. As stated above, some terms are not chemical compounds but parts of compounds, such as functional groups, that make the ontology structure possible. Also, for each individual chemical compound, there may be several identifiers, which come from different annotations that were later identified as the same compound.</p><p>Chym's branches are partially overlapping. For instance, the term glucose is classified as a molecular structure, as having the role of macronutrient and as having part electron, which means that it is present in three branches. Including glucose, 21676 nodes (92&#x00025;) are part of the three branches.</p><p>Besides the ontology, the ChEBI database is enriched with an extensive list of synonyms and manually curated cross-references to other non-proprietary databases, as well as a list of chemical structures.</p><p>
<bold>Kyoto Encyclopedia of Genes and Genomes</bold> (<sc>kegg</sc>) is a collection of databases categorized into systems information, genomic and chemical information. The different <sc>kegg</sc> databases are highly integrated in an effort to constitute a computer representation of the biological system <xref rid="pcbi.1000937-Kanehisa1" ref-type="bibr">[42]</xref>.</p><p>One of the main components of <sc>kegg</sc> is the <sc>kegg</sc>
<sc>pathway</sc> database, which contains a collection of graphical representations of known pathways. Each metabolic entry integrates information from other databases in <sc>kegg</sc>, such as the intervening enzymes (<sc>kegg</sc>
<sc>enzyme</sc>), chemical reactions (<sc>kegg</sc>
<sc>reaction</sc>) and chemical compounds present in the pathway (<sc>kegg</sc>
<sc>compound</sc>).</p><p>
<sc>kegg compound</sc> is a chemical structure database for metabolic compounds and other chemical substances that are relevant to biological systems. We use entries in the <sc>kegg</sc>
<sc>compound</sc> database as annotations of the compounds present in the metabolic pathways (<sc>kegg</sc>
<sc>pathway</sc> entries). The existence of a mapping between ChEBI and <sc>kegg</sc>
<sc>compound</sc> allows us to integrate information from both databases.</p></sec><sec id="s4f"><title>Implementation</title><p>The methods used to structurally compare compounds are implemented by the software, OpenBabel <xref rid="pcbi.1000937-Guha1" ref-type="bibr">[36]</xref>, <xref rid="pcbi.1000937-The1" ref-type="bibr">[37]</xref>. We used version 2.2.3, which was downloaded and installed on December 2009.</p><p>The semantic similarity was not as straightforward. As in <xref rid="pcbi.1000937-Grego1" ref-type="bibr">[43]</xref>, we had to reorganize the ChEBI ontology so that it could fulfill our purposes. All cyclic relationships (&#x0201c;<italic>is tautomer of</italic>&#x0201d; etc.) were removed, and the other relationships were merged into a single &#x0201c;<italic>is a</italic>&#x0201d;-like relationship. Also, ChEBI identifiers pointing to the same chemical compounds were merged into a single node. Thus, we produced three independent DAGs, one for each branch of the main ontology, and a forth DAG resulting from merging the other three. With this modification, we can directly calculate simUI similarities with equation 2.</p><p>To calculate the IC-based metric (simGIC), we had to find a corpus where the compounds are referenced. We chose <sc>kegg</sc>
<sc>pathway</sc> because it is not connected to any of the problems solved by Chym. This has the advantage of avoiding a potential bias that could boost Chym's results. To map a ChEBI identifier into a <sc>kegg</sc> identifier, we used the ChEBI cross-references. Sometimes, however, these references were ambiguous (one ChEBI id pointing to two or more <sc>kegg</sc>
<sc>compound</sc> ids). For this reason, whenever a ChEBI id <inline-formula><inline-graphic xlink:href="pcbi.1000937.e095.jpg" mimetype="image"/></inline-formula> had more than one <sc>kegg</sc>
<sc>compound</sc> reference, we used them all to determine the number of pathways in which <inline-formula><inline-graphic xlink:href="pcbi.1000937.e096.jpg" mimetype="image"/></inline-formula> participates. With this corpus, the value of <inline-formula><inline-graphic xlink:href="pcbi.1000937.e097.jpg" mimetype="image"/></inline-formula> from equation 3 is the fraction of pathways where the compound <inline-formula><inline-graphic xlink:href="pcbi.1000937.e098.jpg" mimetype="image"/></inline-formula> or any of its descendants appear.</p><p>Since there are 3 fingerprint formats, and semantic similarity can be calculated based on 4 different DAGs and with 2 different methods, the approach we are presenting here is able to use <inline-formula><inline-graphic xlink:href="pcbi.1000937.e099.jpg" mimetype="image"/></inline-formula> different similarity metrics, each with a real parameter <inline-formula><inline-graphic xlink:href="pcbi.1000937.e100.jpg" mimetype="image"/></inline-formula>.</p></sec></sec><sec sec-type="supplementary-material" id="s5"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pcbi.1000937.s001"><label>Table S1</label><caption><p>Performance indicators for every metric used by Chym, when solving the BBB problem. The table is sorted so that the metric with higher Matthews Correlation Coefficient appears first in the list.</p><p>(0.19 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s001.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pcbi.1000937.s002"><label>Table S2</label><caption><p>Performance indicators for every metric used by Chym, when solving the Pgp problem. The table is sorted so that the metric with higher Matthews Correlation Coefficient appears first in the list.</p><p>(0.19 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s002.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pcbi.1000937.s003"><label>Table S3</label><caption><p>Performance indicators for every metric used by Chym, when solving the estrogen problem. The table is sorted so that the metric with higher Matthews Correlation Coefficient appears first in the list.</p><p>(0.19 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s003.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pcbi.1000937.s004"><label>Table S4</label><caption><p>Activity coefficient of every compound in the ChEBI ontology, when the dataset from the BBB problem is used to train Chym. Only compounds with a structure were considered.</p><p>(0.66 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s004.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pcbi.1000937.s005"><label>Table S5</label><caption><p>Activity coefficient of every compound in the ChEBI ontology, when the dataset from the Pgp problem is used to train Chym. Only compounds with a structure were considered.</p><p>(0.66 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s005.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pcbi.1000937.s006"><label>Table S6</label><caption><p>Activity coefficient of every compound in the ChEBI ontology, when the dataset from the estrogen problem is used to train Chym. Only compounds with a structure were considered.</p><p>(0.66 MB TXT)</p></caption><media xlink:href="pcbi.1000937.s006.txt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><fn-group><fn fn-type="COI-statement"><p>The authors have declared that no competing interests exist.</p></fn><fn fn-type="financial-disclosure"><p>This work was supported by FCT, through the Multiannual Funding Programme. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></fn></fn-group><ref-list><title>References</title><ref id="pcbi.1000937-Tohsato1"><label>1</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Tohsato</surname><given-names>Y</given-names></name><name><surname>Nishimura</surname><given-names>Y</given-names></name></person-group>
<year>2008</year>
<article-title>Metabolic pathway alignment based on similarity between chemical structures.</article-title>
<source>Information and Media Technologies</source>
<volume>3</volume>
<fpage>191</fpage>
<lpage>200</lpage>
</element-citation></ref><ref id="pcbi.1000937-Penzotti1"><label>2</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Penzotti</surname><given-names>JE</given-names></name><name><surname>Lamb</surname><given-names>ML</given-names></name><name><surname>Evensen</surname><given-names>E</given-names></name><name><surname>Grootenhuis</surname><given-names>PDJ</given-names></name></person-group>
<year>2002</year>
<article-title>A computational ensemble pharmacophore model for identifying substrates of P-glycoprotein.</article-title>
<source>J Med Chem</source>
<volume>45</volume>
<fpage>1737</fpage>
<lpage>1740</lpage>
<pub-id pub-id-type="pmid">11960484</pub-id></element-citation></ref><ref id="pcbi.1000937-Fukunishi1"><label>3</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Fukunishi</surname><given-names>Y</given-names></name><name><surname>Mikami</surname><given-names>Y</given-names></name><name><surname>Takedomi</surname><given-names>K</given-names></name><name><surname>Yamanouchi</surname><given-names>M</given-names></name><name><surname>Shima</surname><given-names>H</given-names></name><etal/></person-group>
<year>2006</year>
<article-title>Classification of Chemical Compounds by Protein-Compound Docking for Use in Designing a Focused Library.</article-title>
<source>J Med Chem</source>
<volume>49</volume>
<fpage>523</fpage>
<lpage>533</lpage>
<pub-id pub-id-type="pmid">16420039</pub-id></element-citation></ref><ref id="pcbi.1000937-Richard1"><label>4</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Richard</surname><given-names>AM</given-names></name><name><surname>Gold</surname><given-names>LS</given-names></name><name><surname>Nicklaus</surname><given-names>MC</given-names></name></person-group>
<year>2006</year>
<article-title>Chemical structure indexing of toxicity data on the internet: moving toward a flat worldCurr.</article-title>
<source>Opin Drug Discov Devel</source>
<volume>9</volume>
<fpage>314</fpage>
<lpage>325</lpage>
</element-citation></ref><ref id="pcbi.1000937-Wolosker1"><label>5</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wolosker</surname><given-names>H</given-names></name><name><surname>Dumin</surname><given-names>E</given-names></name><name><surname>Balan</surname><given-names>L</given-names></name><name><surname>Foltyn</surname><given-names>VN</given-names></name></person-group>
<year>2008</year>
<article-title>D-amino acids in the brain: D-serine in neurotransmission and neurodegeneration.</article-title>
<source>FEBS Journal</source>
<volume>275</volume>
<fpage>3514</fpage>
<lpage>3526</lpage>
<pub-id pub-id-type="pmid">18564180</pub-id></element-citation></ref><ref id="pcbi.1000937-Mehta1"><label>6</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Mehta</surname><given-names>A</given-names></name><name><surname>Rief</surname><given-names>M</given-names></name><name><surname>Spudich</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>D</given-names></name><name><surname>Simmons</surname><given-names>R</given-names></name></person-group>
<year>1999</year>
<article-title>Single-molecule biomechanics with optical methods.</article-title>
<source>Science</source>
<volume>283</volume>
<fpage>1689</fpage>
<lpage>1695</lpage>
<pub-id pub-id-type="pmid">10073927</pub-id></element-citation></ref><ref id="pcbi.1000937-Dias1"><label>7</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dias</surname><given-names>R</given-names></name><name><surname>de Azevedo</surname><given-names>WF</given-names><suffix>Jr</suffix></name></person-group>
<year>2008</year>
<article-title>Molecular docking algorithms.</article-title>
<source>Curr Drug Targets</source>
<volume>9</volume>
<fpage>1040</fpage>
<lpage>1047</lpage>
<pub-id pub-id-type="pmid">19128213</pub-id></element-citation></ref><ref id="pcbi.1000937-DeMatos1"><label>8</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>De Matos</surname><given-names>P</given-names></name><name><surname>Alcantara</surname><given-names>R</given-names></name><name><surname>Dekker</surname><given-names>A</given-names></name><name><surname>Ennis</surname><given-names>M</given-names></name><name><surname>Hastings</surname><given-names>J</given-names></name><etal/></person-group>
<year>2009</year>
<article-title>Chemical entities of biological interest: an update.</article-title>
<source>Nucleic Acids Res</source>
<fpage>D249</fpage>
<lpage>D254</lpage>
<pub-id pub-id-type="pmid">19854951</pub-id></element-citation></ref><ref id="pcbi.1000937-Nikolova1"><label>9</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Nikolova</surname><given-names>N</given-names></name><name><surname>Jaworska</surname><given-names>J</given-names></name></person-group>
<year>2004</year>
<article-title>Approaches to measure chemical similarity-a review.</article-title>
<source>QSAR Comb Sci</source>
<volume>22</volume>
<fpage>1006</fpage>
<lpage>1026</lpage>
</element-citation></ref><ref id="pcbi.1000937-Raymond1"><label>10</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Raymond</surname><given-names>JW</given-names></name><name><surname>Gardiner</surname><given-names>EJ</given-names></name><name><surname>Willett</surname><given-names>P</given-names></name></person-group>
<year>2002</year>
<article-title>Heuristics for similarity searching of chemical graphs using a maximum common edge subgraph algorithm.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>42</volume>
<fpage>305</fpage>
<lpage>316</lpage>
<pub-id pub-id-type="pmid">11911700</pub-id></element-citation></ref><ref id="pcbi.1000937-Doniger1"><label>11</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Doniger</surname><given-names>S</given-names></name><name><surname>Hofmann</surname><given-names>T</given-names></name><name><surname>Yeh</surname><given-names>J</given-names></name></person-group>
<year>2002</year>
<article-title>Predicting CNS permeability of drug molecules: comparison of neural network and support vector machine algorithms.</article-title>
<source>J Comput Biol</source>
<volume>9</volume>
<fpage>849</fpage>
<lpage>864</lpage>
<pub-id pub-id-type="pmid">12614551</pub-id></element-citation></ref><ref id="pcbi.1000937-Svetnik1"><label>12</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Svetnik</surname><given-names>V</given-names></name><name><surname>Liaw</surname><given-names>A</given-names></name><name><surname>Tong</surname><given-names>C</given-names></name><name><surname>Culberson</surname><given-names>JC</given-names></name><name><surname>Sheridan</surname><given-names>RP</given-names></name><etal/></person-group>
<year>2003</year>
<article-title>Random forest: a classification and regression tool for compound classification and QSAR modeling.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>43</volume>
<fpage>1947</fpage>
<lpage>1958</lpage>
<pub-id pub-id-type="pmid">14632445</pub-id></element-citation></ref><ref id="pcbi.1000937-Tong1"><label>13</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Tong</surname><given-names>W</given-names></name><name><surname>Hong</surname><given-names>H</given-names></name><name><surname>Fang</surname><given-names>H</given-names></name><name><surname>Xie</surname><given-names>Q</given-names></name><name><surname>Perkins</surname><given-names>R</given-names></name></person-group>
<year>2003</year>
<article-title>Decision forest: combining the predictions of multiple independent decision tree models.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>43</volume>
<fpage>525</fpage>
<lpage>531</lpage>
<pub-id pub-id-type="pmid">12653517</pub-id></element-citation></ref><ref id="pcbi.1000937-Kearsley1"><label>14</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kearsley</surname><given-names>SK</given-names></name><name><surname>Sallamack</surname><given-names>S</given-names></name><name><surname>Fluder</surname><given-names>EM</given-names></name><name><surname>Andose</surname><given-names>JD</given-names></name><name><surname>Mosley</surname><given-names>RT</given-names></name><etal/></person-group>
<year>1996</year>
<article-title>Chemical Similarity Using Physiochemical Property Descriptors.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>36</volume>
<fpage>118</fpage>
<lpage>127</lpage>
</element-citation></ref><ref id="pcbi.1000937-Le1"><label>15</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Le</surname><given-names>SQ</given-names></name><name><surname>Ho</surname><given-names>TB</given-names></name><name><surname>Phan</surname><given-names>TTH</given-names></name></person-group>
<year>2004</year>
<article-title>A novel graph-based similarity measure for 2D chemical structures.</article-title>
<source>Genome Inform</source>
<volume>15</volume>
<fpage>82</fpage>
<lpage>91</lpage>
</element-citation></ref><ref id="pcbi.1000937-Fukunishi2"><label>16</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Fukunishi</surname><given-names>Y</given-names></name><name><surname>Nakamura</surname><given-names>H</given-names></name></person-group>
<year>2009</year>
<article-title>A Similarity Search Using Molecular Topological Graphs.</article-title>
<source>J Biomed Biotechnol</source>
<volume>2009</volume>
</element-citation></ref><ref id="pcbi.1000937-Flower1"><label>17</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Flower</surname><given-names>DR</given-names></name></person-group>
<year>1998</year>
<article-title>On the properties of bit string-based measures of chemical similarity.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>38</volume>
<fpage>379</fpage>
<lpage>386</lpage>
</element-citation></ref><ref id="pcbi.1000937-Raymond2"><label>18</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Raymond</surname><given-names>JW</given-names></name><name><surname>Willett</surname><given-names>P</given-names></name></person-group>
<year>2002</year>
<article-title>Effectiveness of graph-based and fingerprint-based similarity measures for virtual screening of 2D chemical structure databases.</article-title>
<source>J Comput Aided Mol Des</source>
<volume>16</volume>
<fpage>59</fpage>
<lpage>71</lpage>
<pub-id pub-id-type="pmid">12197666</pub-id></element-citation></ref><ref id="pcbi.1000937-Jaccard1"><label>19</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Jaccard</surname><given-names>P</given-names></name></person-group>
<year>1901</year>
<article-title>&#x000c9;tude comparative de la distribution florale dans une portion des Alpes et des Jura.</article-title>
<source>Bulletin de la Soci&#x000e9;t&#x000e9; Vaudoise des Sciences Naturelles</source>
<volume>37</volume>
<fpage>547</fpage>
<lpage>579</lpage>
</element-citation></ref><ref id="pcbi.1000937-Cortes1"><label>20</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Cortes</surname><given-names>C</given-names></name><name><surname>Vapnik</surname><given-names>V</given-names></name></person-group>
<year>1995</year>
<article-title>Support-vector networks.</article-title>
<source>Mach Learn</source>
<volume>20</volume>
<fpage>273</fpage>
<lpage>297</lpage>
</element-citation></ref><ref id="pcbi.1000937-Xue1"><label>21</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Yap</surname><given-names>CW</given-names></name><name><surname>Sun</surname><given-names>LZ</given-names></name><name><surname>Cao</surname><given-names>ZW</given-names></name><name><surname>Wang</surname><given-names>JF</given-names></name><etal/></person-group>
<year>2004</year>
<article-title>Prediction of P-glycoprotein substrates by a support vector machine approach.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>44</volume>
<fpage>1497</fpage>
<lpage>1505</lpage>
<pub-id pub-id-type="pmid">15272858</pub-id></element-citation></ref><ref id="pcbi.1000937-Lord1"><label>22</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lord</surname><given-names>PW</given-names></name><name><surname>Stevens</surname><given-names>RD</given-names></name><name><surname>Brass</surname><given-names>A</given-names></name><name><surname>Goble</surname><given-names>CA</given-names></name></person-group>
<year>2003</year>
<article-title>Investigating semantic similarity measures across the Gene Ontology: the relationship between sequence and annotation.</article-title>
<source>Bioinformatics</source>
<volume>19</volume>
<fpage>1275</fpage>
<lpage>1283</lpage>
<pub-id pub-id-type="pmid">12835272</pub-id></element-citation></ref><ref id="pcbi.1000937-Chandrasekaran1"><label>23</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Chandrasekaran</surname><given-names>B</given-names></name><name><surname>Josephson</surname><given-names>JR</given-names></name><name><surname>Benjamins</surname><given-names>VR</given-names></name></person-group>
<year>1999</year>
<article-title>What are ontologies, and why do we need them?</article-title>
<source>IEEE Intelligent systems</source>
<volume>14</volume>
<fpage>20</fpage>
<lpage>26</lpage>
</element-citation></ref><ref id="pcbi.1000937-Resnik1"><label>24</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Resnik</surname><given-names>P</given-names></name></person-group>
<year>1999</year>
<article-title>Semantic similarity in a taxonomy: An information-based measure and its application to problems of ambiguity in natural language.</article-title>
<source>J Artif Intell</source>
<volume>11</volume>
<fpage>95</fpage>
<lpage>130</lpage>
</element-citation></ref><ref id="pcbi.1000937-Pesquita1"><label>25</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pesquita</surname><given-names>C</given-names></name><name><surname>Faria</surname><given-names>D</given-names></name><name><surname>Falc&#x000e3;o</surname><given-names>AO</given-names></name><name><surname>Lord</surname><given-names>P</given-names></name><name><surname>Couto</surname><given-names>FM</given-names></name></person-group>
<year>2009</year>
<article-title>Semantic similarity in biomedical ontologies.</article-title>
<source>PLoS Comput Biol</source>
<volume>5</volume>
<fpage>e1000443</fpage>
<pub-id pub-id-type="pmid">19649320</pub-id></element-citation></ref><ref id="pcbi.1000937-Baldi1"><label>26</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Baldi</surname><given-names>P</given-names></name><name><surname>Brunak</surname><given-names>S</given-names></name><name><surname>Chauvin</surname><given-names>Y</given-names></name><name><surname>Andersen</surname><given-names>CAF</given-names></name><name><surname>Nielsen</surname><given-names>H</given-names></name></person-group>
<year>2000</year>
<article-title>Assessing the accuracy of prediction algorithms for classification: an overview.</article-title>
<source>Bioinformatics</source>
<volume>16</volume>
<fpage>412</fpage>
<lpage>424</lpage>
<pub-id pub-id-type="pmid">10871264</pub-id></element-citation></ref><ref id="pcbi.1000937-Joachims1"><label>27</label><element-citation publication-type="other">
<person-group person-group-type="author"><name><surname>Joachims</surname><given-names>T</given-names></name></person-group>
<year>1999</year>
<article-title>SVMLight: Support Vector Machine.</article-title>
<comment>Technical report, University of Dortmund. URL <ext-link ext-link-type="uri" xlink:href="http://svmlight.joachims.org/">http://svmlight.joachims.org/</ext-link></comment>
</element-citation></ref><ref id="pcbi.1000937-Witten1"><label>28</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Witten</surname><given-names>IH</given-names></name><name><surname>Frank</surname><given-names>E</given-names></name></person-group>
<year>2005</year>
<source>Data Mining: Practical Mach Learntools and techniques</source>
<publisher-name>Morgan Kaufmann Publishers</publisher-name>
</element-citation></ref><ref id="pcbi.1000937-Bemis1"><label>29</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Bemis</surname><given-names>GW</given-names></name><name><surname>Murcko</surname><given-names>MA</given-names></name></person-group>
<year>1996</year>
<article-title>The properties of known drugs. 1. Molecular frameworks.</article-title>
<source>J Med Chem</source>
<volume>39</volume>
<fpage>2887</fpage>
<lpage>2893</lpage>
<pub-id pub-id-type="pmid">8709122</pub-id></element-citation></ref><ref id="pcbi.1000937-Bemis2"><label>30</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Bemis</surname><given-names>GW</given-names></name><name><surname>Murcko</surname><given-names>MA</given-names></name></person-group>
<year>1999</year>
<article-title>Properties of known drugs. 2. Side chains.</article-title>
<source>J Med Chem</source>
<volume>42</volume>
<fpage>5095</fpage>
<lpage>5099</lpage>
<pub-id pub-id-type="pmid">10602694</pub-id></element-citation></ref><ref id="pcbi.1000937-Zand1"><label>31</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Zand</surname><given-names>RSR</given-names></name><name><surname>Jenkins</surname><given-names>DJA</given-names></name><name><surname>Diamandis</surname><given-names>EP</given-names></name></person-group>
<year>2000</year>
<article-title>Steroid hormone activity of flavonoids and related compounds.</article-title>
<source>Breast Cancer Research and Treatment</source>
<volume>62</volume>
<fpage>35</fpage>
<lpage>49</lpage>
<pub-id pub-id-type="pmid">10989984</pub-id></element-citation></ref><ref id="pcbi.1000937-Markiewicz1"><label>32</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Markiewicz</surname><given-names>L</given-names></name><name><surname>Garey</surname><given-names>J</given-names></name><name><surname>Adlercreutz</surname><given-names>H</given-names></name><name><surname>Gurpide</surname><given-names>E</given-names></name></person-group>
<year>1993</year>
<article-title>In vitro bioassays of non-steroidal phytoestrogens.</article-title>
<source>Journal of Steroid Biochemistry and Molecular Biology</source>
<volume>45</volume>
<fpage>399</fpage>
<lpage>405</lpage>
<pub-id pub-id-type="pmid">8499347</pub-id></element-citation></ref><ref id="pcbi.1000937-Miksicek1"><label>33</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Miksicek</surname><given-names>RJ</given-names></name></person-group>
<year>1993</year>
<article-title>Commonly occurring plant flavonoids have estrogenic activity.</article-title>
<source>Molecular Pharmacology</source>
<volume>44</volume>
<fpage>37</fpage>
<lpage>43</lpage>
<pub-id pub-id-type="pmid">8341277</pub-id></element-citation></ref><ref id="pcbi.1000937-Pesquita2"><label>34</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pesquita</surname><given-names>C</given-names></name><name><surname>Grego</surname><given-names>T</given-names></name><name><surname>Couto</surname><given-names>FM</given-names></name></person-group>
<year>2009</year>
<article-title>Identifying Gene Ontology Areas for Automated Enrichment.</article-title>
<source>Distributed Computing, Artificial Intelligence, Bioinformatics, Soft Computing, and Ambient Assisted Living</source>
<fpage>934</fpage>
<lpage>941</lpage>
</element-citation></ref><ref id="pcbi.1000937-Pesquita3"><label>35</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pesquita</surname><given-names>C</given-names></name><name><surname>Faria</surname><given-names>D</given-names></name><name><surname>Bastos</surname><given-names>H</given-names></name><name><surname>Ferreira</surname><given-names>A</given-names></name><name><surname>Falcao</surname><given-names>A</given-names></name><etal/></person-group>
<year>2008</year>
<article-title>Metrics for GO based protein semantic similarity: a systematic evaluation.</article-title>
<source>BMC Bioinformatics</source>
<volume>9</volume>
<fpage>S4</fpage>
</element-citation></ref><ref id="pcbi.1000937-Guha1"><label>36</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Guha</surname><given-names>R</given-names></name><name><surname>Howard</surname><given-names>MT</given-names></name><name><surname>Hutchison</surname><given-names>GR</given-names></name><name><surname>Murray-Rust</surname><given-names>P</given-names></name><name><surname>Rzepa</surname><given-names>H</given-names></name><etal/></person-group>
<year>2006</year>
<article-title>The Blue Obelisk&#x02013;Interoperability in Chemical Informatics.</article-title>
<source>Journal of Chemical Information and Modeling</source>
<volume>46</volume>
<fpage>991</fpage>
<lpage>998</lpage>
<pub-id pub-id-type="pmid">16711717</pub-id></element-citation></ref><ref id="pcbi.1000937-The1"><label>37</label><element-citation publication-type="other">
<article-title>The Open Babel Package, version 2.2.3.</article-title>
<comment>URL <ext-link ext-link-type="uri" xlink:href="http://openbabel.sourceforge.net/">http://openbabel.sourceforge.net/</ext-link>. (accessed December 2009)</comment>
</element-citation></ref><ref id="pcbi.1000937-Willett1"><label>38</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Willett</surname><given-names>P</given-names></name><name><surname>Barnard</surname><given-names>JM</given-names></name><name><surname>Downs</surname><given-names>GM</given-names></name></person-group>
<year>1998</year>
<article-title>Chemical similarity searching.</article-title>
<source>J Chem Inf Comput Sci</source>
<volume>38</volume>
<fpage>983</fpage>
<lpage>996</lpage>
</element-citation></ref><ref id="pcbi.1000937-Martin1"><label>39</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Martin</surname><given-names>YC</given-names></name><name><surname>Kofron</surname><given-names>JL</given-names></name><name><surname>Traphagen</surname><given-names>LM</given-names></name></person-group>
<year>2002</year>
<article-title>Do structurally similar molecules have similar biological activity?</article-title>
<source>J Med Chem</source>
<volume>45</volume>
<fpage>4350</fpage>
<lpage>4358</lpage>
<pub-id pub-id-type="pmid">12213076</pub-id></element-citation></ref><ref id="pcbi.1000937-Gentleman1"><label>40</label><element-citation publication-type="other">
<person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group>
<year>2005</year>
<article-title>Visualizing and distances using GO.</article-title>
<comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/docs/vignettes.html">http://www.bioconductor.org/docs/vignettes.html</ext-link></comment>
</element-citation></ref><ref id="pcbi.1000937-Ross1"><label>41</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Ross</surname><given-names>SM</given-names></name></person-group>
<year>2002</year>
<source>A first course in probability</source>
<publisher-name>Prentice Hall</publisher-name>
</element-citation></ref><ref id="pcbi.1000937-Kanehisa1"><label>42</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name><name><surname>Hattori</surname><given-names>M</given-names></name><name><surname>Aoki-Kinoshita</surname><given-names>KF</given-names></name><name><surname>Itoh</surname><given-names>M</given-names></name><etal/></person-group>
<year>2006</year>
<article-title>From genomics to chemical genomics: new developments in KEGG.</article-title>
<source>Nucleic Acids Res</source>
<volume>34</volume>
<fpage>D354</fpage>
<lpage>D357</lpage>
<pub-id pub-id-type="pmid">16381885</pub-id></element-citation></ref><ref id="pcbi.1000937-Grego1"><label>43</label><element-citation publication-type="other">
<person-group person-group-type="author"><name><surname>Grego</surname><given-names>T</given-names></name><name><surname>Ferreira</surname><given-names>JD</given-names></name><name><surname>Pesquita</surname><given-names>C</given-names></name><name><surname>Bastos</surname><given-names>H</given-names></name><name><surname>Vila Vi&#x000e7;osa</surname><given-names>D</given-names></name><etal/></person-group>
<year>2010</year>
<article-title>Chemical and Metabolic Pathway Semantic Similarity.</article-title>
<comment>Technical Report DI/FCUL TR 10-1, Department of Informatics, University of Lisbon. URL <ext-link ext-link-type="uri" xlink:href="http://docs.di.fc.ul.pt/jspui/bitstream/10455/3335/3/TR-2010-01.pdf">http://docs.di.fc.ul.pt/jspui/bitstream/10455/3335/3/TR-2010-01.pdf</ext-link></comment>
</element-citation></ref><ref id="pcbi.1000937-Healy1"><label>44</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Healy</surname><given-names>D</given-names></name></person-group>
<year>1997</year>
<source>The antidepressant era</source>
<publisher-name>Harvard University Press</publisher-name>
</element-citation></ref><ref id="pcbi.1000937-Mishra1"><label>45</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Mishra</surname><given-names>R</given-names></name><name><surname>Janowsky</surname><given-names>A</given-names></name><name><surname>Sulser</surname><given-names>F</given-names></name></person-group>
<year>1980</year>
<article-title>Action of mianserin and zimelidine on the norepinephrine receptor coupled adenylate cyclase system in brain: Subsensitivity without reduction in [beta]-adrenergic receptor binding.</article-title>
<source>Neuropharmacology</source>
<volume>19</volume>
<fpage>983</fpage>
<lpage>987</lpage>
<pub-id pub-id-type="pmid">6252500</pub-id></element-citation></ref><ref id="pcbi.1000937-Amsterdam1"><label>46</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Amsterdam</surname><given-names>JD</given-names></name><name><surname>Kaplan</surname><given-names>M</given-names></name><name><surname>Potter</surname><given-names>L</given-names></name><name><surname>Bloom</surname><given-names>L</given-names></name><name><surname>Rickels</surname><given-names>K</given-names></name></person-group>
<year>1986</year>
<article-title>Adinazolam, a new triazolobenzodiazepine, and imipramine in the treatment of major depressive disorder.</article-title>
<source>Psychopharmacology</source>
<volume>88</volume>
<fpage>484</fpage>
<lpage>488</lpage>
<pub-id pub-id-type="pmid">3085137</pub-id></element-citation></ref><ref id="pcbi.1000937-Keogh1"><label>47</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Keogh</surname><given-names>JP</given-names></name><name><surname>Kunta</surname><given-names>JR</given-names></name></person-group>
<year>2006</year>
<article-title>Development, validation and utility of an in vitro technique for assessment of potential clinical drug-drug interactions involving P-glycoprotein.</article-title>
<source>Eur J Pharm Sci</source>
<volume>27</volume>
<fpage>543</fpage>
<lpage>554</lpage>
<pub-id pub-id-type="pmid">16406207</pub-id></element-citation></ref><ref id="pcbi.1000937-Lehne1"><label>48</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lehne</surname><given-names>G</given-names></name><name><surname>De Angelis</surname><given-names>P</given-names></name><name><surname>Clausen</surname><given-names>OP</given-names></name><name><surname>Rugstad</surname><given-names>HE</given-names></name></person-group>
<year>1996</year>
<article-title>Human hepatoma cells rich in P-glycoprotein are sensitive to aclarubicin and resistant to three other anthracyclines.</article-title>
<source>Br J Cancer</source>
<volume>74</volume>
<fpage>1719</fpage>
<lpage>1729</lpage>
<pub-id pub-id-type="pmid">8956784</pub-id></element-citation></ref><ref id="pcbi.1000937-Ullah1"><label>49</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Ullah</surname><given-names>MF</given-names></name></person-group>
<year>2008</year>
<article-title>Cancer multidrug resistance (MDR): a major impediment to effective chemotherapy.</article-title>
<source>Asian Pac J Cancer Prev</source>
<volume>9</volume>
<fpage>1</fpage>
<lpage>6</lpage>
<pub-id pub-id-type="pmid">18439063</pub-id></element-citation></ref><ref id="pcbi.1000937-Ranilla1"><label>50</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Ranilla</surname><given-names>LG</given-names></name><name><surname>Genovese</surname><given-names>MI</given-names></name><name><surname>Lajolo</surname><given-names>FM</given-names></name></person-group>
<year>2009</year>
<article-title>Isoflavones and antioxidant capacity of Peruvian and Brazilian lupin cultivars.</article-title>
<source>J Food Compost Anal</source>
<volume>22</volume>
<fpage>397</fpage>
<lpage>404</lpage>
</element-citation></ref><ref id="pcbi.1000937-So1"><label>51</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>So</surname><given-names>FV</given-names></name><name><surname>Guthrie</surname><given-names>N</given-names></name><name><surname>Chambers</surname><given-names>AF</given-names></name><name><surname>Carroll</surname><given-names>KK</given-names></name></person-group>
<year>1997</year>
<article-title>Inhibition of proliferation of estrogen receptor-positive MCF-7 human breast cancer cells by flavonoids in the presence and absence of excess estrogen.</article-title>
<source>Cancer Lett</source>
<volume>112</volume>
<fpage>127</fpage>
<lpage>133</lpage>
<pub-id pub-id-type="pmid">9066718</pub-id></element-citation></ref><ref id="pcbi.1000937-Harris1"><label>52</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Harris</surname><given-names>RM</given-names></name><name><surname>Wood</surname><given-names>DM</given-names></name><name><surname>Bottomley</surname><given-names>L</given-names></name><name><surname>Blagg</surname><given-names>S</given-names></name><name><surname>Owen</surname><given-names>K</given-names></name><etal/></person-group>
<year>2004</year>
<article-title>Phytoestrogens are potent inhibitors of estrogen sulfation: implications for breast cancer risk and treatment.</article-title>
<source>J Clin Endocrinol Metab</source>
<volume>89</volume>
<fpage>1779</fpage>
<lpage>1787</lpage>
<pub-id pub-id-type="pmid">15070945</pub-id></element-citation></ref></ref-list></back></article>
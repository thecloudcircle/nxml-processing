
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30372479</article-id><article-id pub-id-type="pmc">6205639</article-id><article-id pub-id-type="publisher-id">PONE-D-18-13690</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0206091</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Computer Vision</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Birds</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Imaging Techniques</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject><subj-group><subject>Political Science</subject><subj-group><subject>Public Policy</subject><subj-group><subject>Welfare (Social Security)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Social Welfare</subject><subj-group><subject>Welfare (Social Security)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Population Ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and Environmental Sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Population Ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Criminology</subject><subj-group><subject>Police</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and Places</subject><subj-group><subject>Population Groupings</subject><subj-group><subject>Professions</subject><subj-group><subject>Police</subject></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Simplified procedure for efficient and unbiased population size estimation</article-title><alt-title alt-title-type="running-head">Simplified procedure for efficient and unbiased population size estimation</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4767-530X</contrib-id><name><surname>Cruz</surname><given-names>Marcos</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Funding acquisition</role><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"/><xref ref-type="corresp" rid="cor001">*</xref></contrib><contrib contrib-type="author"><name><surname>Gonz&#x000e1;lez-Villa</surname><given-names>Javier</given-names></name><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"/></contrib></contrib-group><aff id="aff001">
<addr-line>Department of Mathematics, Statistics and Computer Science, Univ. of Cantabria, Av. Los Castros 48, E-39005 Santander, Spain</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Rutherford</surname><given-names>Suzannah</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>Fred Hutchinson Cancer Research Center, UNITED STATES</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>marcos.cruz@unican.es</email></corresp></author-notes><pub-date pub-type="collection"><year>2018</year></pub-date><pub-date pub-type="epub"><day>29</day><month>10</month><year>2018</year></pub-date><volume>13</volume><issue>10</issue><elocation-id>e0206091</elocation-id><history><date date-type="received"><day>7</day><month>5</month><year>2018</year></date><date date-type="accepted"><day>5</day><month>10</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2018 Cruz, Gonz&#x000e1;lez-Villa</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Cruz, Gonz&#x000e1;lez-Villa</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0206091.pdf"/><abstract><p>Population size estimation is relevant to social and ecological sciences. Exhaustive manual counting, the density method and automated computer vision are some of the estimation methods that are currently used. Some of these methods may work in concrete cases but they do not provide a fast, efficient and unbiased estimation in general. Recently, the <italic>CountEm</italic> method, based on systematic sampling with a grid of quadrats, was proposed. It offers an unbiased estimation that can be applied to any population. However, choosing suitable grid parameters is sometimes cumbersome. Here we define a more intuitive grid parametrization, using initial number of quadrats and sampling fraction. A crowd counting dataset with 51 images and their corresponding, manually annotated position point patterns, are used to analyze the variation of the coefficient of error with respect to different parameter choices. Our Monte Carlo resampling results show that the error depends on the sample size and the number of nonempty quadrats, but not on the size of the target population. A procedure to choose suitable parameter values is described, and the expected coefficients of error are given. Counting about 100 particles in 30 nonempty quadrats usually yields coefficients of error below 10%.</p></abstract><funding-group><award-group id="award001"><funding-source><institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100010198</institution-id><institution>Ministerio de Econom&#x000ed;a, Industria y Competitividad, Gobierno de Espa&#x000f1;a</institution></institution-wrap></funding-source><award-id>AYA-2015-66357-R</award-id><principal-award-recipient><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4767-530X</contrib-id><name><surname>Cruz</surname><given-names>Marcos</given-names></name></principal-award-recipient></award-group><funding-statement>This work was supported by AYA-2015-66357-R Ministerio de Econom&#x000ed;a, Industria y Competitividad (MINECO) / Fondos Europeos de Desarrollo Regional (FEDER) to MC.</funding-statement></funding-group><counts><fig-count count="5"/><table-count count="0"/><page-count count="11"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>The UCF Crowd Counting Dataset files are available from: &#x0003c;<ext-link ext-link-type="uri" xlink:href="http://crcv.ucf.edu/data/ucf-cc-50/">http://crcv.ucf.edu/data/ucf-cc-50/</ext-link>&#x0003e;. The CountEm Spectators image and data file are available from: &#x0003c;<ext-link ext-link-type="uri" xlink:href="https://countem.unican.es/en/Downloads">https://countem.unican.es/en/Downloads</ext-link>&#x0003e;.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>The UCF Crowd Counting Dataset files are available from: &#x0003c;<ext-link ext-link-type="uri" xlink:href="http://crcv.ucf.edu/data/ucf-cc-50/">http://crcv.ucf.edu/data/ucf-cc-50/</ext-link>&#x0003e;. The CountEm Spectators image and data file are available from: &#x0003c;<ext-link ext-link-type="uri" xlink:href="https://countem.unican.es/en/Downloads">https://countem.unican.es/en/Downloads</ext-link>&#x0003e;.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Population sizing is a longstanding problem with a wide range of applications such as security, social sciences and ecology. A population is a finite set of <italic>N</italic> separate items or &#x0201c;particles&#x0201d; of interest, e.g. humans, birds, etc. Several approaches have been taken to address the problem. The traditional density method [<xref rid="pone.0206091.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0206091.ref002" ref-type="bibr">2</xref>] is widely used by media, police and convention organizers for crowd size estimation, but the estimation usually ignores sampling and relies on imprecise visual estimation. Frequently, bird censuses also lean on visual estimation [<xref rid="pone.0206091.ref003" ref-type="bibr">3</xref>&#x02013;<xref rid="pone.0206091.ref006" ref-type="bibr">6</xref>] or exhaustive manual counting [<xref rid="pone.0206091.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0206091.ref008" ref-type="bibr">8</xref>] that is slow, tedious and difficult to verify. Automated computer vision can work in some particular cases with regular patterns on homogeneous backgrounds and non-overlapping particles [<xref rid="pone.0206091.ref009" ref-type="bibr">9</xref>&#x02013;<xref rid="pone.0206091.ref015" ref-type="bibr">15</xref>]. However, automatic algorithms are generally biased and may show a poor performance [<xref rid="pone.0206091.ref016" ref-type="bibr">16</xref>].</p><p>An unbiased population size estimation method (hereafter <italic>CountEm</italic> method) was recently proposed [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>]. <italic>CountEm</italic> can be applied to any kind of particle irrespective of population size and pattern (see for instance Figs 1 and 5 in [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>]). The only practical limitation is the basic requirement that all the particles in the population should be unambiguously identifiable for manual counting in the considered image. It is based on well known principles of geometric sampling for stereology which have been previously applied to quantitative microscopy [<xref rid="pone.0206091.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0206091.ref019" ref-type="bibr">19</xref>]. The main idea is to properly sample and count between 50 and 200 particles in order to estimate populations of any size and spatial distribution. Systematic sampling is performed with a uniform random (UR) grid of quadrats, see <xref ref-type="fig" rid="pone.0206091.g001">Fig 1</xref>. The forbidden line rule [<xref rid="pone.0206091.ref020" ref-type="bibr">20</xref>] is used to avoid bias due to edge effects: a particle is counted only if it touches the quadrat but it does not hit the extended forbidden line of the quadrat (see <xref ref-type="fig" rid="pone.0206091.g001">Fig 1C</xref>). The population size estimator, <inline-formula id="pone.0206091.e001"><alternatives><graphic xlink:href="pone.0206091.e001.jpg" id="pone.0206091.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, is the total number of sampled particles, times the sampling period. The precision of the method was tested [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] on two images with manually annotated particle positions, yielding planar point patterns e.g. <xref ref-type="fig" rid="pone.0206091.g002">Fig 2A</xref>. As the method is unbiased, the only source of error comes from sampling variance which can be estimated empirically via Monte Carlo resampling under identical conditions (see Section Simulation procedure). The empirical variance of the population size estimator was computed among 32<sup>2</sup> = 1024 Monte Carlo replications of the estimator for each given grid of quadrats. The empirical coefficient of error was in the 5% &#x02212; 10% range, counting about 50 &#x02212; 100 sampled particles for both point patterns of sizes 1120 and 4633 respectively.</p><fig id="pone.0206091.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0206091.g001</object-id><label>Fig 1</label><caption><title>The <italic>CountEm</italic> method.</title><p>(A): Spectators in a football match (Reprinted from [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] under a CC BY license, with permission from Ra&#x000fa;l Cancio, Bilbao, 1966). A square grid of quadrats was superimposed uniformly at random to estimate the total number of spectators in the image. The quadrat marked with a yellow arrowhead is magnified in (C). (B): Square grid of quadrats with parameters <italic>t</italic>, <italic>T</italic>. (C): Forbidden line rule to remove edge effects in manual counting [<xref rid="pone.0206091.ref020" ref-type="bibr">20</xref>]. Only heads marked with yellow arrowheads are counted in the quadrat, the rest are not because they hit the extended forbidden edge (in red).</p></caption><graphic xlink:href="pone.0206091.g001"/></fig><fig id="pone.0206091.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0206091.g002</object-id><label>Fig 2</label><caption><title>Parameter selection.</title><p>(A): Point pattern of the <italic>N</italic> = 1120 manually annotated crowd positions corresponding to <xref ref-type="fig" rid="pone.0206091.g001">Fig 1A</xref>. The bounding box is plotted in blue. (B): Relation between parameters {<italic>f</italic>, <italic>n</italic><sub>0</sub>} and {<italic>t</italic>, <italic>T</italic>}. Box size <italic>T</italic> is the area of the bounding box divided by the initial number of quadrats, <italic>n</italic><sub>0</sub>. Quadrat size, <italic>t</italic>, is the box size times the square root of the sampling fraction, <italic>f</italic>. (C): Random superimposition of the grid of quadrats (B) on point pattern (A). The grid was tilted 30&#x000b0; with respect to the <italic>x</italic> axis.</p></caption><graphic xlink:href="pone.0206091.g002"/></fig><p>Some practical criteria were given [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] to choose the grid parameters. However, in practice, the choice of starting values for these parameters may not be obvious to every user. Moreover, note that these practical criteria were only checked to be valid on two pictures.</p><p>Here we propose to simplify these practical guidelines, by using a more convenient parametrization of the grid. The new estimation protocol is presented and justified in section Materials and Methods. The protocol and the parameter values are tested on the 51 images of the crowd counting dataset, which is described in The crowd counting dataset. The Monte Carlo resampling procedure used to compute the empirical coefficients of error is described in Section Simulation procedure. The results and conclusions are presented in Sections Results and Conclusions respectively.</p></sec><sec sec-type="materials|methods" id="sec002"><title>Materials and methods</title><sec id="sec003"><title>Definitions and notation</title><p>We recall the necessary notation [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>]:</p><list list-type="bullet"><list-item><p><italic>N</italic>: Population size, i.e. number of particles in the target population.</p></list-item><list-item><p>
<inline-formula id="pone.0206091.e002"><alternatives><graphic xlink:href="pone.0206091.e002.jpg" id="pone.0206091.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>: Population size estimator.
<disp-formula id="pone.0206091.e003"><alternatives><graphic xlink:href="pone.0206091.e003.jpg" id="pone.0206091.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mi>Q</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p></list-item><list-item><p><italic>Q</italic>: Total number of particles sampled by the quadrats.</p></list-item><list-item><p><italic>T</italic>: Separation between quadrat centers, <italic>T</italic> &#x0003e; 0.</p></list-item><list-item><p><italic>t</italic>: Quadrat side length <italic>t</italic>, (0 &#x0003c; <italic>t</italic> &#x02264; <italic>T</italic> &#x0003c; &#x0221e;).</p></list-item><list-item><p><italic>n</italic>: Number of nonempty quadrats.</p></list-item><list-item><p>
<inline-formula id="pone.0206091.e004"><alternatives><graphic xlink:href="pone.0206091.e004.jpg" id="pone.0206091.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>: Empirical coefficient of error of <inline-formula id="pone.0206091.e005"><alternatives><graphic xlink:href="pone.0206091.e005.jpg" id="pone.0206091.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, calculated via Monte Carlo replications (<xref ref-type="disp-formula" rid="pone.0206091.e021">Eq 7</xref>).</p></list-item></list><p>Here we propose two alternative grid parameters, <italic>f</italic> and <italic>n</italic><sub>0</sub>, which are related to <italic>t</italic> and <italic>T</italic> as shown in <xref ref-type="fig" rid="pone.0206091.g002">Fig 2B</xref>:</p><list list-type="bullet"><list-item><p><italic>f</italic>: Sampling fraction, <italic>f</italic> = <italic>t</italic><sup>2</sup>/<italic>T</italic><sup>2</sup>.</p></list-item><list-item><p><italic>n</italic><sub>0</sub>: Initial number of quadrats, <italic>n</italic><sub>0</sub> = <italic>B</italic><sub><italic>x</italic></sub><italic>B</italic><sub><italic>y</italic></sub>/<italic>T</italic><sup>2</sup> where <italic>B</italic><sub><italic>x</italic></sub>, <italic>B</italic><sub><italic>y</italic></sub> represent image width and height in pixels, respectively.</p></list-item></list><p>Next we present an outline of the &#x0201c;standard&#x0201d; <italic>CountEm</italic> method [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] and of the simplified protocol which we propose here.</p></sec><sec id="sec004"><title>Outline of the <italic>CountEm</italic> method</title><p>The main steps of the standard <italic>CountEm</italic> method [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] are:</p><list list-type="order"><list-item><p>Crop the image, excluding empty regions as in <xref ref-type="fig" rid="pone.0206091.g002">Fig 2A</xref>. This step is optional but highly recommended to increase efficiency.</p></list-item><list-item><p>Choose suitable values of <italic>t</italic> and <italic>T</italic> in pixels.</p></list-item><list-item><p>Superimpose the grid uniformly at random on the image, e.g. <xref ref-type="fig" rid="pone.0206091.g001">Fig 1A</xref>. Optionally, the grid might be tilted at will by a given fixed angle in order to avoid alignments of quadrat and particle rows which would increase the variance [<xref rid="pone.0206091.ref021" ref-type="bibr">21</xref>].</p></list-item><list-item><p>Manually count the total number, <italic>Q</italic>, of particles captured by the quadrats. Use the forbidden line rule to ensure unbiasedness: only particles intersecting the quadrat, and not touching the extended forbidden line (in red in <xref ref-type="fig" rid="pone.0206091.g001">Fig 1C</xref>), are counted.</p></list-item><list-item><p>Use <xref ref-type="disp-formula" rid="pone.0206091.e003">Eq 1</xref> to obtain the estimated population size, <inline-formula id="pone.0206091.e006"><alternatives><graphic xlink:href="pone.0206091.e006.jpg" id="pone.0206091.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p></list-item><list-item><p>Use Eq 3 of our previous paper [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] to predict <inline-formula id="pone.0206091.e007"><alternatives><graphic xlink:href="pone.0206091.e007.jpg" id="pone.0206091.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></sec><sec id="sec005"><title>Outline of the simplified <italic>CountEm</italic> protocol</title><p>The simplified <italic>CountEm</italic> protocol proposed here consists of the following steps:</p><list list-type="order"><list-item><p>Apply standard <italic>CountEm</italic> step 1).</p></list-item><list-item><p>Choose suitable values of <italic>f</italic> and <italic>n</italic><sub>0</sub>. Tentatively one may start with <italic>n</italic><sub>0</sub> = 100 and <italic>f</italic> = 0.04.</p></list-item><list-item><p>Apply standard <italic>CountEm</italic> step 3).</p></list-item><list-item><p>By cursory inspection, check that <italic>Q</italic> and the number of nonempty quadrats are approximately in the following ranges depending on the desired coefficient of error:</p><list list-type="bullet"><list-item><p><italic>Q</italic> &#x02273; 50 and <inline-formula id="pone.0206091.e008"><alternatives><graphic xlink:href="pone.0206091.e008.jpg" id="pone.0206091.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>20</mml:mn><mml:mo>&#x027f9;</mml:mo><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>&#x02272;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item><list-item><p><italic>Q</italic> &#x02273; 100 and <inline-formula id="pone.0206091.e009"><alternatives><graphic xlink:href="pone.0206091.e009.jpg" id="pone.0206091.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>30</mml:mn><mml:mo>&#x027f9;</mml:mo><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>&#x02272;</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item><list-item><p><italic>Q</italic> &#x02248; 200 and <inline-formula id="pone.0206091.e010"><alternatives><graphic xlink:href="pone.0206091.e010.jpg" id="pone.0206091.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02248;</mml:mo><mml:mn>50</mml:mn><mml:mo>&#x027f9;</mml:mo><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list><p>If <italic>Q</italic> looks too low, then go back to step 2) and increase <italic>f</italic>. On the other hand if <italic>n</italic> is too low, go back to step 2) and increase <italic>n</italic><sub>0</sub>.</p></list-item><list-item><p>Apply standard <italic>CountEm</italic> steps 4), 5) and 6).</p></list-item></list><p>The corresponding software is freely available at <ext-link ext-link-type="uri" xlink:href="http://countem.unican.es">http://countem.unican.es</ext-link>). The whole estimation process can be made in a few minutes.</p></sec><sec id="sec006"><title>Justification of the protocol</title><p>Choosing suitable parameters <italic>t</italic> and <italic>T</italic> in pixels, as suggested in our previous paper [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>], can sometimes be laborious. Two practical criteria were given [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>], namely aim at (i) having <italic>Q</italic> in the 50 &#x02212; 150 range, and (ii) counting no more than 4 or 5 particles per quadrat. These two recommendations imply that the number of nonempty quadrats, <italic>n</italic>, may lie between 20 and 50. The resulting coefficient of error should be in the 5% &#x02212; 10% range.</p><p>Consider an example in which the preceding criteria are fulfilled. The goal would be to estimate the number of particles <italic>N</italic> in the image, with coefficient of error below 10% using the old parametrization <italic>t</italic>, <italic>T</italic>. After choosing some initial parameters <italic>t</italic> and <italic>T</italic>, suppose that we count <italic>Q</italic> = 40 in <italic>n</italic> = 18 nonempty quadrats, with an estimated coefficient of error <inline-formula id="pone.0206091.e011"><alternatives><graphic xlink:href="pone.0206091.e011.jpg" id="pone.0206091.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mtext>ce</mml:mtext><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In order to reduce the error, we should increase <italic>Q</italic> and <italic>n</italic> since both are below the suggested ranges. But how should we proceed? Increasing <italic>t</italic> to get larger quadrats? Decreasing <italic>T</italic> to obtain more quadrats? Or both? To what extent?</p><p>We propose to replace the parameters <italic>t</italic> and <italic>T</italic> with the sampling fraction, <italic>f</italic>, and the initial number of quadrats, <italic>n</italic><sub>0</sub> as shown in the preceding subsection. This parametrization is more intuitive and even inexperienced users should find it easy to implement. Reducing the error is straightforward following the simplified procedure with the new parameters as described above.</p><p>The validity of the protocol has been checked on 51 images, studying in detail the error ranges corresponding to different sets of parameters.</p><p>The empirical squared coefficient of error, <inline-formula id="pone.0206091.e012"><alternatives><graphic xlink:href="pone.0206091.e012.jpg" id="pone.0206091.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, was computed by Monte Carlo resampling for each of the 51 point patterns in the crowd counting dataset. The dataset is described in Section The crowd counting dataset, whereas the details on the calculation of <inline-formula id="pone.0206091.e013"><alternatives><graphic xlink:href="pone.0206091.e013.jpg" id="pone.0206091.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are shown in Section Simulation procedure.</p></sec><sec id="sec007"><title>The crowd counting dataset</title><p>A total of 51 images were used for two purposes, namely checking the validity of the practical criteria discussed above, and analyzing the optimal <italic>f</italic> and <italic>n</italic><sub>0</sub> values to ensure efficient estimation. The crowd sizes, <italic>N</italic>, vary from 96 to 4633. 50 of the images and their corresponding point patterns (see <xref ref-type="fig" rid="pone.0206091.g003">Fig 3</xref>) were borrowed from the <italic>UCF dataset</italic> [<xref rid="pone.0206091.ref012" ref-type="bibr">12</xref>]. The additional image is the spectators image countem.unican.es shown in Figs <xref ref-type="fig" rid="pone.0206091.g001">1</xref> and <xref ref-type="fig" rid="pone.0206091.g002">2</xref>, which was already analyzed in our previous paper [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>] together with the image corresponding to the largest crowd of the dataset (<italic>N</italic> = 4633).</p><fig id="pone.0206091.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0206091.g003</object-id><label>Fig 3</label><caption><title>Crowd counting dataset.</title><p>15 manually annotated point patterns selected at random from the crowd counting dataset. The total number of point patterns in the dataset is 51.</p></caption><graphic xlink:href="pone.0206091.g003"/></fig></sec><sec id="sec008"><title>Simulation procedure</title><p>The empirical squared coefficient of error <inline-formula id="pone.0206091.e014"><alternatives><graphic xlink:href="pone.0206091.e014.jpg" id="pone.0206091.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> was computed by Monte Carlo resampling on the 51 point sets for different choices of parameters {<italic>f</italic>, <italic>n</italic><sub>0</sub>}. The corresponding parameters {<italic>t</italic>, <italic>T</italic>} were calculated as follows (<xref ref-type="fig" rid="pone.0206091.g002">Fig 2B</xref>):
<disp-formula id="pone.0206091.e015"><alternatives><graphic xlink:href="pone.0206091.e015.jpg" id="pone.0206091.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>T</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>T</mml:mi><mml:msqrt><mml:mi>f</mml:mi></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
The resulting grid was tilted an arbitrary fixed angle of 30&#x000b0; with respect to the <italic>x</italic> axis, before applying the resampling procedure described in our previous paper [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>]. Ideally the angle should be suitably selected for each image in order to avoid alignments of quadrat rows with particle patterns. However, visual inspection (<xref ref-type="fig" rid="pone.0206091.g003">Fig 3</xref>) reveals that most of the images have either horizontal spectator rows (= 0&#x000b0;) or no concrete particle alignments. Therefore choosing 30&#x000b0; for the whole dataset was judged to be reasonable. This problem was addressed in [<xref rid="pone.0206091.ref021" ref-type="bibr">21</xref>], Fig 11. Next we recall the necessary notation to describe the resampling procedure:</p><list list-type="bullet"><list-item><p><italic>Y</italic> = {<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, &#x02026;, <italic>y</italic><sub><italic>N</italic></sub>}: finite set of <italic>N</italic> point particles in a bounded area. We studied 51 such sets (<xref ref-type="fig" rid="pone.0206091.g003">Fig 3</xref>).</p></list-item><list-item><p><italic>y</italic><sub><italic>i</italic></sub> &#x02208; <italic>Y</italic>: <italic>i</italic>th point particle of the set.</p></list-item><list-item><p><italic>J</italic><sub>0</sub>: fundamental square tile or box of side length <italic>T</italic>.</p></list-item><list-item><p><italic>z</italic> &#x02208; <italic>J</italic><sub>0</sub>: UR point in the fundamental tile.</p></list-item><list-item><p>&#x0039b;<sub><italic>z</italic></sub>: UR systematic grid of quadrats, generated by shifting the lower left corner of a quadrat from an arbitrary initial position in <italic>J</italic><sub>0</sub> into the UR point <italic>z</italic>, thus dragging the whole quadrat grid together.</p></list-item><list-item><p><italic>Q</italic> = <italic>Q</italic>(<italic>Y</italic> &#x02229; &#x0039b;<sub><italic>z</italic></sub>): random sample size, namely the total number of particles captured by the quadrats.</p></list-item></list><p>For each pair {<italic>t</italic>, <italic>T</italic>} a total of <italic>K</italic><sup>2</sup> = 32<sup>2</sup> = 1024 replicated superimpositions of the grid &#x0039b;<sub><italic>z</italic></sub> onto <italic>Y</italic> were generated, corresponding to <italic>K</italic><sup>2</sup> systematic replications {<italic>z</italic><sub><italic>k</italic></sub>, <italic>k</italic> = 1, 2, &#x02026;, <italic>K</italic><sup>2</sup>} of the point <italic>z</italic> within <italic>J</italic><sub>0</sub>. These <italic>K</italic><sup>2</sup> positions were arranged in a random subgrid within <italic>J</italic><sub>0</sub> which should be expected to be more efficient than independent random replications [<xref rid="pone.0206091.ref017" ref-type="bibr">17</xref>]. For each <italic>k</italic>, the corresponding sample total,
<disp-formula id="pone.0206091.e016"><alternatives><graphic xlink:href="pone.0206091.e016.jpg" id="pone.0206091.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mo>&#x0039b;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
was computed automatically from <xref ref-type="disp-formula" rid="pone.0206091.e003">Eq 1</xref> using the <italic>spatstat</italic> package [<xref rid="pone.0206091.ref022" ref-type="bibr">22</xref>]:
<disp-formula id="pone.0206091.e017"><alternatives><graphic xlink:href="pone.0206091.e017.jpg" id="pone.0206091.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>/</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
The empirical mean, variance and squared coefficient of error of <inline-formula id="pone.0206091.e018"><alternatives><graphic xlink:href="pone.0206091.e018.jpg" id="pone.0206091.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> were computed respectively as follows,
<disp-formula id="pone.0206091.e019"><alternatives><graphic xlink:href="pone.0206091.e019.jpg" id="pone.0206091.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pone.0206091.e020"><alternatives><graphic xlink:href="pone.0206091.e020.jpg" id="pone.0206091.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Var</mml:mtext><mml:mi>e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:munderover><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pone.0206091.e021"><alternatives><graphic xlink:href="pone.0206091.e021.jpg" id="pone.0206091.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mtext>Var</mml:mtext><mml:mi>e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p></sec></sec><sec id="sec009"><title>Results: Justification of the recommended parameter values</title><p>Figs <xref ref-type="fig" rid="pone.0206091.g004">4</xref> and <xref ref-type="fig" rid="pone.0206091.g005">5</xref> allow us to justify the tentative values for parameters {<italic>f</italic>, <italic>n</italic><sub>0</sub>} (step 2) and the practical criteria related to sample size, <italic>Q</italic>, and number of nonempty quadrats, <italic>n</italic>, (step 4) given in the simplified estimation protocol proposed above.</p><fig id="pone.0206091.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0206091.g004</object-id><label>Fig 4</label><caption><title>Empirical squared coefficient of error for fixed parameter values.</title><p>(A, B, C): Empirical squared coefficient of error of the 51 point patterns in the crowd counting dataset, for fixed sampling fractions <italic>f</italic> = 0.02, 0.04, 0.06 respectively. Population and sample sizes are shown on the <italic>x</italic> axis. Blue and red color represent initial number of quadrats <italic>n</italic><sub>0</sub> = 50, 100 respectively. Broken horizontal lines correspond to 5%, 10% and 15%, whereas the vertical broken is drawn at sample size <italic>Q</italic> = 50. (D, E, F): Analogous plots for nonempty quadrats <italic>n</italic>. Broken horizontal lines correspond to 20, 30 and 50 quadrats.</p></caption><graphic xlink:href="pone.0206091.g004"/></fig><fig id="pone.0206091.g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0206091.g005</object-id><label>Fig 5</label><caption><title>Empirical coefficient of error for optimal parameter values.</title><p>(A): Empirical coefficient of error, obtained with sampling fractions adapted to each of the 51 point patterns considered in <xref ref-type="fig" rid="pone.0206091.g004">Fig 4</xref>. Blue, red and green colors represent sample sizes <italic>Q</italic> = 50, <italic>Q</italic> = 100 and <italic>Q</italic> = 200 respectively. Initial number of quadrats was set to <italic>n</italic><sub>0</sub> = 100 for all cases. (B): Analogous plots for nonempty quadrats <italic>n</italic>. The broken horizontal lines are as in <xref ref-type="fig" rid="pone.0206091.g004">Fig 4</xref>.</p></caption><graphic xlink:href="pone.0206091.g005"/></fig><p>With reference to <xref ref-type="fig" rid="pone.0206091.g004">Fig 4</xref>, six different parameter pairs {<italic>f</italic>, <italic>n</italic><sub>0</sub>} were considered by combining two initial number of quadrats values, namely <italic>n</italic><sub>0</sub> = 50, 100 and three sampling fraction values, namely <italic>f</italic> = 0.02, 0.04, 0.06. The empirical squared coefficient of error, <inline-formula id="pone.0206091.e022"><alternatives><graphic xlink:href="pone.0206091.e022.jpg" id="pone.0206091.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, (top row) and nonempty quadrats, <italic>n</italic>, (bottom row) are represented versus real population size, <italic>N</italic>, and sample size, <italic>Q</italic>. Note that we considered fixed parameter values for all the 51 images, which is not efficient since the resulting <italic>Q</italic> and <italic>n</italic> values depend on population size <italic>N</italic> and spatial distribution of the particles. For instance setting <italic>f</italic> = 0.06 yields <italic>Q</italic> &#x0223c; 6 (too low) for <italic>N</italic> = 96, and <italic>Q</italic> &#x0223c; 278 (too high) for <italic>N</italic> = 4633.</p><p>In practice, suitable parameter values should be chosen for each image, but for the present dataset <italic>n</italic><sub>0</sub> = 100 works rather well for all images, as shown in <xref ref-type="fig" rid="pone.0206091.g005">Fig 5</xref>, where the sampling fraction was selected <italic>a posteriori</italic> as <italic>f</italic> = <italic>Q</italic>/<italic>N</italic>, with <italic>Q</italic> = 50, 100, 200 and <italic>N</italic> the number of manually annotated points in each image. Obviously, this can not be done in practice since <italic>N</italic> is unknown, but the results allow us to establish some tentative values for <italic>f</italic> depending on the order of magnitude of population size <italic>N</italic> and the desired coefficient of error. For instance if we aim at <inline-formula id="pone.0206091.e023"><alternatives><graphic xlink:href="pone.0206091.e023.jpg" id="pone.0206091.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:msub><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>&#x02272;</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> the following starting values can be chosen depending on <italic>N</italic>, aiming at <inline-formula id="pone.0206091.e024"><alternatives><graphic xlink:href="pone.0206091.e024.jpg" id="pone.0206091.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>:</p><list list-type="bullet"><list-item><p>
<inline-formula id="pone.0206091.e025"><alternatives><graphic xlink:href="pone.0206091.e025.jpg" id="pone.0206091.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02272;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x027f9;</mml:mo><mml:mi>f</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Note that for population sizes <inline-formula id="pone.0206091.e026"><alternatives><graphic xlink:href="pone.0206091.e026.jpg" id="pone.0206091.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02272;</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> the use of <italic>CountEm</italic> is not very helpful since <italic>Q</italic> &#x0223c; <italic>N</italic>. A suitable starting value for small populations is <italic>f</italic> = 0.1.</p></list-item><list-item><p>
<inline-formula id="pone.0206091.e027"><alternatives><graphic xlink:href="pone.0206091.e027.jpg" id="pone.0206091.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x02272;</mml:mo><mml:mi>N</mml:mi><mml:mo>&#x02272;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>&#x027f9;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02272;</mml:mo><mml:mi>f</mml:mi><mml:mo>&#x02272;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Therefore <italic>f</italic> = 0.04 could be a reasonable starting value. If the number of particles per quadrat looks higher than 5, a new run with lower <italic>f</italic> is recommended. On the other hand if the resulting <italic>Q</italic> is low, <italic>f</italic> can be increased for a second run.</p></list-item><list-item><p>
<inline-formula id="pone.0206091.e028"><alternatives><graphic xlink:href="pone.0206091.e028.jpg" id="pone.0206091.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02273;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>&#x027f9;</mml:mo><mml:mi>f</mml:mi><mml:mo>&#x02272;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list><p>There is no upper limit for <italic>N</italic> with <italic>CountEm</italic>, since only <italic>Q</italic> and <italic>n</italic> are relevant for the resulting coefficient of error. <xref ref-type="fig" rid="pone.0206091.g004">Fig 4</xref> shows the approximately linear dependence of <inline-formula id="pone.0206091.e029"><alternatives><graphic xlink:href="pone.0206091.e029.jpg" id="pone.0206091.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mrow><mml:msubsup><mml:mtext>CE</mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with respect to <italic>Q</italic>. Counting more than <italic>Q</italic> = 200 particles is not worthwhile in most cases. <xref ref-type="fig" rid="pone.0206091.g005">Fig 5</xref> shows that doubling <italic>Q</italic> from 100 to 200 does only slightly reduce the error.</p></sec><sec sec-type="conclusions" id="sec010"><title>Conclusions</title><p><italic>CountEm</italic> describes an unbiased and efficient population size estimation method. It can be used irrespective of population size and pattern. It can be applied to humans, animals, or indeed to any kind of distinguishable particles. We have proposed new parameters to characterize the grid of quadrats, namely sampling fraction <italic>f</italic>, and initial number of quadrats, <italic>n</italic><sub>0</sub>. A crowd counting data set containing 51 images and corresponding position point patterns have been used to analyze the suitable parameter values and the resulting coefficients of error. Population size has been shown to have no impact on the coefficient of error of the estimation, only sample size, <italic>Q</italic>, and number of nonempty quadrats, <italic>n</italic>, are relevant. Usually <inline-formula id="pone.0206091.e030"><alternatives><graphic xlink:href="pone.0206091.e030.jpg" id="pone.0206091.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0206091.e031"><alternatives><graphic xlink:href="pone.0206091.e031.jpg" id="pone.0206091.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02273;</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, yield coefficients of error below 10%. The suitable parameter values depend on the order of magnitude of population size and spatial distribution. For the sizes and spatial distributions of our crowd counting dataset, <italic>n</italic><sub>0</sub> = 100 and <italic>f</italic> = 0.04 are reasonable initial values. We believe that the reparametrization defined here allows a more intuitive and fast choice and/or adjustment of the working parameters.</p></sec></body><back><ack><p>The authors acknowledge financial support from the AYA-2015-66357-R (MINECO/FEDER) project.</p></ack><ref-list><title>References</title><ref id="pone.0206091.ref001"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Jacobs</surname><given-names>H</given-names></name>. <article-title>To count a crowd</article-title>. <source>Columbia Journalism Review</source>. <year>1967</year>;<volume>6</volume>(<issue>1</issue>):<fpage>37</fpage>.</mixed-citation></ref><ref id="pone.0206091.ref002"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Watson</surname><given-names>R</given-names></name>, <name><surname>Yip</surname><given-names>P</given-names></name>. <article-title>How many were there when it mattered?</article-title>
<source>Significance</source>. <year>2011</year>;<volume>8</volume>(<issue>3</issue>):<fpage>104</fpage>&#x02013;<lpage>107</lpage>. <pub-id pub-id-type="doi">10.1111/j.1740-9713.2011.00502.x</pub-id></mixed-citation></ref><ref id="pone.0206091.ref003"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Sebasti&#x000e1;n-Gonz&#x000e1;lez</surname><given-names>E</given-names></name>, <name><surname>Green</surname><given-names>AJ</given-names></name>. <article-title>Reduction of avian diversity in created versus natural and restored wetlands</article-title>. <source>Ecography</source>. <year>2016</year>;<volume>39</volume>(<issue>12</issue>):<fpage>1176</fpage>&#x02013;<lpage>1184</lpage>. <pub-id pub-id-type="doi">10.1111/ecog.01736</pub-id></mixed-citation></ref><ref id="pone.0206091.ref004"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Zhao</surname><given-names>Q</given-names></name>, <name><surname>Silverman</surname><given-names>E</given-names></name>, <name><surname>Fleming</surname><given-names>K</given-names></name>, <name><surname>Boomer</surname><given-names>GS</given-names></name>. <article-title>Forecasting waterfowl population dynamics under climate change&#x02014;Does the spatial variation of density dependence and environmental effects matter?</article-title>
<source>Biological conservation</source>. <year>2016</year>;<volume>194</volume>:<fpage>80</fpage>&#x02013;<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.biocon.2015.12.006</pub-id></mixed-citation></ref><ref id="pone.0206091.ref005"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Hagy</surname><given-names>HM</given-names></name>, <name><surname>Hine</surname><given-names>CS</given-names></name>, <name><surname>Horath</surname><given-names>MM</given-names></name>, <name><surname>Yetter</surname><given-names>AP</given-names></name>, <name><surname>Smith</surname><given-names>RV</given-names></name>, <name><surname>Stafford</surname><given-names>JD</given-names></name>. <article-title>Waterbird response indicates floodplain wetland restoration</article-title>. <source>Hydrobiologia</source>. <year>2017</year>;<volume>804</volume>(<issue>1</issue>):<fpage>119</fpage>&#x02013;<lpage>137</lpage>. <pub-id pub-id-type="doi">10.1007/s10750-016-3004-3</pub-id></mixed-citation></ref><ref id="pone.0206091.ref006"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Kingsford</surname><given-names>RT</given-names></name>, <name><surname>Bino</surname><given-names>G</given-names></name>, <name><surname>Porter</surname><given-names>JL</given-names></name>. <article-title>Continental impacts of water development on waterbirds, contrasting two Australian river basins: Global implications for sustainable water use</article-title>. <source>Global change biology</source>. <year>2017</year>;<volume>23</volume>(<issue>11</issue>):<fpage>4958</fpage>&#x02013;<lpage>4969</lpage>. <pub-id pub-id-type="doi">10.1111/gcb.13743</pub-id>
<pub-id pub-id-type="pmid">28578561</pub-id></mixed-citation></ref><ref id="pone.0206091.ref007"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Chabot</surname><given-names>D</given-names></name>, <name><surname>Craik</surname><given-names>SR</given-names></name>, <name><surname>Bird</surname><given-names>DM</given-names></name>. <article-title>Population census of a large common tern colony with a small unmanned aircraft</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e0122588</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0122588</pub-id>
<pub-id pub-id-type="pmid">25874997</pub-id></mixed-citation></ref><ref id="pone.0206091.ref008"><label>8</label><mixed-citation publication-type="journal">
<name><surname>McEvoy</surname><given-names>JF</given-names></name>, <name><surname>Hall</surname><given-names>GP</given-names></name>, <name><surname>McDonald</surname><given-names>PG</given-names></name>. <article-title>Evaluation of unmanned aerial vehicle shape, flight path and camera type for waterfowl surveys: disturbance effects and species recognition</article-title>. <source>PeerJ</source>. <year>2016</year>;<volume>4</volume>:<fpage>e1831</fpage>
<pub-id pub-id-type="doi">10.7717/peerj.1831</pub-id>
<pub-id pub-id-type="pmid">27020132</pub-id></mixed-citation></ref><ref id="pone.0206091.ref009"><label>9</label><mixed-citation publication-type="book">
<name><surname>Lempitsky</surname><given-names>V</given-names></name>, <name><surname>Zisserman</surname><given-names>A</given-names></name>. <chapter-title>Learning To Count Objects in Images</chapter-title> In: <source>Advances in Neural Information Processing Systems</source>; <year>2010</year> p. <fpage>1324</fpage>&#x02013;<lpage>1332</lpage>.</mixed-citation></ref><ref id="pone.0206091.ref010"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Descamps</surname><given-names>S</given-names></name>, <name><surname>B&#x000e9;chet</surname><given-names>A</given-names></name>, <name><surname>Descombes</surname><given-names>X</given-names></name>, <name><surname>Arnaud</surname><given-names>A</given-names></name>, <name><surname>Zerubia</surname><given-names>J</given-names></name>. <article-title>An automatic counter for aerial images of aggregations of large birds</article-title>. <source>Bird study</source>. <year>2011</year>;<volume>58</volume>(<issue>3</issue>):<fpage>302</fpage>&#x02013;<lpage>308</lpage>. <pub-id pub-id-type="doi">10.1080/00063657.2011.588195</pub-id></mixed-citation></ref><ref id="pone.0206091.ref011"><label>11</label><mixed-citation publication-type="other">Rodriguez M, Laptev I, Sivic J, Audibert JY. Density-aware person detection and tracking in crowds. In: 2011 International Conference on Computer Vision; 2011. p. 2423&#x02013;2430.</mixed-citation></ref><ref id="pone.0206091.ref012"><label>12</label><mixed-citation publication-type="other">Idrees H, Saleemi I, Seibert C, Shah M. Multi-Source Multi-Scale Counting in Extremely Dense Crowd Images. In: IEEE Conference on Computer Vision and Pattern Recognition (CVPR). IEEE; 2013. p. 2547&#x02013;2554.</mixed-citation></ref><ref id="pone.0206091.ref013"><label>13</label><mixed-citation publication-type="journal">
<name><surname>Botta</surname><given-names>F</given-names></name>, <name><surname>Moat</surname><given-names>HS</given-names></name>, <name><surname>Preis</surname><given-names>T</given-names></name>. <article-title>Quantifying crowd size with mobile phone and Twitter data</article-title>. <source>Royal Society Open Science</source>. <year>2015</year>;<volume>2</volume>(<issue>5</issue>):<fpage>150162</fpage>
<pub-id pub-id-type="doi">10.1098/rsos.150162</pub-id>
<pub-id pub-id-type="pmid">26064667</pub-id></mixed-citation></ref><ref id="pone.0206091.ref014"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Torney</surname><given-names>CJ</given-names></name>, <name><surname>Dobson</surname><given-names>AP</given-names></name>, <name><surname>Borner</surname><given-names>F</given-names></name>, <name><surname>Lloyd-Jones</surname><given-names>DJ</given-names></name>, <name><surname>Moyer</surname><given-names>D</given-names></name>, <name><surname>Maliti</surname><given-names>HT</given-names></name>, <etal>et al</etal>
<article-title>Assessing Rotation-Invariant Feature Classification for Automated Wildebeest Population Counts</article-title>. <source>PLOS ONE</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>1</fpage>&#x02013;<lpage>10</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0156342</pub-id></mixed-citation></ref><ref id="pone.0206091.ref015"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Chabot</surname><given-names>D</given-names></name>, <name><surname>Francis</surname><given-names>CM</given-names></name>. <article-title>Computer-automated bird detection and counts in high-resolution aerial images: a review</article-title>. <source>Journal of Field Ornithology</source>. <year>2016</year>;<volume>87</volume>(<issue>4</issue>):<fpage>343</fpage>&#x02013;<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1111/jofo.12171</pub-id></mixed-citation></ref><ref id="pone.0206091.ref016"><label>16</label><mixed-citation publication-type="other">Zhang S, Benenson R, Omran M, Hosang J, Schiele B. How far are we from solving pedestrian detection? In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition; 2016. p. 1259&#x02013;1267.</mixed-citation></ref><ref id="pone.0206091.ref017"><label>17</label><mixed-citation publication-type="journal">
<name><surname>Cruz</surname><given-names>M</given-names></name>, <name><surname>G&#x000f3;mez</surname><given-names>D</given-names></name>, <name><surname>Cruz-Orive</surname><given-names>LM</given-names></name>. <article-title>Efficient and Unbiased Estimation of Population Size</article-title>. <source>PLOS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>1</fpage>&#x02013;<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0141868</pub-id></mixed-citation></ref><ref id="pone.0206091.ref018"><label>18</label><mixed-citation publication-type="book">
<name><surname>Howard</surname><given-names>CV</given-names></name>, <name><surname>Reed</surname><given-names>MG</given-names></name>. <chapter-title>Unbiased Stereology</chapter-title>
<source>Three-dimensional Measurement in Microscopy</source>. <edition>2nd ed</edition>
<publisher-loc>Oxford</publisher-loc>: <publisher-name>Bios/ Taylor &#x00026; Francis</publisher-name>; <year>2005</year>.</mixed-citation></ref><ref id="pone.0206091.ref019"><label>19</label><mixed-citation publication-type="journal">
<name><surname>Cruz-Orive</surname><given-names>L</given-names></name>. <article-title>STEREOLOGY: A HISTORICAL SURVEY</article-title>. <source>Image Analysis &#x00026; Stereology</source>. <year>2017</year>;<volume>36</volume>(<issue>3</issue>):<fpage>153</fpage>&#x02013;<lpage>177</lpage>. <pub-id pub-id-type="doi">10.5566/ias.1767</pub-id></mixed-citation></ref><ref id="pone.0206091.ref020"><label>20</label><mixed-citation publication-type="journal">
<name><surname>Gundersen</surname><given-names>HJG</given-names></name>. <article-title>Notes on the estimation of the numerical density of arbitrary profiles: the edge effect</article-title>. <source>J Microsc</source>. <year>1977</year>;<volume>111</volume>(<issue>2</issue>):<fpage>219</fpage>&#x02013;<lpage>223</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-2818.1977.tb00062.x</pub-id></mixed-citation></ref><ref id="pone.0206091.ref021"><label>21</label><mixed-citation publication-type="journal">
<name><surname>Gundersen</surname><given-names>HJG</given-names></name>, <name><surname>Jensen</surname><given-names>EBV</given-names></name>, <name><surname>Ki&#x000ea;u</surname><given-names>K</given-names></name>, <name><surname>Nielsen</surname><given-names>J</given-names></name>. <article-title>The efficiency of systematic sampling in stereology&#x02014;reconsidered</article-title>. <source>J Microsc</source>. <year>1999</year>;<volume>193</volume>(<issue>3</issue>):<fpage>199</fpage>&#x02013;<lpage>211</lpage>. <pub-id pub-id-type="doi">10.1046/j.1365-2818.1999.00457.x</pub-id>
<pub-id pub-id-type="pmid">10348656</pub-id></mixed-citation></ref><ref id="pone.0206091.ref022"><label>22</label><mixed-citation publication-type="book">
<name><surname>Baddeley</surname><given-names>A</given-names></name>, <name><surname>Rubak</surname><given-names>E</given-names></name>, <name><surname>Turner</surname><given-names>R</given-names></name>. <source>Spatial Point Patterns: Methodology and Applications with R</source>. <publisher-name>CRC Press</publisher-name>; <year>2015</year>.</mixed-citation></ref></ref-list></back></article>
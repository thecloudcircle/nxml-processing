
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">25494997</article-id><article-id pub-id-type="pmc">4268903</article-id><article-id pub-id-type="publisher-id">382</article-id><article-id pub-id-type="doi">10.1186/s12859-014-0382-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Masking as an effective quality control method for next-generation sequencing data analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yun</surname><given-names>Sajung</given-names></name><address><email>syun@hawaii.edu</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Yun</surname><given-names>Sijung</given-names></name><address><email>yuns@mail.nih.gov</email></address><xref ref-type="aff" rid="Aff2"/></contrib><aff id="Aff1"><label/>John A. Burns School of Medicine, University of Hawai&#x02018;i at Manoa, Honolulu, HI USA </aff><aff id="Aff2"><label/>Laboratory of Molecular Biology, National Institute of Diabetes and Digestive and Kidney Diseases, National Institutes of Health, Bethesda, MD USA </aff></contrib-group><pub-date pub-type="epub"><day>13</day><month>12</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>12</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>15</volume><issue>1</issue><elocation-id>382</elocation-id><history><date date-type="received"><day>11</day><month>3</month><year>2014</year></date><date date-type="accepted"><day>10</day><month>11</month><year>2014</year></date></history><permissions><copyright-statement>&#x000a9; Yun and Yun; licensee BioMed Central Ltd. 2014</copyright-statement><license license-type="open-access"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Next generation sequencing produces base calls with low quality scores that can affect the accuracy of identifying simple nucleotide variation calls, including single nucleotide polymorphisms and small insertions and deletions. Here we compare the effectiveness of two data preprocessing methods, masking and trimming, and the accuracy of simple nucleotide variation calls on whole-genome sequence data from <italic>Caenorhabditis elegans</italic>. Masking substitutes low quality base calls with &#x02018;N&#x02019;s (undetermined bases), whereas trimming removes low quality bases that results in a shorter read lengths.</p></sec><sec><title>Results</title><p>We demonstrate that masking is more effective than trimming in reducing the false-positive rate in single nucleotide polymorphism (SNP) calling. However, both of the preprocessing methods did not affect the false-negative rate in SNP calling with statistical significance compared to the data analysis without preprocessing. False-positive rate and false-negative rate for small insertions and deletions did not show differences between masking and trimming.</p></sec><sec><title>Conclusions</title><p>We recommend masking over trimming as a more effective preprocessing method for next generation sequencing data analysis since masking reduces the false-positive rate in SNP calling without sacrificing the false-negative rate although trimming is more commonly used currently in the field. The perl script for masking is available at <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/subn/">http://code.google.com/p/subn/</ext-link>. The sequencing data used in the study were deposited in the Sequence Read Archive (SRX450968 and SRX451773).</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>NGS</kwd><kwd>Preprocessing</kwd><kwd>Masking</kwd><kwd>Trimming</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2014</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Background</title><p>Research and clinical applications of next generation sequencing (NGS) have been widely accepted as useful and sensitive approaches for detecting genetic variants. Accurate base calling is key to this discovery tool because both false-negative and false-positive calls may complicate the interpretation of the data with respect to causative mutations. However, the raw data obtained from NGS is known to contain some low quality base calls for which no consensus has been reached about their proper interpretation. Bioinformatic quality control methods have been introduced into NGS analysis pipeline to increase the accuracy of simple nucleotide variation (SNV) calls that include single nucleotide polymorphism (SNP) and insertion and deletion (indel).</p><p>Trimming is a commonly used bioinformatic quality control method for base calls with low quality. It deletes base calls in a NGS read such that there remains a contiguous string of bases with quality scores above a user defined cutoff threshold or until the average quality of the remaining reads falls below the threshold value. The software programs available for trimming include Btrim [<xref ref-type="bibr" rid="CR1">1</xref>], ConDeTri [<xref ref-type="bibr" rid="CR2">2</xref>], FASTQ quality trimmer in Galaxy [<xref ref-type="bibr" rid="CR3">3</xref>], SeqTrim [<xref ref-type="bibr" rid="CR4">4</xref>], and SolexaQA [<xref ref-type="bibr" rid="CR5">5</xref>]. In contrast, masking substitutes low quality base calls with an &#x02018;N&#x02019;, an undetermined base though it is not widely used compared to trimming. Software programs available for masking include FASTQ Masker in Galaxy [<xref ref-type="bibr" rid="CR3">3</xref>], and FASTX Toolkit [<xref ref-type="bibr" rid="CR6">6</xref>]. Recently, Liu et al. showed that trimming introduced lots of false-positives and they noted that it is necessary to have more efficient bioinformatics algorithm for NGS data preprocessing [<xref ref-type="bibr" rid="CR7">7</xref>]. Here we evaluated the effectiveness of trimming and masking by performing DNA whole-genome sequencing in <italic>Caenorhabditis elegans</italic> (<italic>C. elegans</italic>). The analysis showed that masking reduced the false-positive rate without increasing the false-negative rate with statistical significance. However, trimming was not as effective as masking in reducing the false-positive rate.</p></sec><sec id="Sec2" sec-type="materials|methods"><title>Methods</title><sec id="Sec3"><title>Experimental design</title><p>To evaluate the false-positive rate, we performed DNA-seq on a <italic>C. elegans</italic> strain that was mutagenized by ethyl methanesulfonate (EMS) and then verified the DNA-seq prediction by Sanger sequencing. To evaluate the false-negative rate, we sequenced a Hawaiian <italic>C. elegans</italic> strain and verified our SNP predictions by comparing them to the publicly available Hawaiian SNP data from Wormbase (WS220) [<xref ref-type="bibr" rid="CR8">8</xref>]. This allowed us to compare the performance of trimming vs. masking to set a standard for quality control in next generation sequencing data analysis.</p></sec><sec id="Sec4"><title>Sequencing</title><p>We performed 76&#x000a0;cycle single-end sequencing on the <italic>C. elegans</italic> samples using Illumina&#x02019;s HiSeq 2000. We obtained 27,528,260 reads and 49,699,895 reads for the EMS mutagenized and the Hawaiian strain, respectively, after the default filtering. These corresponded to ~22 fold and ~39 fold genome coverage, respectively. A schematic diagram for data analysis pipeline is shown in Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Figure 1</label><caption><p>
<bold>A schematic diagram for data analysis pipeline.</bold>
</p></caption><graphic xlink:href="12859_2014_382_Fig1_HTML" id="MO1"/></fig></p></sec><sec id="Sec5"><title>Preprocessing and alignments</title><p>Raw reads were trimmed or masked using SolexaQA [<xref ref-type="bibr" rid="CR5">5</xref>] and SubN [<xref ref-type="bibr" rid="CR9">9</xref>] for each. SubN was developed in house, available for public, simple and small (less than 200 lines), and easy to use if PERL is pre-installed. Raw, trimmed, or masked FASTQ files were aligned to the <italic>C. elegans</italic> genome, version WS220, using BWA (version 0.6.2-r126) [<xref ref-type="bibr" rid="CR10">10</xref>] or BOWTIE2 (version 2.1.0) [<xref ref-type="bibr" rid="CR11">11</xref>] with default parameters as indicated in the publications cited. We used two aligners to address the dependence of SNV calling on a particular choice of an aligner.</p></sec><sec id="Sec6"><title>Variant calling</title><p>SNV calling was performed with the haplotype caller in GATK (version2.7-2) package [<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref>] and ANNOVAR (version 2011-11-20) [<xref ref-type="bibr" rid="CR14">14</xref>] was used to annotate missense SNPs. We focused on missense SNPs in evaluating the accuracy of SNP calling because they may have immediate biomedical applicability. For the EMS mutagenized strain, we found 172&#x02009;~&#x02009;221 homozygous missense SNPs, depending on the aligner and the quality control method used. Then, we checked the SNP and indel predictions to Sanger sequencing result; we performed Sanger sequencing on 145 SNV candidates in exonic region, and obtained 37 positive SNPs, 86 negative SNPs, and 22 Sanger verified indels. Variant calling has a strong dependence on program parameter settings as well as the interfacing tools in the entire analysis pipeline, as recently reported by both O&#x02019;Rawe et al. and Yu et al. [<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>]. Surveying the influence of all possible combinations of parameter values was beyond the scope of the current study and instead we used the recommended default parameter settings, unless otherwise specified.</p></sec><sec id="Sec7"><title>Details on parameters and statistical methods</title><p>For the cutoff quality score of trimming or masking, we chose the 1% probability of error, which corresponded to a PHRED score of 20. We used the default value of 25 bases as the minimum length of reads to be kept for trimming. The false-positive rate was calculated as the number of false-positives divided by the total number of validated negatives, i.e. sum of false-positives and true-negatives. To decide whether these differences are statistically significant for the false-positives, we used Fisher&#x02019;s exact test using R-package (version 3.0.1) [<xref ref-type="bibr" rid="CR17">17</xref>] based on 2 &#x000d7; 2 contingency table of false-positives and true-negatives. We avoided using &#x003c7;<sup>2</sup> test for the false-positives because some values were smaller than five. The false-negative rate was calculated as the number of false-negatives divided by the sum of false-negatives and true-positives. Duplicate removal was performed with MarkDuplicates tool in Picard tools, version 1.75 [<xref ref-type="bibr" rid="CR18">18</xref>].</p></sec></sec><sec id="Sec8" sec-type="results"><title>Results and discussion</title><sec id="Sec9"><title>Trimming and masking on alignments</title><p>The total number of reads was decreased with trimming by 7.1% from 27,528,260 reads to 25,570,162 reads (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). It is because of the dynamic trimming algorithm; first, it identified the longest contiguous stretch of bases whose error rate is smaller than 1% for all the bases. If the number of bases in the stretch was smaller than 25, the read was discarded to avoid the mapping error. However, masking did not change the total number of reads as expected. BWA and BOWTIE2 aligned 93.9% and 97.3% of reads, for each, compared to the total number of raw reads. Trimming resulted in slightly smaller number of reads aligned, 91.2% for BWA and 91.9% for BOWTIE2. However, masking resulted in much smaller number of reads aligned, 82.2% for BWA and 88.7% for BOWTIE2. Aligning more reads that contain low quality base calls is not necessarily desirable because mis-alignments or errors in base calls could result in errors in SNP calling. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> shows a typical example of alignments on how trimming or masking affects alignment of reads in a region where quality scores are low. A base in a blue or a green color denotes its error rate is higher than 1%. These low quality bases were trimmed off with trimming or masked as &#x02018;n&#x02019; with masking.<table-wrap id="Tab1"><label>Table 1</label><caption><p>
<bold>The number of reads and percentage attained after quality control and/or alignment</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th rowspan="2">
<bold>Aligners</bold>
</th><th>
<bold><italic>No quality control</italic></bold>
</th><th>
<bold><italic>Trimming</italic></bold>
</th><th>
<bold><italic>Masking</italic></bold>
</th></tr><tr valign="top"><th>
<bold>27,528,260</bold>
</th><th>
<bold>25,570,162 (92.9%)</bold>
</th><th>
<bold>27,528,260 (100%)</bold>
</th></tr></thead><tbody><tr valign="top"><td>BWA</td><td>25,843,686 (93.9%)</td><td>25,113,197 (91.2%)</td><td>22,617,992 (82.2%)</td></tr><tr valign="top"><td>BOWTIE2</td><td>26,784,763 (97.3%)</td><td>25,286,787 (91.9%)</td><td>24,415,121 (88.7%)</td></tr></tbody></table><table-wrap-foot><p>The percentage is calculated to the number reads with no quality control.</p></table-wrap-foot></table-wrap><fig id="Fig2"><label>Figure 2</label><caption><p>
<bold>A typical example of alignments with trimming or masking in respect to no quality control in a region where read quality scores are poor.</bold> The top, the second, and the third line in an alignment picture shows base pair position, the reference genome sequence, and the consensus sequence, for each. A base call that matches the reference sequence is denoted as a dot for the forward strand or as a comma for the reverse strand. The colors in a read denote the base call quality. White is for a base with its error rate smaller than 0.1%, yellow for 0.1&#x02009;~&#x02009;1% error rate, green for 1&#x02009;~&#x02009;10% error rate, and blue for 10% or greater error rate. Since we used 1% cutoff, all the green and the blue were either trimmed off or masked as &#x02018;N&#x02019; or &#x02018;n&#x02019;. The graphics were made using tview in Samtools (version 0.1.18) [<xref ref-type="bibr" rid="CR19">19</xref>]. BOWTIE2 was used to align reads.</p></caption><graphic xlink:href="12859_2014_382_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec10"><title>False-positive rate</title><p>Masking reduced the false-positive rate in SNP calling compared to no quality control for both BWA and BOWTIE2 (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). The false-positive rate dropped from 2.3% to 0% for BWA, and from 7.0% to 0% for BOWTIE2. The p-values for the null-hypothesis were 0.25 and 0.014 for BWA and for BOWTIE2, for each. Therefore, we concluded that masking reduced the false-positive rate with statistical significance for BOWTIE2. Though false-positives rate was decreased for BWA from 2.3% to 0%, it was not statistically significant enough with our 86 Sanger negative SNPs because the number of false-positives with BWA was already too small with no quality control. However, trimming did not decrease the false-positive rate for BWA. Even for BOWTIE2, the decrease in the false-positive rate with trimming was not statistically significant (p-value 0.14). Hence, we conclude that masking is more effective than trimming in reducing the false-positive rate. Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows an example of a false-positive SNP calling at chromosome X: 6,846,313 with no quality control and trimming, but a true-negative SNP calling with masking; no quality control and trimming falsely predicted it as a homozygous SNP whereas masking correctly predicted in both BWA and BOWTIE2; Sanger sequencing confirmed a reference base.<table-wrap id="Tab2"><label>Table 2</label><caption><p>
<bold>Number of true-positives, false-positives, true-negatives, and false-negatives in SNP verification by Sanger sequencing for no quality control vs. trimming vs. masking</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th rowspan="2">
<bold><italic>Aligners</italic></bold>
</th><th colspan="4">
<bold><italic>No quality control</italic></bold>
</th><th colspan="4">
<bold><italic>Trimming</italic></bold>
</th><th colspan="4">
<bold><italic>Masking</italic></bold>
</th></tr><tr valign="top"><th>
<bold>TP</bold>
</th><th>
<bold>FP</bold>
</th><th>
<bold>TN</bold>
</th><th>
<bold>FN</bold>
</th><th>
<bold>TP</bold>
</th><th>
<bold>FP</bold>
</th><th>
<bold>TN</bold>
</th><th>
<bold>FN</bold>
</th><th>
<bold>TP</bold>
</th><th>
<bold>FP</bold>
</th><th>
<bold>TN</bold>
</th><th>
<bold>FN</bold>
</th></tr></thead><tbody><tr valign="top"><td>BWA</td><td>35</td><td>2 (2.3%)</td><td>84</td><td>2</td><td>35</td><td>2 (2.3%)</td><td>84</td><td>2</td><td>35</td><td>0 (0%)</td><td>86</td><td>2</td></tr><tr valign="top"><td>BOWTIE2</td><td>35</td><td>6 (7.0%)</td><td>80</td><td>2</td><td>35</td><td>2 (2.3%)</td><td>84</td><td>2</td><td>35</td><td>0 (0%)</td><td>86</td><td>2</td></tr></tbody></table><table-wrap-foot><p>TP: True-Positive, FP: False-Positive, TN: True-Negative, FN: False-Negative. The value with parenthesis in the FP cell denotes the false-positive rate in percent.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Figure 3</label><caption><p>
<bold>An example of alignments near a false-positive SNP position with no quality control or with trimming. (a)</bold> no quality control &#x02013; BWA, <bold>(b)</bold> trimming &#x02013; BWA, <bold>(c)</bold> masking &#x02013; BWA, <bold>(d)</bold> no quality control &#x02013; BOWTIE2, <bold>(e)</bold> trimming &#x02013; BOWTIE2, and <bold>(f)</bold> masking &#x02013; BOWTIE2. The top, the second, and the third line in an alignment picture show a base pair position, the reference genome sequence, and the consensus sequence, for each. A base call that matches the reference sequence is denoted as a dot for the forward strand or as a comma for the reverse strand. The colors in a read denote the base call quality. White is for a base with its error rate smaller than 0.1%, yellow for 0.1&#x02009;~&#x02009;1% error rate, green for 1&#x02009;~&#x02009;10% error rate, and blue for 10% or greater error rate. Since we used 1% cutoff, all the green and the blue were either trimmed off or masked as &#x02018;N&#x02019; or &#x02018;n&#x02019;. The graphics were made using tview in Samtools (version 0.1.18) [<xref ref-type="bibr" rid="CR19">19</xref>]. BOWTIE2 was used to align reads. GATK haplotype SNP caller made false-positive homozygous SNP calling in <bold>(a)</bold>, <bold>(b)</bold>, <bold>(d)</bold>, and <bold>(e)</bold>, not in <bold>(c)</bold> and <bold>(f)</bold>.</p></caption><graphic xlink:href="12859_2014_382_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec11"><title>False-negative rate</title><p>Masking and trimming did not improve for the false-negative cases in our SNP (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>) and indel cases (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>) with the EMS induced mutant strains. There were two false-negative SNPs and two false-negative indels regardless of preprocessing methods and aligners. The two false-negative SNP cases were due to too few reads aligned in the region (Figures&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>) and removing bases of low qualities further did not help in reducing the false-negative rate in SNP calling.<table-wrap id="Tab3"><label>Table 3</label><caption><p>
<bold>The number of true-positives and false-negatives in indel verification by Sanger sequencing for no quality control vs. trimming vs. masking</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th rowspan="2">
<bold><italic>Aligners</italic></bold>
</th><th colspan="2">
<bold><italic>No quality control</italic></bold>
</th><th colspan="2">
<bold><italic>Trimming</italic></bold>
</th><th colspan="2">
<bold><italic>Masking</italic></bold>
</th></tr><tr valign="top"><th>
<bold>True- positive</bold>
</th><th>
<bold>False- negative</bold>
</th><th>
<bold>True- positive</bold>
</th><th>
<bold>False- negative</bold>
</th><th>
<bold>True- positive</bold>
</th><th>
<bold>False- negative</bold>
</th></tr></thead><tbody><tr valign="top"><td>BWA</td><td>20</td><td>2</td><td>20</td><td>2</td><td>20</td><td>2</td></tr><tr valign="top"><td>BOWTIE2</td><td>20</td><td>2</td><td>20</td><td>2</td><td>20</td><td>2</td></tr></tbody></table></table-wrap><fig id="Fig4"><label>Figure 4</label><caption><p>
<bold>Alignments for the first false-negative SNP at chromosome II:6,736,494. (a)</bold> no quality control &#x02013; BWA, <bold>(b)</bold> trimming &#x02013; BWA, <bold>(c)</bold> masking &#x02013; BWA, <bold>(d)</bold> no quality control &#x02013; BOWTIE2, <bold>(e)</bold> trimming &#x02013; BOWTIE2, and <bold>(f)</bold> masking &#x02013; BOWTIE2. See the Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> legend for details on coloring.</p></caption><graphic xlink:href="12859_2014_382_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Figure 5</label><caption><p>
<bold>Alignments for the second false-negative SNP at chromosome X:484,613. (a)</bold> no quality control &#x02013; BWA, <bold>(b)</bold> trimming &#x02013; BWA, <bold>(c)</bold> masking &#x02013; BWA, <bold>(d)</bold> no quality control &#x02013; BOWTIE2, <bold>(e)</bold> trimming &#x02013; BOWTIE2, and <bold>(f)</bold> masking &#x02013; BOWTIE2. See the Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> legend for details on coloring.</p></caption><graphic xlink:href="12859_2014_382_Fig5_HTML" id="MO5"/></fig></p><p>Therefore, to evaluate how trimming and masking affect on the false-negative rate that has enough cases of false-negatives, we sequenced a Hawaiian strain of <italic>C. elegans</italic> and compared our SNPs to Hawaiian SNPs from Wormbase (WS220). This Hawaiian strain has over 112&#x000a0;k SNPs compared to commonly used a Bristol wild-type strain (N2). We could identify 104,297 to 105,355 Hawaiian SNPs from the total of 112,061 Hawaiian SNPs, which were considered as true-positives (Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>). By setting the difference between the total number of Hawaiian SNPs and the true-positives as false-negatives, we determined the false-negative rates, which were from 6.0% to 6.9%. To determine the statistical significance with respect to preprocessing methods, we performed &#x003c7;<sup>2</sup> tests for both BWA and BOWTIE2. The p-values were 0.39 and 0.15, for BWA and BOWTIE2 respectively, which suggests that the differences between preprocessing methods were not statistically significant for these two methods in the false-negative rates.<table-wrap id="Tab4"><label>Table 4</label><caption><p>
<bold>The number of Hawaiian SNPs and the false-negative rate</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th>
<bold>Aligners</bold>
</th><th>
<bold><italic>No quality control</italic></bold>
</th><th>
<bold><italic>Trimming</italic></bold>
</th><th>
<bold><italic>Masking</italic></bold>
</th></tr></thead><tbody><tr valign="top"><td>BWA</td><td>104,858 (6.4%)</td><td>105,355 (6.0%)</td><td>104,775 (6.5%)</td></tr><tr valign="top"><td>BOWTIE2</td><td>104,422 (6.8%)</td><td>104,470 (6.8%)</td><td>104,297 (6.9%)</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec12"><title>Indels and other considerations</title><p>For a Sanger verified deletion of &#x02018;C&#x02019; at chromosome X:1,615,135, BWA and BOWTIE2 aligned the reads, but GATK haplotype caller did not call it as a deletion (Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>). For the other Sanger verified insertion, a 21 base insertion of &#x0201c;GATCTCCAATTACAATCAAAA&#x0201d; at chromosome I:6,066,249, it was not called because BWA and BOWTIE2 could not align the reads here (Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>). Removal of duplicates did not affect the results for trimming and masking for our Sanger verified SNPs. However, the number of false-positives decreased from 2 to 1 for BWA and from 6 to 3 for BOWTIE2 with no quality control.<fig id="Fig6"><label>Figure 6</label><caption><p>
<bold>Alignments for the first false-negative Indel at chromosome X:1,615,135. (a)</bold> no quality control &#x02013; BWA, <bold>(b)</bold> trimming &#x02013; BWA, <bold>(c)</bold> masking &#x02013; BWA, <bold>(d)</bold> no quality control &#x02013; BOWTIE2, <bold>(e)</bold> trimming &#x02013; BOWTIE2, and <bold>(f)</bold> masking &#x02013; BOWTIE2. See the Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> legend for details on coloring. Sanger sequencing identified the deletion of &#x02018;C&#x02019;.</p></caption><graphic xlink:href="12859_2014_382_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Figure 7</label><caption><p>
<bold>Alignments for the second false-negative Indel at chromosome I:6,066,249. (a)</bold> no quality control &#x02013; BWA, <bold>(b)</bold> trimming &#x02013; BWA, <bold>(c)</bold> masking &#x02013; BWA, <bold>(d)</bold> no quality control &#x02013; BOWTIE2, <bold>(e)</bold> trimming &#x02013; BOWTIE2, and <bold>(f)</bold> masking &#x02013; BOWTIE2. See the Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> legend for details on coloring.</p></caption><graphic xlink:href="12859_2014_382_Fig7_HTML" id="MO7"/></fig></p><p>To determine if the reduced false positive rate observed with preprocessing using masking or trimming was dependent on the alignment tool, we repeated the analysis using the local alignment mode within BOWTIE2 (option &#x0201c;--local&#x0201d;). The false positive rates did not change for either trimming or masking using the local compared to global alignment modes (Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>). We did note that in the absence of preprocessing (no quality control), the false positive rate with the local alignment decreased slightly compared to the global alignment, from 7.0% to 5.8%, consistent with more accurate alignment. The reason for only a slight decrease in the false positive rate is because base call errors due to low quality scores prevent alignment even when using the more accurate local alignment mode. Preprocessing steps that remove these errant, low quality base calls improve the false positive rates. Trimming may eliminate one or more high quality base calls in the process and the reduced size of the total read length may increase the chance of misalignment. In contrast, masking saves all the high quality base calls in a read, making it more effective than trimming in reducing the false positive rate.<table-wrap id="Tab5"><label>Table 5</label><caption><p>
<bold>The false positive rates with global alignment vs. local alignment</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th/><th>
<bold><italic>No quality control</italic></bold>
</th><th>
<bold><italic>Trimming</italic></bold>
</th><th>
<bold><italic>Masking</italic></bold>
</th></tr></thead><tbody><tr valign="top"><td>
<bold>Global alignment</bold>
</td><td>7.0%</td><td>2.3%</td><td>0%</td></tr><tr valign="top"><td>
<bold>Local alignment</bold>
</td><td>5.8%</td><td>2.3%</td><td>0%</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec13" sec-type="conclusion"><title>Conclusions</title><p>The reason why masking performs better than trimming and no quality control in reducing the false-positive rate is apparent because masking maximizes the information content of a raw read while removing the base calls with low qualities. However, masking did not improve for the false-negative calls due to a low coverage. Therefore, we recommend masking as a preprocessing method to remove low quality base calls in NGS since it reduces the false-positive rate without sacrificing the false-negative rate. Masking could be used effectively in reducing the false-positive rate also for the identification of somatic mutations in cancer screening by RNA-seq. The perl script for masking is available at <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/subn/">http://code.google.com/p/subn/</ext-link>.</p></sec></body><back><fn-group><fn><p><bold>Competing interests</bold></p><p>The authors declare that they have no competing interests.</p></fn><fn><p><bold>Authors&#x02019; contributions</bold></p><p>Sajung Yun and Sijung Yun contributed equally for this work except for the Sanger validation that was done by Sijung Yun. Both authors read and approved the final manuscript.</p></fn></fn-group><ack><title>Acknowledgements</title><p>We are grateful to Michael Krause, Harold Smith, Tetsu Fukushige, and Matt Shirley for their constructive comments. We thank the NIDDK Genomics Core Laboratory for generating the sequence data. This paper is subject to the NIH Public Access Policy.</p><sec id="d30e1204"><title>Funding</title><p>The work was supported by the Intramural Research Program of the National Institutes of Health (NIH), National Institute of Diabetes and Digestive and Kidney Diseases (Sijung Yun).</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kong</surname><given-names>Y</given-names></name></person-group><article-title>Btrim: a fast, lightweight adapter and quality trimming program for next-generation sequencing technologies</article-title><source>Genomics</source><year>2011</year><volume>98</volume><fpage>152</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1016/j.ygeno.2011.05.009</pub-id><pub-id pub-id-type="pmid">21651976</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smeds</surname><given-names>L</given-names></name><name><surname>Kunstner</surname><given-names>A</given-names></name></person-group><article-title>ConDeTri&#x02013;a content dependent read trimmer for Illumina data</article-title><source>PLoS One</source><year>2011</year><volume>6</volume><fpage>e26314</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0026314</pub-id><pub-id pub-id-type="pmid">22039460</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankenberg</surname><given-names>D</given-names></name><name><surname>Gordon</surname><given-names>A</given-names></name><name><surname>Von Kuster</surname><given-names>G</given-names></name><name><surname>Coraor</surname><given-names>N</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Nekrutenko</surname><given-names>A</given-names></name></person-group><article-title>Manipulation of FASTQ data with galaxy</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>1783</fpage><lpage>1785</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq281</pub-id><pub-id pub-id-type="pmid">20562416</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falgueras</surname><given-names>J</given-names></name><name><surname>Lara</surname><given-names>AJ</given-names></name><name><surname>Fernandez-Pozo</surname><given-names>N</given-names></name><name><surname>Canton</surname><given-names>FR</given-names></name><name><surname>Perez-Trabado</surname><given-names>G</given-names></name><name><surname>Claros</surname><given-names>MG</given-names></name></person-group><article-title>SeqTrim: a high-throughput pipeline for pre-processing any type of sequence read</article-title><source>BMC Bioinform</source><year>2010</year><volume>11</volume><fpage>38</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-38</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>MP</given-names></name><name><surname>Peterson</surname><given-names>DA</given-names></name><name><surname>Biggs</surname><given-names>PJ</given-names></name></person-group><article-title>SolexaQA: At-a-glance quality assessment of Illumina second-generation sequencing data</article-title><source>BMC Bioinform</source><year>2010</year><volume>11</volume><fpage>485</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-485</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other"><bold>FASTX Toolkit</bold> [<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/index.html">http://hannonlab.cshl.edu/fastx_toolkit/index.html</ext-link>]</mixed-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Long</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Shyr</surname><given-names>Y</given-names></name></person-group><article-title>Steps to ensure accuracy in genotype and SNP calling from Illumina sequencing data</article-title><source>BMC Genomics</source><year>2012</year><volume>13</volume><issue>8</issue><fpage>S8</fpage><pub-id pub-id-type="pmid">23281772</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other"><bold>WormBase</bold> [<ext-link ext-link-type="uri" xlink:href="http://ws220.wormbase.org/">http://ws220.wormbase.org</ext-link>]</mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other"><bold>SubN</bold> [<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/subn/">http://code.google.com/p/subn/</ext-link>]</mixed-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>1754</fpage><lpage>1760</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><pub-id pub-id-type="pmid">19451168</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Garimella</surname><given-names>KV</given-names></name><name><surname>Maguire</surname><given-names>JR</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>del Angel</surname><given-names>G</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>TJ</given-names></name><name><surname>Kernytsky</surname><given-names>AM</given-names></name><name><surname>Sivachenko</surname><given-names>AY</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Sivachenko</surname><given-names>A</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Kernytsky</surname><given-names>A</given-names></name><name><surname>Garimella</surname><given-names>K</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>M</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name></person-group><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><fpage>1297</fpage><lpage>1303</lpage><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><pub-id pub-id-type="pmid">20644199</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Hakonarson</surname><given-names>H</given-names></name></person-group><article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title><source>Nucleic Acids Res</source><year>2010</year><volume>38</volume><fpage>e164</fpage><pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id><pub-id pub-id-type="pmid">20601685</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Rawe</surname><given-names>J</given-names></name><name><surname>Jiang</surname><given-names>T</given-names></name><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Bodily</surname><given-names>P</given-names></name><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Hakonarson</surname><given-names>H</given-names></name><name><surname>Johnson</surname><given-names>WE</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Lyon</surname><given-names>GJ</given-names></name></person-group><article-title>Low concordance of multiple variant-calling pipelines: practical implications for exome and genome sequencing</article-title><source>Genome Med</source><year>2013</year><volume>5</volume><fpage>28</fpage><pub-id pub-id-type="doi">10.1186/gm432</pub-id><pub-id pub-id-type="pmid">23537139</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>X</given-names></name><name><surname>Sun</surname><given-names>S</given-names></name></person-group><article-title>Comparing a few SNP calling algorithms using low-coverage sequencing data</article-title><source>BMC Bioinform</source><year>2013</year><volume>14</volume><fpage>274</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-274</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">R Core Team (2013): R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. URL <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.R-project.org/</ext-link>.</mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other"><bold>PICARD version 1.75</bold> [<ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net/">http://picard.sourceforge.net</ext-link>]</mixed-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>The sequence alignment/Map format and SAMtools</article-title><source>Bioinform</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id></element-citation></ref></ref-list></back></article>
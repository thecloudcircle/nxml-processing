
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">26250107</article-id><article-id pub-id-type="pmc">4918346</article-id><article-id pub-id-type="pii">ncomms8913</article-id><article-id pub-id-type="doi">10.1038/ncomms8913</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Experimental superposition of orders of quantum gates</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Procopio</surname><given-names>Lorenzo M.</given-names></name><xref ref-type="corresp" rid="c1">a</xref><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Moqanaki</surname><given-names>Amir</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ara&#x000fa;jo</surname><given-names>Mateus</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a2">2</xref></contrib><contrib contrib-type="author"><name><surname>Costa</surname><given-names>Fabio</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a2">2</xref><xref ref-type="author-notes" rid="n1">*</xref></contrib><contrib contrib-type="author"><name><surname>Alonso Calafell</surname><given-names>Irati</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Dowd</surname><given-names>Emma G.</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n2">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Hamel</surname><given-names>Deny R.</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n3">&#x02021;</xref><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4788-7548</contrib-id></contrib><contrib contrib-type="author"><name><surname>Rozema</surname><given-names>Lee A.</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Brukner</surname><given-names>&#x0010c;aslav</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a2">2</xref></contrib><contrib contrib-type="author"><name><surname>Walther</surname><given-names>Philip</given-names></name><xref ref-type="corresp" rid="c2">b</xref><xref ref-type="aff" rid="a1">1</xref></contrib><aff id="a1"><label>1</label><institution>Faculty of Physics, University of Vienna</institution>, Boltzmanngasse 5, Vienna A-1090, <country>Austria</country></aff><aff id="a2"><label>2</label><institution>Institute for Quantum Optics and Quantum Information, Austrian Academy of Sciences</institution>, Boltzmanngasse 3, Vienna A-1090, <country>Austria</country></aff></contrib-group><author-notes><corresp id="c1"><label>a</label><email>lorenzo.procopio@univie.ac.at</email></corresp><corresp id="c2"><label>b</label><email>philip.walther@univie.ac.at</email></corresp><fn id="n1"><label>*</label><p>Present address: Centre for Engineered Quantum Systems, School of Mathematics and Physics, The University of Queensland, St Lucia, QLD 4072, Australia</p></fn><fn id="n2"><label>&#x02020;</label><p>Present address: Department of Physics, Harvard University, Cambridge, MA</p></fn><fn id="n3"><label>&#x02021;</label><p>Present address: D&#x000e9;partement de physique et d'astronomie, Universit&#x000e9; de Moncton, Moncton, New Brunswick E1A 3E9, Canada</p></fn></author-notes><pub-date pub-type="epub"><day>07</day><month>08</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>6</volume><elocation-id>7913</elocation-id><history><date date-type="received"><day>11</day><month>02</month><year>2015</year></date><date date-type="accepted"><day>22</day><month>06</month><year>2015</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2015, Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-holder><license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><!--author-paid--><license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions><abstract><p>Quantum computers achieve a speed-up by placing quantum bits (qubits) in superpositions of different states. However, it has recently been appreciated that quantum mechanics also allows one to &#x02018;superimpose different operations'. Furthermore, it has been shown that using a qubit to coherently control the gate order allows one to accomplish a task&#x02014;determining if two gates commute or anti-commute&#x02014;with fewer gate uses than any known quantum algorithm. Here we experimentally demonstrate this advantage, in a photonic context, using a second qubit to control the order in which two gates are applied to a first qubit. We create the required superposition of gate orders by using additional degrees of freedom of the photons encoding our qubits. The new resource we exploit can be interpreted as a superposition of causal orders, and could allow quantum algorithms to be implemented with an efficiency unlikely to be achieved on a fixed-gate-order quantum computer.</p></abstract><abstract abstract-type="web-summary"><p>
<inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="i1" xlink:href="ncomms8913-i1.jpg"/>It has been conjectured that not only states but also quantum operations can be placed in a superposition of causal order. Here, the authors use a qubit superpose the order in which two photonic gates are applied, which is shown to enable a more efficient detection of their commutation relations.</p></abstract></article-meta></front><body><p>Quantum mechanics has long been recognized as a counter-intuitive theory, with ideas such as wave-particle duality, quantum superposition and entanglement defying our natural way of thinking. In recent years, these sorts of uniquely quantum properties are being exploited to develop revolutionary technologies, such as quantum cryptography, quantum metrology and perhaps the most well-known example, quantum computation. In the field of quantum computation, the circuit model was used to show that universal quantum computation is possible<xref ref-type="bibr" rid="b1">1</xref>, and the circuit model has since been an incredibly successful tool, leading to important quantum algorithms which greatly outperform their classical counterparts<xref ref-type="bibr" rid="b2">2</xref>. The circuit model takes advantage of the fact that quantum mechanics allows for the superposition and interference of quantum bits (qubits) in different states to achieve a computational speed-up. However, in addition to the superpositions of states, quantum mechanics also allows for the superposition of quantum circuits<xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref>&#x02014;a feature which is not used in the standard quantum circuit model. Nevertheless, such superpositions of quantum circuits are rapidly becoming central to several foundational research programs studying the role of time and causality in quantum theory<xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref>. These superpositions of quantum circuits (sometimes called a &#x02018;superposition of causal orders') give rise to new counter-intuitive quantum predictions, and it has recently been predicted that they could provide quantum computers with even further computational advantages<xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b10">10</xref>. In particular, superimposing quantum circuits, each with a different gate ordering, can allow one to accomplish a specific computational task with fewer quantum gate uses than a quantum computer which has a fixed-gate order<xref ref-type="bibr" rid="b10">10</xref>.</p><p>One of the most useful methods for quantifying the performance of a quantum algorithm is its query complexity. Loosely speaking, this is the number of times that a quantum gate is used (or queried). The use of the query complexity is motivated by the assumption that applying a gate is a cost that we wish to minimize. In an optical quantum computer this cost would be either another physical copy of the gate (say a different set of waveplates, or interferometer), or a repeated usage of the same gate at a later time. In an ion-trap<xref ref-type="bibr" rid="b11">11</xref> or super-conducting<xref ref-type="bibr" rid="b12">12</xref> quantum computer the cost would be the application of another pulse sequence to the qubits. Given that one of the main difficulties in creating a scalable quantum computer is the implementation of multiple gates<xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b14">14</xref>, techniques to reduce the query complexity are essential for practical quantum computing.</p><p>Just as in a classical electronic circuit, in a fixed-order quantum circuit one connects a series of logic gates by wires (see <xref ref-type="fig" rid="f1">Fig. 1a</xref> or <xref ref-type="fig" rid="f1">Fig. 1b</xref>). This is an intuitive and extremely powerful method for designing quantum algorithms, but there are advantages to other models. One example is measurement-based quantum computing<xref ref-type="bibr" rid="b15">15</xref><xref ref-type="bibr" rid="b16">16</xref>, a different paradigm than the circuit model which paved the way for many experimental implementations of quantum algorithms<xref ref-type="bibr" rid="b17">17</xref><xref ref-type="bibr" rid="b18">18</xref>. Unlike other models of computation, what is considered here is a strict extension of the quantum circuit model, which therefore allows for additional computational power. The particular extension we study in our experiment is to allow for superpositions of different quantum circuits; that is, to coherently control which quantum circuit is applied on an input state (see <xref ref-type="fig" rid="f1">Fig. 1c</xref>). In this case, the order of quantum gates acting on a set of qubits could be controlled by the state of another set of qubits&#x02014;this is not allowed in the standard-quantum circuit model, wherein the gate order is independent of the state of the qubits<xref ref-type="bibr" rid="b4">4</xref>.</p><p>Coherently controlling the order of quantum gates conditioned on the state of a set of qubits is a new type of operation. A proposal for one such operation is the &#x02018;N-SWITCH', which takes <italic>N</italic> different gates and applies them in a given superposition of different permutations<xref ref-type="bibr" rid="b19">19</xref>. Using this operation, a quantum algorithm has recently been proposed to solve a specific problem with a query complexity of <italic>O</italic>(<italic>N</italic>), while a fixed-order circuit is likely to require <italic>O</italic>(<italic>N</italic><sup>2</sup>) queries to solve the same problem<xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b10">10</xref>. In other words, the N-SWITCH reduces the query complexity by a factor <italic>N</italic>. Since it has been shown that the N-SWITCH can be simulated by <italic>N</italic><sup>2</sup> fixed-order gates<xref ref-type="bibr" rid="b10">10</xref>, a factor of <italic>N</italic> is the maximum advantage that can be achieved with this operation. It is an open question whether there exist other resources without fixed-gate order that would allow further advantages.</p><p>In this paper, we report on our experimental demonstration of a 2-SWITCH operation, which we implement by taking advantage of additional degrees of freedom of the physical system which encodes our qubits. Our technique makes it possible to apply two quantum gates in a superposition of both possible orders, and it enables us to determine if the gates commute or anti-commute with only a single use (or query) of each gate. On the other hand, determining if two gates commute or anti-commute using a quantum circuit with a fixed-gate order would require at least two uses of one of the gates<xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b20">20</xref>. Moreover, when this problem is scaled to <italic>N</italic> gates, creating a superposition of quantum circuits is likely to provide an exponential advantage over classical algorithms, and a linear advantage over quantum algorithms with fixed-gate order<xref ref-type="bibr" rid="b10">10</xref>. The techniques that we demonstrate here could allow some quantum algorithms to be implemented with an efficiency that is unlikely to be achieved on a quantum computer with a fixed-gate order.</p><sec disp-level="1"><title>Results</title><sec disp-level="2"><title>Theoretical objective</title><p>In our task, one is presented with two unitary gates, <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub>, and the guarantee that <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> either commute or anti-commute (but <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> are otherwise unknown and arbitrary). The goal is to determine which statement is true. This is the first step towards demonstrating the quantum algorithm proposed in ref. <xref ref-type="bibr" rid="b10">10</xref>, and, in the case with <italic>N</italic>=2 causal orders, it corresponds to the information processing task introduced in ref. <xref ref-type="bibr" rid="b8">8</xref>. In the standard-circuit model this task cannot be carried out with a single use of each gate<xref ref-type="bibr" rid="b8">8</xref>; this limitation is evident in all previous experimental investigations of commutation relations, which all used one gate at least twice<xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref>. However, using the 2-SWITCH operation to apply <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> in a superposition of both orders allows us to distinguish whether the gates commute or anti-commute with only one use of each gate. To see this, consider using the 2-SWITCH operation in the circuit shown in <xref ref-type="fig" rid="f1">Fig. 1d</xref>. Given that the 2-SWITCH applies <italic>U</italic><sub>1</sub><italic>U</italic><sub>2</sub> if the upper qubit is in <inline-formula id="d33e350"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e351" xlink:href="ncomms8913-m1.jpg"/></inline-formula> and <italic>U</italic><sub>2</sub><italic>U</italic><sub>1</sub> if upper qubit is in <inline-formula id="d33e363"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e364" xlink:href="ncomms8913-m2.jpg"/></inline-formula>, it is straightforward to show that, when the input to the circuit is initially in the state <inline-formula id="d33e366"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e367" xlink:href="ncomms8913-m3.jpg"/></inline-formula> (where <inline-formula id="d33e369"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e370" xlink:href="ncomms8913-m4.jpg"/></inline-formula> is an arbitrary state of qubit 2), the result (after performing a Hadamard gate on the control qubit, and before measuring it) is the state</p><p><disp-formula id="eq5"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e374" xlink:href="ncomms8913-m5.jpg"/></disp-formula></p><p>In <xref ref-type="disp-formula" rid="eq5">equation (1)</xref>, [<italic>U</italic><sub>1</sub>, <italic>U</italic><sub>2</sub>] and {<italic>U</italic><sub>1</sub>, <italic>U</italic><sub>2</sub>} are the commutator and anti-commutator of <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub>, respectively. Given the guarantee of either commutation or anti-commutation, if the upper qubit is measured and found in <inline-formula id="d33e411"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e412" xlink:href="ncomms8913-m6.jpg"/></inline-formula> we know for certain that the gates commute; on the other hand, if it is found in <inline-formula id="d33e415"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e416" xlink:href="ncomms8913-m7.jpg"/></inline-formula> we know for certain that the gates anti-commute. Thus one can unambiguously distinguish between the two cases. Note that, although <xref ref-type="fig" rid="f1">Fig. 1d</xref> shows the 2-SWITCH operation as a gate in a quantum circuit, it cannot be implemented by querying <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> only once in a fixed order.</p></sec><sec disp-level="2"><title>Experimental implementation</title><p>Although creating superpositions of circuits is a conceptually simple idea, it is not immediately clear how it could be carried out in the laboratory. The most obvious solution is to place the physical circuit elements&#x02014;such as wires or optical fibres connecting the gates&#x02014;in a quantum superposition. However, this would require quantum control over macroscopic systems, and is likely to remain unattainable in the foreseeable future. Instead, we use additional degrees of freedom of our qubits to control the order with which they traverse the gates. Note that other implementations have been independently proposed, both making use of internal degrees of freedom (G. Chiribella, R. Ionicioiu, T. Jennewein and D. Terno, personal communication, July 2012)<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref>, and in adiabatic quantum computing<xref ref-type="bibr" rid="b25">25</xref>. The internal degrees of freedom could be any degrees of freedom of the physical system that the qubits are encoded in. For example, trapped ions possess many electronic and vibrational modes, many of which could be suitably controlled<xref ref-type="bibr" rid="b23">23</xref>. In our experiment, we use a spatial degree of freedom of photonic qubits to create a superposition of different gate orders acting on a qubit encoded in the photon's polarization. While the use of multiple degrees of freedom of a single photon is a well-known tool in photonic-quantum computing<xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b27">27</xref><xref ref-type="bibr" rid="b28">28</xref><xref ref-type="bibr" rid="b29">29</xref><xref ref-type="bibr" rid="b30">30</xref><xref ref-type="bibr" rid="b31">31</xref><xref ref-type="bibr" rid="b32">32</xref>, our work is the first experimental demonstration which uses this tool to superimpose quantum gate orders. Furthermore, using controlled-path gates<xref ref-type="bibr" rid="b31">31</xref>, which coherently place a photon in one of two paths dependent on the state of another photon, our technique would form the basis of a 2-SWITCH operation between two different photons, making it possible to create multi-particle circuits with no fixed-gate order.</p><p>At the centre of our implementation is a Mach&#x02013;Zehnder interferometer with a loop in each arm (see <xref ref-type="fig" rid="f2">Fig. 2</xref>), which allows us to create the required superposition of gate orders. In particular, it enables one qubit (qubit 1 of the circuit in <xref ref-type="fig" rid="f1">Fig. 1d</xref>), encoded in a spatial degree of freedom of the photon, to coherently control the order in which two gates are applied to another qubit (qubit 2 of <xref ref-type="fig" rid="f1">Fig. 1d</xref>), encoded in the photon's polarization. We choose to use a spatial degree of freedom as control (that is different than previous theoretical work which proposed using polarization as control<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b23">23</xref>) since it proved to be much more stable experimentally. Briefly, a single photon is sent to a 50/50 beamsplitter, which creates the spatial qubit: <inline-formula id="d33e459"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e460" xlink:href="ncomms8913-m8.jpg"/></inline-formula> if transmitted, and <inline-formula id="d33e463"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e464" xlink:href="ncomms8913-m9.jpg"/></inline-formula> if reflected. The unitary gates <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> are implemented on the polarization state of the same photon using a set of waveplates. Now, dependent on whether the photon is reflected or transmitted, the polarization qubit will see either <italic>U</italic><sub>1</sub><italic>U</italic><sub>2</sub> or <italic>U</italic><sub>2</sub><italic>U</italic><sub>1</sub>. The two paths then coherently recombine on a final 50/50 beamsplitter (enacting the Hadamard gate shown in <xref ref-type="fig" rid="f1">Fig. 1c</xref>). Finally, simply measuring the state of the spatial qubit (that is, whether the photon exits port 0 or 1 of the final beamsplitter) tells us if <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> commute or anti-commute.</p><p>Before continuing, we must specify what constitutes a &#x02018;gate use' in a photonic experiment. In accordance with previous work<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b23">23</xref>, we define a single gate use as a single photon passing through a single physical copy of a gate. This definition is well motivated, since it quantifies both the number of physical devices required, and the experimental cost of rerouting photons through the same gate at a later time. If we imagine affixing counters to each set of waveplates, which increment every time a photon passes by, then we can read the number of uses of a gate directly off of the counter. Note that such a counter system will factorize out, and thus will not destroy the interference<xref ref-type="bibr" rid="b10">10</xref>. In this hypothetical situation, each time a photon passes through our experiment the counters of <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> will always read 1. Thus, by this definition, we use each gate once in our experiment.</p></sec><sec disp-level="2"><title>Data for sets of Pauli gates</title><p>To verify the successful implementation of this protocol we tested its performance on a number of representative unitary gates. The first set of gates we tested were the four Pauli gates (including identity), <inline-formula id="d33e530"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e531" xlink:href="ncomms8913-m10.jpg"/></inline-formula>. The Pauli gates have simple commutation and anti-commutation relationships: each gate only commutes with itself and identity, and anti-commutes with the other gates. For example, <italic>&#x003c3;</italic><sub><italic>x</italic></sub> commutes with <inline-formula id="d33e539"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e540" xlink:href="ncomms8913-m11.jpg"/></inline-formula> and <italic>&#x003c3;</italic><sub><italic>x</italic></sub>, and anti-commutes with <italic>&#x003c3;</italic><sub><italic>y</italic></sub> and <italic>&#x003c3;</italic><sub><italic>z</italic></sub>. Thus, setting <italic>U</italic><sub>1</sub>=<italic>&#x003c3;</italic><sub><italic>x</italic></sub> means that when <italic>U</italic><sub>2</sub> is set to either <inline-formula id="d33e578"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e579" xlink:href="ncomms8913-m12.jpg"/></inline-formula> or <italic>&#x003c3;</italic><sub><italic>x</italic></sub> the photon will always exit port 0. On the other hand, if <italic>U</italic><sub>2</sub> is set to <italic>&#x003c3;</italic><sub><italic>y</italic></sub> or <italic>&#x003c3;</italic><sub><italic>z</italic></sub>, the photon should always exit port 1.</p><p>To acquire data, <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> were first set to identity so that the phase of the interferometer could be set to <italic>&#x003c0;</italic>; this was carried out using a piezo-driven mirror (in <xref ref-type="fig" rid="f2">Fig. 2</xref>). Then <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> could be set to any desired single-qubit unitary gate by setting the waveplate angles appropriately (See <xref ref-type="supplementary-material" rid="S1">Supplementary Note 1</xref> and <xref ref-type="supplementary-material" rid="S1">Supplementary Table 1</xref>). For the Pauli-gate data, we cycled <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> through all 16 possible permutations and monitored the photon counts out of each port of the final beamsplitter. For every Pauli-gate combination, the probability for the photons to exit each port was estimated (see the Methods Section for details, including a discussion of the error bars). The resulting probabilities are plotted in <xref ref-type="fig" rid="f3">Fig. 3</xref>. When the gates commute, we expect all of the photons to exit port 0, while if they anti-commute they should all exit port 1. Our observed data agrees very well with this prediction. For the Pauli gates, we were able to successfully determine whether a pair of gates commuted or anti-commuted with a success rate (probability to exit the &#x02018;correct port') of 0.973&#x000b1;0.016. For this data, the initial polarization state was <inline-formula id="d33e654"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e655" xlink:href="ncomms8913-m13.jpg"/></inline-formula>, but, as we verified experimentally, the protocol is independent of the polarization (see <xref ref-type="supplementary-material" rid="S1">Supplementary Note 2</xref> and <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 1</xref>).</p></sec><sec disp-level="2"><title>Comparison with the best fixed-order quantum circuit</title><p>Without using a superposition of different quantum circuits, it is impossible to perfectly determine if two gates commute or anti-commute with a single use of each gate<xref ref-type="bibr" rid="b8">8</xref>. However, it has not been appreciated before that, using a fixed-order quantum circuit, this task can be accomplished probabilistically. In the <xref ref-type="supplementary-material" rid="S1">Supplementary Note 3</xref> we present a calculation, based on the &#x02018;quantum comb' formalism<xref ref-type="bibr" rid="b33">33</xref><xref ref-type="bibr" rid="b34">34</xref><xref ref-type="bibr" rid="b35">35</xref>, showing that the maximum average success rate is 0.9288 (the full derivation is explicitly made another publication<xref ref-type="bibr" rid="b36">36</xref>). To rigorously compare our protocol to such a quantum circuit, we randomly generated 50 pairs of commuting gates and 50 pairs of anti-commuting gates (see the Methods Section D) and we tested our protocol with each pair. A subset of the data for these gates is plotted in <xref ref-type="fig" rid="f4">Fig. 4</xref>, and the full data set in presented in <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 2</xref>. The success rate of our protocol over the 100 pairs of commuting and anti-commuting gates is 0.976&#x000b1;0.015, which surpasses the fixed-order bound by more than three s.d.</p></sec></sec><sec disp-level="1"><title>Discussion</title><p>Our experiment also has implications, in the broader context, for the study of causal structures in quantum mechanics, a topic that has recently received increasing theoretical<xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b37">37</xref> and experimental<xref ref-type="bibr" rid="b38">38</xref><xref ref-type="bibr" rid="b39">39</xref> attention. Traditionally, space-time events are defined with respect to some coordinate system, which describes a given underlying space-time. If we attach some fixed space-coordinates to the waveplates of our interferometer, one can say that there are two different times at which each photon can undergo the corresponding operation. In this perspective, one would describe the experiment in terms of four space-time events (in our experiment these would be: <italic>U</italic><sub>1</sub> first, <italic>U</italic><sub>2</sub> second, <italic>U</italic><sub>1</sub> second and <italic>U</italic><sub>2</sub> first), whose causal order is determined by the underlying classical space-time. Note, however, that any attempt to physically distinguish the two times at which a photon can pass through a gate would reveal which-way information and thus destroy the interference. The results of the experiment confirm that such information is not available anywhere and that the interpretation of the experiment in terms of four, causally-ordered events cannot be given any operational meaning. If, on the other hand, one requires events to be defined operationally, in terms of measurable interactions with physical systems (as in the hypothetical photon-counter example discussed above), then the experiment should be described in terms of only two events&#x02014;a single use of each of the two gates. Thus we can take the interference in our experiment to demonstrate that the two events cannot be ordered according to any definite causal relation; in this sense, our experiment can be seen as the first realization of a &#x02018;superposition of causal orders'. Indeed, it is shown elsewhere<xref ref-type="bibr" rid="b36">36</xref> that the 2-SWITCH realized here corresponds to an example of a causally non-separable process, as defined in ref. <xref ref-type="bibr" rid="b5">5</xref>.</p><p>In conclusion, we have shown how to use additional degrees of freedom of the physical system encoding a quantum system to apply quantum operations without a fixed, definite causal order. This allowed us to accomplish a task which is impossible with a fixed order of operations. Our demonstration of superimposed quantum circuits illustrates that removing the requirement of a fixed-gate order can provide quantum algorithms with real practical advantages and it shows a feasible way to obtain this advantage.</p></sec><sec disp-level="1"><title>Methods</title><sec disp-level="2"><title>Single-photon source</title><p>The source generated photon pairs, in a separable polarization state, by means of the process of spontaneous parametric down conversion using a Sagnac loop<xref ref-type="bibr" rid="b40">40</xref><xref ref-type="bibr" rid="b41">41</xref>. The Sagnac loop was built using a dual-wavelength polarizing beamsplitter and two mirrors. A type-II collinear periodically-poled Potassium Titanyl Phosphate crystal of length 20&#x02009;mm was placed inside the loop and pumped by a 23.7&#x02009;mW diode laser centred at 395&#x02009;nm. Photon pairs were created at degenerate wavelength 790&#x02009;nm. We set the pump beam polarization to be horizontal to generate the down-converted photons in a separable polarization state <inline-formula id="d33e732"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e733" xlink:href="ncomms8913-m14.jpg"/></inline-formula>. The dichroic mirror transmited the pump beam and reflected the down-converted photons, and the half waveplate (HWP) and quarter waveplate (QWP) were used to adjust the polarization of the pump beam. Long and narrow band pass filters blocked the pump beam and selected the desired down-converted wavelength. Polarizers were aligned to transmit only down-converted photons with the desired polarization. After this, the down-converted photon pairs were coupled into single-mode fibres, and one photon from the pair was used as a herald while the other single photon was sent to our interferometer using a fibre collimator.</p></sec><sec disp-level="2"><title>Optical implementation</title><p>We implemented our protocol using a Mach&#x02013;Zehnder interferometer with two symmetric arm loops, see <xref ref-type="fig" rid="f2">Fig. 2b</xref>. After the first beamsplitter, the reflected and transmitted beams were sent to a different combination of waveplates which formed the unitary gates. The symmetric loops were built to have the same input direction through the unitary gates for both the transmitted and reflected beams; that is, the photons always traversed the waveplates in the same direction, regardless of whether they saw <italic>U</italic><sub>1</sub> or <italic>U</italic><sub>2</sub> first. After this, the two paths were recombined on the second beam splitter. For the reflected beam, a HWP at 0&#x000b0; was used before the waveplates implementing <italic>U</italic><sub>2</sub> to ensure that the polarization state of the reflected and transmitted paths was the same before the unitary gates; this was required because the reflected path picked up a reflection phase not seen by the transmitted mode. Another a HWP at 0&#x000b0; was used in the transmitted arm after <italic>U</italic><sub>2</sub> to compensate the reflection from the second beamsplitter.</p><p>After the interferometer, the photons exiting port 0 and 1 were coupled into single-mode fibres. Then, the single photons were detected using avalanche photodiodes which were connected to a home-built coincidence counter based on Spartan 3E FPGA to register two-photon events between either port and the heralding photon. Since the coupling efficiency of each port and the detection efficiency of each avalanche photodiodes were slightly different we had to correct for this to calculate the probabilities reported in <xref ref-type="fig" rid="f3">Figs 3</xref> and <xref ref-type="fig" rid="f4">4</xref>. To perform this correction, we varied the phase of the interferometer to send all of the photons from port 0 to port 1, and we recorded the counts out of port 0 (<italic>C</italic><sub>0</sub>) and the counts out of port 1 (<italic>C</italic><sub>1</sub>) as the phase was varied. We then computed an efficiency factor <italic>&#x003b7;</italic>, such that <italic>C</italic><sub>0</sub>&#x0002b;<italic>C</italic><sub>1</sub>/<italic>&#x003b7;</italic> was constant. We found that <italic>&#x003b7;</italic> was typically around 0.7, but its exact valued varied because the coupling efficiencies changed slightly from one day to the next. Using this, we estimated the probability to exit port 0 as <italic>P</italic><sub>0</sub>=<italic>C</italic><sub>0</sub>/(<italic>C</italic><sub>0</sub>&#x0002b;<italic>C</italic><sub>1</sub>/<italic>&#x003b7;</italic>), and the probability to exit port 1 as <italic>P</italic><sub>1</sub>=1&#x02212;<italic>P</italic><sub>0</sub>.</p><p>The visibility of the interferometer was 99.4&#x000b1;0.2 with a phase drift &#x0003c;9&#x02009;mrad&#x02009;min<sup>&#x02212;1</sup>. A complete data set (20 waveplate settings) was acquired in &#x0223c;2&#x02009;min (1&#x02009;s of data was taken at each setting, so the majority of the time was spent moving waveplates). The observed phase drift would lead to a negligible error (of only &#x02248;0.02&#x00025;) over the 2-min measurement time. At each setting &#x0223c;40,000 photon pairs were observed. The error bars were estimated by performing each measurement five times and observing the s.d.. Each measurement setting had a slightly different s.d., but for convenience we took the largest s.d. as the error bar for each measurement setting. The dominant contribution to these fluctuations was a phase drift caused by rotating the waveplates, and the Poissonian error bars (due to 40,000 counts) are much smaller than these observed fluctuations.</p></sec><sec disp-level="2"><title>Polarization unitary gates</title><p>It is well known that the combination of three waveplates (in a quarter-half-quarter configuration) can implement an arbitrary single-qubit polarization gate. Since this method is completely general, we used it to implement each of the two unitary gates <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub>. Each of the six waveplates were mounted using a motorized rotation mount, which allowed the unitary gates to be set remotely while only minimally disturbing the phase of the interferometer. However, we still found a slight systematic phase drift when the waveplates were rotated. We attributed this to slightly &#x02018;wedged' shaped waveplates, which could change the optical path of each interferometer arm differently. For our waveplates (true-zero order waveplates from Special Optics, which were the most parallel waveplates we tested), we observed a maximum phase drift of 0.002&#x02009;rad per deg of waveplate rotation. The waveplate angles used to implement the different polarization gates are tabulated in <xref ref-type="supplementary-material" rid="S1">Supplementary Tables 1 and 2</xref>. On average, setting the six waveplates to implement a specific <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> required a total rotation of &#x02248;45&#x000b0;; this would introduce a systematic error in the phase of the interferometer of &#x0223c;0.009&#x02009;rad and an additional error onto our measured probabilities of 0.4&#x00025;.</p></sec><sec disp-level="2"><title>Generating commuting and anti-commuting pairs of gates</title><p>We tested our protocol on 50 randomly chosen pairs of commuting gates and on 50 randomly chosen pairs of anti-commuting gates. To generate these gates we followed a very simple protocol. First, we randomly chose a unitary gate <inline-formula id="d33e876"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e877" xlink:href="ncomms8913-m15.jpg"/></inline-formula> from the Haar measure. Next, to generate two anti-commuting gates <italic>A</italic><sub>1</sub> and <italic>A</italic><sub>2</sub>, we set <italic>A</italic><sub>1</sub>=<inline-formula id="d33e895"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e896" xlink:href="ncomms8913-m16.jpg"/></inline-formula><italic>&#x003c3;</italic><sub><italic>z</italic></sub><inline-formula id="d33e902"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e903" xlink:href="ncomms8913-m17.jpg"/></inline-formula><sup>&#x02020;</sup> and <italic>A</italic><sub>2</sub>=<inline-formula id="d33e912"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e913" xlink:href="ncomms8913-m18.jpg"/></inline-formula><italic>&#x003c3;</italic><sub><italic>y</italic></sub><inline-formula id="d33e920"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e921" xlink:href="ncomms8913-m19.jpg"/></inline-formula><sup>&#x02020;</sup> (where <italic>&#x003c3;</italic><sub><italic>y</italic></sub> and <italic>&#x003c3;</italic><sub><italic>z</italic></sub> are Pauli gates). Then, two commuting gates were defined from <inline-formula id="d33e937"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e938" xlink:href="ncomms8913-m20.jpg"/></inline-formula> as</p><p><disp-formula id="eq21"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e942" xlink:href="ncomms8913-m21.jpg"/></disp-formula></p><p>and</p><p><disp-formula id="eq22"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e947" xlink:href="ncomms8913-m22.jpg"/></disp-formula></p><p>where <italic>&#x003b8;</italic><sub>1</sub> and <italic>&#x003b8;</italic><sub>2</sub> were also chosen randomly (we selected them from a uniform distribution between 0 and 2<italic>&#x003c0;</italic>). After this we computed the waveplate angles required to implement <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>, <italic>A</italic><sub>1</sub> and <italic>A</italic><sub>2</sub> (these angles are listed <xref ref-type="supplementary-material" rid="S1">Supplementary Table 2</xref>).</p></sec></sec><sec disp-level="1"><title>Additional information</title><p><bold>How to cite this article:</bold> Procopio, L. M. <italic>et al</italic>. Experimental superposition of orders of quantum gates. <italic>Nat. Commun.</italic> 6:7913 doi: 10.1038/ncomms8913 (2015).</p></sec><sec sec-type="supplementary-material" id="S1"><title>Supplementary Material</title><supplementary-material id="d33e18" content-type="local-data"><caption><title>Supplementary Information</title><p>Supplementary Figure 1-3, Supplementary Tables 1-2, Supplementary Notes 1-3 and Supplementary References</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms8913-s1.pdf"/></supplementary-material></sec></body><back><ack><p>We thank T. Batalh&#x000e3;o, A. Feix, C. Greganti, F. Massa for stimulating discussions, and T. R&#x000f6;gelsperger and J. Thomson for assisting with the figures. We acknowledge support from the European Commission, QUILMI (No. 295293), EQUAM (No. 323714), PICQUE (No. 608062), GRASP (No.613024), QUCHIP (No.641039), and RAQUEL (No. 323970); the Austrian Science Fund (FWF) through START (Y585-N20), the doctoral programme CoQuS, and Individual Project (No. 2462); the Vienna Science and Technology Fund (WWTF, grant ICT12-041); the United States Air Force Office of Scientific Research (FA8655-11-1-3004); the John Templeton Foundation; and the Foundational Questions Institute (FQXi). L.M.P. acknowledges partial support from CONACYT-M&#x000e9;xico. L.A.R was partially funded by a Natural Sciences and Engineering Research Council of Canada (NSERC) Postdoctoral Fellowship, and E.G.D. was partially funded by the Herchel Smith&#x02014;Harvard Undergraduate Research Fellowship.</p></ack><ref-list><ref id="b1"><mixed-citation publication-type="journal"><name><surname>Deutsch</surname><given-names>D.</given-names></name>
<article-title>Quantum computational networks</article-title>. <source>Proc. R. Soc. Lond A Math. Phys. Sci.</source>
<volume>425</volume>, <fpage>73</fpage>&#x02013;<lpage>90</lpage> (<year>1989</year>).</mixed-citation></ref><ref id="b2"><mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>M. A.</given-names></name> &#x00026; <name><surname>Chuang</surname><given-names>I. L.</given-names></name>
<source>Quantum Computation and Quantum Information</source> 1st ed. Cambridge University Press (<year>2000</year>).</mixed-citation></ref><ref id="b3"><mixed-citation publication-type="journal"><name><surname>Aharonov</surname><given-names>Y.</given-names></name>
<etal/>. <article-title>Superpositions of time evolutions of a quantum system and a quantum time-translation machine</article-title>. <source>Phys. Rev. Lett.</source>
<volume>64</volume>, <fpage>2965</fpage>&#x02013;<lpage>2968</lpage> (<year>1990</year>).<pub-id pub-id-type="pmid">10041860</pub-id></mixed-citation></ref><ref id="b4"><mixed-citation publication-type="journal"><name><surname>Chiribella</surname><given-names>G.</given-names></name>
<etal/>. <article-title>Quantum computations without definite causal structure</article-title>. <source>Phys. Rev. A.</source>
<volume>88</volume>, <fpage>022318</fpage> (<year>2013</year>).</mixed-citation></ref><ref id="b5"><mixed-citation publication-type="journal"><name><surname>Oreshkov</surname><given-names>O.</given-names></name>
<etal/>. <article-title>&#x02018;Quantum correlations with no causal order,'</article-title>. <source>Nat. Commun.</source>
<volume>3</volume>, <fpage>1092</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23033068</pub-id></mixed-citation></ref><ref id="b6"><mixed-citation publication-type="journal"><name><surname>Hardy</surname><given-names>L.</given-names></name>
<article-title>Quantum gravity computers: On the theory of computation with indefinite causal structure</article-title>. in <source>Quantum Reality, Relativistic Causality, and Closing the Epistemic Circle</source>
<fpage>379</fpage>&#x02013;<lpage>401</lpage>Springer (<year>2009</year>).</mixed-citation></ref><ref id="b7"><mixed-citation publication-type="journal"><name><surname>Rudolph.</surname><given-names>T.</given-names></name>
<article-title>Quantum causality: information insights</article-title>. <source>Nat. Phys.</source>
<volume>8</volume>, <fpage>860</fpage>&#x02013;<lpage>861</lpage> (<year>2012</year>).</mixed-citation></ref><ref id="b8"><mixed-citation publication-type="journal"><name><surname>Chiribella.</surname><given-names>G.</given-names></name>
<article-title>Perfect discrimination of no-signalling channels via quantum superposition of causal structures</article-title>. <source>Phys. Rev. A.</source>
<volume>86</volume>, <fpage>040301</fpage> (<year>2012</year>).</mixed-citation></ref><ref id="b9"><mixed-citation publication-type="journal"><name><surname>Brukner</surname><given-names>&#x0010c;.</given-names></name>
<article-title>Quantum causality</article-title>. <source>Nat. Phys.</source>
<volume>10</volume>, <fpage>259</fpage>&#x02013;<lpage>263</lpage> (<year>2014</year>).</mixed-citation></ref><ref id="b10"><mixed-citation publication-type="journal"><name><surname>Ara&#x000fa;jo</surname><given-names>M.</given-names></name>
<etal/>. <article-title>Computational advantage from quantum- controlled ordering of gates</article-title>. <source>Phys. Rev. Lett.</source>
<volume>113</volume>, <fpage>250402</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25554864</pub-id></mixed-citation></ref><ref id="b11"><mixed-citation publication-type="journal"><name><surname>Cirac</surname><given-names>J. I.</given-names></name> &#x00026; <name><surname>Zoller</surname><given-names>P.</given-names></name>
<article-title>Quantum computations with cold trapped ions</article-title>. <source>Phys. Rev. Lett.</source>
<volume>74</volume>, <fpage>4091</fpage> (<year>1995</year>).<pub-id pub-id-type="pmid">10058410</pub-id></mixed-citation></ref><ref id="b12"><mixed-citation publication-type="journal"><name><surname>DiCarlo</surname><given-names>L.</given-names></name>
<etal/>. <article-title>Demonstration of two-qubit algorithms with a superconducting quantum processor</article-title>. <source>Nature</source>
<volume>460</volume>, <fpage>240</fpage>&#x02013;<lpage>244</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19561592</pub-id></mixed-citation></ref><ref id="b13"><mixed-citation publication-type="journal"><name><surname>Martin-Lopez</surname><given-names>E.</given-names></name>
<etal/>. <article-title>Experimental realization of shor's quantum factoring algorithm using qubit recycling</article-title>. <source>Nat. Photonics</source>
<volume>6</volume>, <fpage>773</fpage>&#x02013;<lpage>776</lpage> (<year>2012</year>).</mixed-citation></ref><ref id="b14"><mixed-citation publication-type="journal"><name><surname>Barz</surname><given-names>S.</given-names></name>
<etal/>. <article-title>A two-qubit photonic quantum processor and its application to solving systems of linear equations</article-title>. <source>Sci. Rep.</source>
<volume>4</volume>, <fpage>6115</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25135432</pub-id></mixed-citation></ref><ref id="b15"><mixed-citation publication-type="journal"><name><surname>Raussendorf</surname><given-names>R.</given-names></name> &#x00026; <name><surname>Briegel</surname><given-names>H. J.</given-names></name>
<article-title>A one-way quantum computer</article-title>. <source>Phys. Rev. Lett.</source>
<volume>86</volume>, <fpage>5188</fpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11384453</pub-id></mixed-citation></ref><ref id="b16"><mixed-citation publication-type="journal"><name><surname>Raussendorf</surname><given-names>R.</given-names></name>
<etal/>. <article-title>Measurement-based quantum computation on cluster states</article-title>. <source>Phys. Rev. A.</source>
<volume>68</volume>, <fpage>022312</fpage> (<year>2003</year>).</mixed-citation></ref><ref id="b17"><mixed-citation publication-type="journal"><name><surname>Walther</surname><given-names>P.</given-names></name>
<etal/>. <article-title>Experimental one-way quantum computing</article-title>. <source>Nature</source>
<volume>434</volume>, <fpage>169</fpage>&#x02013;<lpage>176</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15758991</pub-id></mixed-citation></ref><ref id="b18"><mixed-citation publication-type="journal"><name><surname>Prevedel</surname><given-names>R.</given-names></name>
<etal/>. <article-title>High-speed linear optics quantum computing using active feed-forward</article-title>. <source>Nature</source>
<volume>445</volume>, <fpage>65</fpage>&#x02013;<lpage>69</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17203057</pub-id></mixed-citation></ref><ref id="b19"><mixed-citation publication-type="journal"><name><surname>Colnaghi</surname><given-names>T.</given-names></name>
<etal/>. <article-title>Quantum computation with programmable connections between gates</article-title>. <source>Phys. Lett. A.</source>
<volume>376</volume>, <fpage>2940</fpage>&#x02013;<lpage>2943</lpage> (<year>2012</year>).</mixed-citation></ref><ref id="b20"><mixed-citation publication-type="journal"><name><surname>Andersson</surname><given-names>E.</given-names></name>
<etal/>. <article-title>Comparison of unitary transforms using franson interferometry</article-title>. <source>J. Mod. Opt.</source>
<volume>52</volume>, <fpage>1485</fpage>&#x02013;<lpage>1494</lpage> (<year>2005</year>).</mixed-citation></ref><ref id="b21"><mixed-citation publication-type="journal"><name><surname>Yao</surname><given-names>X.-C.</given-names></name>
<etal/>. <article-title>Experimental realization of programmable quantum gate array for directly probing commutation relations of pauli operators</article-title>. <source>Phys. Rev. Lett.</source>
<volume>105</volume>, <fpage>120402</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20867616</pub-id></mixed-citation></ref><ref id="b22"><mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>Y.-S.</given-names></name>
<etal/>. <article-title>Experimental verification of the commutation relation for pauli spin operators using single-photon quantum interference</article-title>. <source>Phys. Lett. A.</source>
<volume>374</volume>, <fpage>4393</fpage>&#x02013;<lpage>4396</lpage> (<year>2010</year>).</mixed-citation></ref><ref id="b23"><mixed-citation publication-type="journal"><name><surname>Friis</surname><given-names>N.</given-names></name>
<etal/>. <article-title>Implementing quantum control for unknown subroutines</article-title>. <source>Phys. Rev. A</source>
<volume>89</volume>, <fpage>030303</fpage> (<year>2014</year>).</mixed-citation></ref><ref id="b24"><mixed-citation publication-type="other"><name><surname>Rambo</surname><given-names>T.</given-names></name>
<etal/>. Functional quantum computing: An optical approach, Preprint at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://arxiv.org/abs/1211.1257">http://arxiv.org/abs/1211.1257</ext-link> (<year>2012</year>).</mixed-citation></ref><ref id="b25"><mixed-citation publication-type="other"><name><surname>Nakago</surname><given-names>K.</given-names></name>
<etal/>. Parallelized adiabatic gate teleportation, Preprint at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://arxiv.org/abs/1310.4061">http://arxiv.org/abs/1310.4061</ext-link> (<year>2013</year>).</mixed-citation></ref><ref id="b26"><mixed-citation publication-type="journal"><name><surname>Englert</surname><given-names>B.-G.</given-names></name>
<etal/>. <article-title>Universal unitary gate for single-photon two-qubit states</article-title>. <source>Phys. Rev. A.</source>
<volume>63</volume>, <fpage>032303</fpage> (<year>2001</year>).</mixed-citation></ref><ref id="b27"><mixed-citation publication-type="journal"><name><surname>Barreiro</surname><given-names>J. T.</given-names></name>
<etal/>. <article-title>Generation of hyperentangled photon pairs</article-title>. <source>Phys. Rev. Lett.</source>
<volume>95</volume>, <fpage>260501</fpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16486324</pub-id></mixed-citation></ref><ref id="b28"><mixed-citation publication-type="journal"><name><surname>Barreiro</surname><given-names>J. T.</given-names></name>
<etal/>. <article-title>Beating the channel capacity limit for linear photonic superdense coding</article-title>. <source>Nat. Phys.</source>
<volume>4</volume>, <fpage>282</fpage>&#x02013;<lpage>286</lpage> (<year>2008</year>).</mixed-citation></ref><ref id="b29"><mixed-citation publication-type="journal"><name><surname>Lanyon</surname><given-names>B. P.</given-names></name>
<etal/>. <article-title>Simplifying quantum logic using higher-dimensional Hilbert spaces</article-title>. <source>Nat. Phys.</source>
<volume>5</volume>, <fpage>134</fpage>&#x02013;<lpage>140</lpage> (<year>2009</year>).</mixed-citation></ref><ref id="b30"><mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>W.-B.</given-names></name>
<etal/>. <article-title>Experimental demonstration of a hyper-entangled ten-qubit Schrodinger cat state</article-title>. <source>Nat Phys.</source>
<volume>6</volume>, <fpage>331</fpage>&#x02013;<lpage>335</lpage> (<year>2010</year>).</mixed-citation></ref><ref id="b31"><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X.-Q.</given-names></name>
<etal/>. <article-title>Adding control to arbitrary unknown quantum operations</article-title>. <source>Nat. Commun.</source>
<volume>2</volume>, <fpage>413</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21811242</pub-id></mixed-citation></ref><ref id="b32"><mixed-citation publication-type="journal"><name><surname>Rozema</surname><given-names>L. A.</given-names></name>
<etal/>. <article-title>Quantum data compression of a qubit ensemble</article-title>. <source>Phys. Rev. Lett.</source>
<volume>113</volume>, <fpage>160504</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25361244</pub-id></mixed-citation></ref><ref id="b33"><mixed-citation publication-type="journal"><name><surname>Chiribella</surname><given-names>G.</given-names></name>
<etal/>. <article-title>Quantum Circuit Architecture</article-title>. <source>Phys. Rev. Lett.</source>
<volume>101</volume>, <fpage>060401</fpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18764438</pub-id></mixed-citation></ref><ref id="b34"><mixed-citation publication-type="journal"><name><surname>Gutoski</surname><given-names>G.</given-names></name> &#x00026; <name><surname>Watrous</surname><given-names>J.</given-names></name>
<article-title>Toward a general theory of quantum games</article-title>. in <source>Proceedings of the thirty-ninth annual ACM symposium on Theory of computing</source>
<fpage>565</fpage>&#x02013;<lpage>574</lpage>ACM (<year>2007</year>).</mixed-citation></ref><ref id="b35"><mixed-citation publication-type="journal"><name><surname>Chiribella</surname><given-names>G.</given-names></name>
<article-title>Optimal networks for quantum metrology: semidefinite programs and product rules</article-title>. <source>New. J. Phys.</source>
<volume>14</volume>, <fpage>125008</fpage> (<year>2012</year>).</mixed-citation></ref><ref id="b36"><mixed-citation publication-type="other"><name><surname>Araujo</surname><given-names>M.</given-names></name>
<etal/>. Witnessing causal nonseparability, Preprint at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.03776">http://arxiv.org/abs/1506.03776</ext-link> (<year>2015</year>).</mixed-citation></ref><ref id="b37"><mixed-citation publication-type="journal"><name><surname>Wood</surname><given-names>C. J.</given-names></name> &#x00026; <name><surname>Spekkens</surname><given-names>R. W.</given-names></name>
<article-title>The lesson of causal discovery algorithms for quantum correlations: causal explanations of bell-inequality violations require fine-tuning</article-title>. <source>New. J. Phys.</source>
<volume>17</volume>, <fpage>033002</fpage> (<year>2015</year>).</mixed-citation></ref><ref id="b38"><mixed-citation publication-type="other"><name><surname>Fitzsimons</surname><given-names>J.</given-names></name>
<etal/>. Quantum correlations which imply causation, Preprint at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://arxiv.org/abs/1302.2731">http://arxiv.org/abs/1302.2731</ext-link> (<year>2013</year>).</mixed-citation></ref><ref id="b39"><mixed-citation publication-type="journal"><name><surname>Ried</surname><given-names>K.</given-names></name>
<etal/>. <article-title>A quantum advantage for inferring causal structure</article-title>. <source>Nat. Phys.</source>
<volume>11</volume>, <fpage>414</fpage>&#x02013;<lpage>420</lpage> (<year>2015</year>).</mixed-citation></ref><ref id="b40"><mixed-citation publication-type="journal"><name><surname>Taehyun</surname><given-names>K.</given-names></name>
<etal/>. <article-title>Phase-stable source of polarization-entangled photons using a polarization sagnac interferometer</article-title>. <source>Phys. Rev. A.</source>
<volume>73</volume>, <fpage>012316</fpage> (<year>2006</year>).</mixed-citation></ref><ref id="b41"><mixed-citation publication-type="journal"><name><surname>Fedrizzi</surname><given-names>A.</given-names></name>
<etal/>. <article-title>A wavelength-tunable fiber-coupled source of narrowband entangled photons</article-title>. <source>Opt. Express.</source>
<volume>15</volume>, <fpage>15377</fpage>&#x02013;<lpage>15386</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">19550823</pub-id></mixed-citation></ref></ref-list><fn-group><fn><p><bold>Author contributions</bold> L.M.P., A.M., and L.A.R. designed and built the final experiment, collected the data, and performed the final analysis. L.M.P., I.A.C., E.G.D., A.M. and D.R.H. designed and built an early version of the experiment. P.W. designed the experiment and supervised the project. M.A., F.C, and &#x00043;&#x00306;.B. provided the theoretical analysis and the concept for the experiment. All authors contributed to the writing of the final manuscript.</p></fn></fn-group></back><floats-group><fig id="f1"><label>Figure 1</label><caption><title>Theoretical Concept.</title><p>(<bold>a</bold>) Given two unitary gates, <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub>, the circuit model allows us to wire them in one of two possible ways: either <italic>U</italic><sub>1</sub> before <italic>U</italic><sub>2</sub>, or (<bold>b</bold>) <italic>U</italic><sub>2</sub> before <italic>U</italic><sub>1</sub>. (<bold>c</bold>) Quantum mechanics allows us to coherently control both options, such that the qubit sees both <italic>U</italic><sub>1</sub> before <italic>U</italic><sub>2</sub>, <italic>and U</italic><sub>2</sub> before <italic>U</italic><sub>1</sub>. (<bold>d</bold>) The 2-SWITCH operation applies <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> to qubit 2 in both orders, as shown in panel c, dependent on the state of qubit 1. Unless at least one of <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> is used more than once, the 2-SWITCH operation <italic>cannot</italic> be implemented with standard circuit-model elements. To be explicit, the 2-SWITCH applies <italic>U</italic><sub>1</sub><italic>U</italic><sub>2</sub> to <inline-formula id="d33e1112"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1113" xlink:href="ncomms8913-m24.jpg"/></inline-formula> (the lower qubit) if the upper qubit is in <inline-formula id="d33e1115"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1116" xlink:href="ncomms8913-m25.jpg"/></inline-formula>, and <italic>U</italic><sub>2</sub><italic>U</italic><sub>1</sub> to <inline-formula id="d33e1128"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1129" xlink:href="ncomms8913-m26.jpg"/></inline-formula> if the upper qubit is in <inline-formula id="d33e1131"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1132" xlink:href="ncomms8913-m27.jpg"/></inline-formula>. Measuring the state of qubit 1 in the <inline-formula id="d33e1134"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1135" xlink:href="ncomms8913-m28.jpg"/></inline-formula> basis allows one to unambiguously decide if <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub> commute or anti-commute with only a single use of each gate. In this circuit, H is the Hadamard gate, and <inline-formula id="d33e1148"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1149" xlink:href="ncomms8913-m29.jpg"/></inline-formula>.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms8913-f1"/></fig><fig id="f2"><label>Figure 2</label><caption><title>Experimental Implementation.</title><p>Our optical implementation to distinguish whether a pair of unitary gates commute or anti-commute with only a single copy of each gate. The photons for our experiment are generated in a separable polarization state using a Sagnac source (<bold>a</bold>). One photon is used as a herald, and the second is fed into the interferometer (<bold>b</bold>). The unitary gates in question are each implemented with three waveplates, and act on the polarization of single photons.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms8913-f2"/></fig><fig id="f3"><label>Figure 3</label><caption><title>Results for Pauli Gates.</title><p>Experimental data showing the probability with which the photon exits from a port when determining if a pair of random gates commute or anti-commute. The blue bars are the experimentally observed probabilities for the photon to exit port 1, and the green bars to exit port 0. If the gates commute, then, ideally, the photon should always exit port 0, while if they anti-commute the photon should exit port 1. The <italic>x</italic> axis is labelled with the choice of <italic>U</italic><sub>1</sub> and <italic>U</italic><sub>2</sub>, where <inline-formula id="d33e1182"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1183" xlink:href="ncomms8913-m30.jpg"/></inline-formula>, is the identity, X=<italic>&#x003c3;</italic><sub><italic>x</italic></sub>, Y=<italic>&#x003c3;</italic><sub><italic>y</italic></sub>, and Z=<italic>&#x003c3;</italic><sub><italic>z</italic></sub>. The average success rate (probability to exit the &#x02018;correct port') of these data is 0.973&#x000b1;0.016.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms8913-f3"/></fig><fig id="f4"><label>Figure 4</label><caption><title>Results for Random Gates.</title><p>Experimental data showing the probability with which the photon exits from a port when determining if a pair of random gates commute or anti-commute. 50 commuting and 50 anti-commuting pairs of gates were tested, of which 10 for each case are shown here. The full data set is presented in the <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. 2</xref>. The data representation in this figure follows the same convention as in <xref ref-type="fig" rid="f3">Fig. 3</xref>. However, here the <italic>x</italic> axis is labelled A<italic>i</italic> for anti-commuting case number <italic>i</italic>, and C<italic>i</italic> for commuting case number <italic>i</italic>.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms8913-f4"/></fig></floats-group></article>